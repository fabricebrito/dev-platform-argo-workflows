{"metadata":{"name":"argo-cwl-runner-wvqmw","generateName":"argo-cwl-runner-","namespace":"ns1","uid":"8dfd1ffa-603c-4f74-9bad-ff11ac20c8d1","resourceVersion":"66202","generation":6,"creationTimestamp":"2024-07-19T10:39:46Z","labels":{"workflows.argoproj.io/completed":"true","workflows.argoproj.io/creator":"system-serviceaccount-ns1-argo-server","workflows.argoproj.io/phase":"Succeeded","workflows.argoproj.io/workflow-template":"argo-cwl-runner"},"annotations":{"workflows.argoproj.io/pod-name-format":"v2"},"managedFields":[{"manager":"argo","operation":"Update","apiVersion":"argoproj.io/v1alpha1","time":"2024-07-19T10:39:46Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:generateName":{},"f:labels":{".":{},"f:workflows.argoproj.io/creator":{},"f:workflows.argoproj.io/workflow-template":{}}},"f:spec":{}}},{"manager":"workflow-controller","operation":"Update","apiVersion":"argoproj.io/v1alpha1","time":"2024-07-19T10:41:08Z","fieldsType":"FieldsV1","fieldsV1":{"f:metadata":{"f:annotations":{".":{},"f:workflows.argoproj.io/pod-name-format":{}},"f:labels":{"f:workflows.argoproj.io/completed":{},"f:workflows.argoproj.io/phase":{}}},"f:status":{}}}]},"spec":{"arguments":{"parameters":[{"name":"parameters","value":"{\"stac_items\":[\"https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\"],\"aoi\":\"-121.399,39.834,-120.74,40.472\",\"epsg\":\"EPSG:4326\"}"},{"name":"cwl","value":"{\"cwlVersion\":\"v1.0\",\"$namespaces\":{\"s\":\"https://schema.org/\"},\"s:softwareVersion\":\"1.0.0\",\"schemas\":[\"http://schema.org/version/9.0/schemaorg-current-http.rdf\"],\"$graph\":[{\"class\":\"Workflow\",\"id\":\"main\",\"label\":\"Water bodies detection based on NDWI and otsu threshold\",\"doc\":\"Water bodies detection based on NDWI and otsu threshold applied to Sentinel-2 COG STAC items\",\"requirements\":[{\"class\":\"ScatterFeatureRequirement\"},{\"class\":\"SubworkflowFeatureRequirement\"}],\"inputs\":{\"aoi\":{\"label\":\"area of interest\",\"doc\":\"area of interest as a bounding box\",\"type\":\"string\"},\"epsg\":{\"label\":\"EPSG code\",\"doc\":\"EPSG code\",\"type\":\"string\",\"default\":\"EPSG:4326\"},\"stac_items\":{\"label\":\"Sentinel-2 STAC items\",\"doc\":\"list of Sentinel-2 COG STAC items\",\"type\":\"string[]\"},\"bands\":{\"label\":\"bands used for the NDWI\",\"doc\":\"bands used for the NDWI\",\"type\":\"string[]\",\"default\":[\"green\",\"nir\"]}},\"outputs\":[{\"id\":\"stac_catalog\",\"outputSource\":[\"node_stac/stac_catalog\"],\"type\":\"Directory\"}],\"steps\":{\"node_water_bodies\":{\"run\":\"#detect_water_body\",\"in\":{\"item\":\"stac_items\",\"aoi\":\"aoi\",\"epsg\":\"epsg\",\"bands\":\"bands\"},\"out\":[\"detected_water_body\"],\"scatter\":\"item\",\"scatterMethod\":\"dotproduct\"},\"node_stac\":{\"run\":\"#stac\",\"in\":{\"item\":\"stac_items\",\"rasters\":{\"source\":\"node_water_bodies/detected_water_body\"}},\"out\":[\"stac_catalog\"]}}},{\"class\":\"Workflow\",\"id\":\"detect_water_body\",\"label\":\"Water body detection based on NDWI and otsu threshold\",\"doc\":\"Water body detection based on NDWI and otsu threshold\",\"requirements\":[{\"class\":\"ScatterFeatureRequirement\"}],\"inputs\":{\"aoi\":{\"doc\":\"area of interest as a bounding box\",\"type\":\"string\"},\"epsg\":{\"doc\":\"EPSG code\",\"type\":\"string\",\"default\":\"EPSG:4326\"},\"bands\":{\"doc\":\"bands used for the NDWI\",\"type\":\"string[]\"},\"item\":{\"doc\":\"STAC item\",\"type\":\"string\"}},\"outputs\":[{\"id\":\"detected_water_body\",\"outputSource\":[\"node_otsu/binary_mask_item\"],\"type\":\"File\"}],\"steps\":{\"node_crop\":{\"run\":\"#crop\",\"in\":{\"item\":\"item\",\"aoi\":\"aoi\",\"epsg\":\"epsg\",\"band\":\"bands\"},\"out\":[\"cropped\"],\"scatter\":\"band\",\"scatterMethod\":\"dotproduct\"},\"node_normalized_difference\":{\"run\":\"#norm_diff\",\"in\":{\"rasters\":{\"source\":\"node_crop/cropped\"}},\"out\":[\"ndwi\"]},\"node_otsu\":{\"run\":\"#otsu\",\"in\":{\"raster\":{\"source\":\"node_normalized_difference/ndwi\"}},\"out\":[\"binary_mask_item\"]}}},{\"class\":\"CommandLineTool\",\"id\":\"crop\",\"requirements\":{\"InlineJavascriptRequirement\":{},\"EnvVarRequirement\":{\"envDef\":{\"PATH\":\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\",\"PYTHONPATH\":\"/app\"}},\"ResourceRequirement\":{\"coresMax\":1,\"ramMax\":512}},\"hints\":{\"DockerRequirement\":{\"dockerPull\":\"ghcr.io/eoap/mastering-app-package/crop@sha256:61c2f37b3a1bd56a3eddd0f4224c72de665d42957d3325dd0397845cff198dab\"}},\"baseCommand\":[\"python\",\"-m\",\"app\"],\"arguments\":[],\"inputs\":{\"item\":{\"type\":\"string\",\"inputBinding\":{\"prefix\":\"--input-item\"}},\"aoi\":{\"type\":\"string\",\"inputBinding\":{\"prefix\":\"--aoi\"}},\"epsg\":{\"type\":\"string\",\"inputBinding\":{\"prefix\":\"--epsg\"}},\"band\":{\"type\":\"string\",\"inputBinding\":{\"prefix\":\"--band\"}}},\"outputs\":{\"cropped\":{\"outputBinding\":{\"glob\":\"*.tif\"},\"type\":\"File\"}}},{\"class\":\"CommandLineTool\",\"id\":\"norm_diff\",\"requirements\":{\"InlineJavascriptRequirement\":{},\"EnvVarRequirement\":{\"envDef\":{\"PATH\":\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\",\"PYTHONPATH\":\"/app\"}},\"ResourceRequirement\":{\"coresMax\":1,\"ramMax\":512}},\"hints\":{\"DockerRequirement\":{\"dockerPull\":\"ghcr.io/eoap/mastering-app-package/norm_diff@sha256:641ab55968d7f500b641969d0a7422c4c9a80dd5cc1459ee07f3e0c5ee4fa230\"}},\"baseCommand\":[\"python\",\"-m\",\"app\"],\"arguments\":[],\"inputs\":{\"rasters\":{\"type\":\"File[]\",\"inputBinding\":{\"position\":1}}},\"outputs\":{\"ndwi\":{\"outputBinding\":{\"glob\":\"*.tif\"},\"type\":\"File\"}}},{\"class\":\"CommandLineTool\",\"id\":\"otsu\",\"requirements\":{\"InlineJavascriptRequirement\":{},\"EnvVarRequirement\":{\"envDef\":{\"PATH\":\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\",\"PYTHONPATH\":\"/app\"}},\"ResourceRequirement\":{\"coresMax\":1,\"ramMax\":512}},\"hints\":{\"DockerRequirement\":{\"dockerPull\":\"ghcr.io/eoap/mastering-app-package/otsu@sha256:ec02baf6a007ebb5a2dc037af2da8ef94db67bb8a6139682ad61041f9d27c779\"}},\"baseCommand\":[\"python\",\"-m\",\"app\"],\"arguments\":[],\"inputs\":{\"raster\":{\"type\":\"File\",\"inputBinding\":{\"position\":1}}},\"outputs\":{\"binary_mask_item\":{\"outputBinding\":{\"glob\":\"*.tif\"},\"type\":\"File\"}}},{\"class\":\"CommandLineTool\",\"id\":\"stac\",\"requirements\":{\"InlineJavascriptRequirement\":{},\"EnvVarRequirement\":{\"envDef\":{\"PATH\":\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\",\"PYTHONPATH\":\"/app\"}},\"ResourceRequirement\":{\"coresMax\":1,\"ramMax\":512}},\"hints\":{\"DockerRequirement\":{\"dockerPull\":\"ghcr.io/eoap/mastering-app-package/stac@sha256:8ad7e7d6999c0c4c91c2b19ce231f24734d2af8f41b855ef9a06276d23345601\"}},\"baseCommand\":[\"python\",\"-m\",\"app\"],\"arguments\":[],\"inputs\":{\"item\":{\"type\":{\"type\":\"array\",\"items\":\"string\",\"inputBinding\":{\"prefix\":\"--input-item\"}}},\"rasters\":{\"type\":{\"type\":\"array\",\"items\":\"File\",\"inputBinding\":{\"prefix\":\"--water-body\"}}}},\"outputs\":{\"stac_catalog\":{\"outputBinding\":{\"glob\":\".\"},\"type\":\"Directory\"}}}],\"s:codeRepository\":{\"URL\":\"https://github.com/eoap/mastering-app-package.git\"},\"s:author\":[{\"class\":\"s:Person\",\"s.name\":\"Jane Doe\",\"s.email\":\"jane.doe@acme.earth\",\"s.affiliation\":\"ACME\"}]}"},{"name":"max_ram","value":"16G"},{"name":"max_cores","value":"8"}]},"workflowTemplateRef":{"name":"argo-cwl-runner"}},"status":{"phase":"Succeeded","startedAt":"2024-07-19T10:39:46Z","finishedAt":"2024-07-19T10:41:08Z","estimatedDuration":91,"progress":"5/5","nodes":{"argo-cwl-runner-wvqmw":{"id":"argo-cwl-runner-wvqmw","name":"argo-cwl-runner-wvqmw","displayName":"argo-cwl-runner-wvqmw","type":"Steps","templateName":"calrissian-runner","templateScope":"local/","phase":"Succeeded","startedAt":"2024-07-19T10:39:46Z","finishedAt":"2024-07-19T10:41:08Z","estimatedDuration":91,"progress":"5/5","resourcesDuration":{"cpu":9,"memory":100},"inputs":{"parameters":[{"name":"parameters","value":"{\"stac_items\":[\"https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\"],\"aoi\":\"-121.399,39.834,-120.74,40.472\",\"epsg\":\"EPSG:4326\"}"},{"name":"cwl","value":"{\"cwlVersion\":\"v1.0\",\"$namespaces\":{\"s\":\"https://schema.org/\"},\"s:softwareVersion\":\"1.0.0\",\"schemas\":[\"http://schema.org/version/9.0/schemaorg-current-http.rdf\"],\"$graph\":[{\"class\":\"Workflow\",\"id\":\"main\",\"label\":\"Water bodies detection based on NDWI and otsu threshold\",\"doc\":\"Water bodies detection based on NDWI and otsu threshold applied to Sentinel-2 COG STAC items\",\"requirements\":[{\"class\":\"ScatterFeatureRequirement\"},{\"class\":\"SubworkflowFeatureRequirement\"}],\"inputs\":{\"aoi\":{\"label\":\"area of interest\",\"doc\":\"area of interest as a bounding box\",\"type\":\"string\"},\"epsg\":{\"label\":\"EPSG code\",\"doc\":\"EPSG code\",\"type\":\"string\",\"default\":\"EPSG:4326\"},\"stac_items\":{\"label\":\"Sentinel-2 STAC items\",\"doc\":\"list of Sentinel-2 COG STAC items\",\"type\":\"string[]\"},\"bands\":{\"label\":\"bands used for the NDWI\",\"doc\":\"bands used for the NDWI\",\"type\":\"string[]\",\"default\":[\"green\",\"nir\"]}},\"outputs\":[{\"id\":\"stac_catalog\",\"outputSource\":[\"node_stac/stac_catalog\"],\"type\":\"Directory\"}],\"steps\":{\"node_water_bodies\":{\"run\":\"#detect_water_body\",\"in\":{\"item\":\"stac_items\",\"aoi\":\"aoi\",\"epsg\":\"epsg\",\"bands\":\"bands\"},\"out\":[\"detected_water_body\"],\"scatter\":\"item\",\"scatterMethod\":\"dotproduct\"},\"node_stac\":{\"run\":\"#stac\",\"in\":{\"item\":\"stac_items\",\"rasters\":{\"source\":\"node_water_bodies/detected_water_body\"}},\"out\":[\"stac_catalog\"]}}},{\"class\":\"Workflow\",\"id\":\"detect_water_body\",\"label\":\"Water body detection based on NDWI and otsu threshold\",\"doc\":\"Water body detection based on NDWI and otsu threshold\",\"requirements\":[{\"class\":\"ScatterFeatureRequirement\"}],\"inputs\":{\"aoi\":{\"doc\":\"area of interest as a bounding box\",\"type\":\"string\"},\"epsg\":{\"doc\":\"EPSG code\",\"type\":\"string\",\"default\":\"EPSG:4326\"},\"bands\":{\"doc\":\"bands used for the NDWI\",\"type\":\"string[]\"},\"item\":{\"doc\":\"STAC item\",\"type\":\"string\"}},\"outputs\":[{\"id\":\"detected_water_body\",\"outputSource\":[\"node_otsu/binary_mask_item\"],\"type\":\"File\"}],\"steps\":{\"node_crop\":{\"run\":\"#crop\",\"in\":{\"item\":\"item\",\"aoi\":\"aoi\",\"epsg\":\"epsg\",\"band\":\"bands\"},\"out\":[\"cropped\"],\"scatter\":\"band\",\"scatterMethod\":\"dotproduct\"},\"node_normalized_difference\":{\"run\":\"#norm_diff\",\"in\":{\"rasters\":{\"source\":\"node_crop/cropped\"}},\"out\":[\"ndwi\"]},\"node_otsu\":{\"run\":\"#otsu\",\"in\":{\"raster\":{\"source\":\"node_normalized_difference/ndwi\"}},\"out\":[\"binary_mask_item\"]}}},{\"class\":\"CommandLineTool\",\"id\":\"crop\",\"requirements\":{\"InlineJavascriptRequirement\":{},\"EnvVarRequirement\":{\"envDef\":{\"PATH\":\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\",\"PYTHONPATH\":\"/app\"}},\"ResourceRequirement\":{\"coresMax\":1,\"ramMax\":512}},\"hints\":{\"DockerRequirement\":{\"dockerPull\":\"ghcr.io/eoap/mastering-app-package/crop@sha256:61c2f37b3a1bd56a3eddd0f4224c72de665d42957d3325dd0397845cff198dab\"}},\"baseCommand\":[\"python\",\"-m\",\"app\"],\"arguments\":[],\"inputs\":{\"item\":{\"type\":\"string\",\"inputBinding\":{\"prefix\":\"--input-item\"}},\"aoi\":{\"type\":\"string\",\"inputBinding\":{\"prefix\":\"--aoi\"}},\"epsg\":{\"type\":\"string\",\"inputBinding\":{\"prefix\":\"--epsg\"}},\"band\":{\"type\":\"string\",\"inputBinding\":{\"prefix\":\"--band\"}}},\"outputs\":{\"cropped\":{\"outputBinding\":{\"glob\":\"*.tif\"},\"type\":\"File\"}}},{\"class\":\"CommandLineTool\",\"id\":\"norm_diff\",\"requirements\":{\"InlineJavascriptRequirement\":{},\"EnvVarRequirement\":{\"envDef\":{\"PATH\":\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\",\"PYTHONPATH\":\"/app\"}},\"ResourceRequirement\":{\"coresMax\":1,\"ramMax\":512}},\"hints\":{\"DockerRequirement\":{\"dockerPull\":\"ghcr.io/eoap/mastering-app-package/norm_diff@sha256:641ab55968d7f500b641969d0a7422c4c9a80dd5cc1459ee07f3e0c5ee4fa230\"}},\"baseCommand\":[\"python\",\"-m\",\"app\"],\"arguments\":[],\"inputs\":{\"rasters\":{\"type\":\"File[]\",\"inputBinding\":{\"position\":1}}},\"outputs\":{\"ndwi\":{\"outputBinding\":{\"glob\":\"*.tif\"},\"type\":\"File\"}}},{\"class\":\"CommandLineTool\",\"id\":\"otsu\",\"requirements\":{\"InlineJavascriptRequirement\":{},\"EnvVarRequirement\":{\"envDef\":{\"PATH\":\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\",\"PYTHONPATH\":\"/app\"}},\"ResourceRequirement\":{\"coresMax\":1,\"ramMax\":512}},\"hints\":{\"DockerRequirement\":{\"dockerPull\":\"ghcr.io/eoap/mastering-app-package/otsu@sha256:ec02baf6a007ebb5a2dc037af2da8ef94db67bb8a6139682ad61041f9d27c779\"}},\"baseCommand\":[\"python\",\"-m\",\"app\"],\"arguments\":[],\"inputs\":{\"raster\":{\"type\":\"File\",\"inputBinding\":{\"position\":1}}},\"outputs\":{\"binary_mask_item\":{\"outputBinding\":{\"glob\":\"*.tif\"},\"type\":\"File\"}}},{\"class\":\"CommandLineTool\",\"id\":\"stac\",\"requirements\":{\"InlineJavascriptRequirement\":{},\"EnvVarRequirement\":{\"envDef\":{\"PATH\":\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\",\"PYTHONPATH\":\"/app\"}},\"ResourceRequirement\":{\"coresMax\":1,\"ramMax\":512}},\"hints\":{\"DockerRequirement\":{\"dockerPull\":\"ghcr.io/eoap/mastering-app-package/stac@sha256:8ad7e7d6999c0c4c91c2b19ce231f24734d2af8f41b855ef9a06276d23345601\"}},\"baseCommand\":[\"python\",\"-m\",\"app\"],\"arguments\":[],\"inputs\":{\"item\":{\"type\":{\"type\":\"array\",\"items\":\"string\",\"inputBinding\":{\"prefix\":\"--input-item\"}}},\"rasters\":{\"type\":{\"type\":\"array\",\"items\":\"File\",\"inputBinding\":{\"prefix\":\"--water-body\"}}}},\"outputs\":{\"stac_catalog\":{\"outputBinding\":{\"glob\":\".\"},\"type\":\"Directory\"}}}],\"s:codeRepository\":{\"URL\":\"https://github.com/eoap/mastering-app-package.git\"},\"s:author\":[{\"class\":\"s:Person\",\"s.name\":\"Jane Doe\",\"s.email\":\"jane.doe@acme.earth\",\"s.affiliation\":\"ACME\"}]}"},{"name":"max_ram","value":"16G"},{"name":"max_cores","value":"8"}]},"outputs":{"parameters":[{"name":"results","value":"{\n    \"stac_catalog\": {\n        \"location\": \"file:///calrissian/results/73k_b1lo\",\n        \"basename\": \"73k_b1lo\",\n        \"class\": \"Directory\",\n        \"listing\": [\n            {\n                \"class\": \"File\",\n                \"location\": \"file:///calrissian/results/73k_b1lo/catalog.json\",\n                \"basename\": \"catalog.json\",\n                \"checksum\": \"sha1$f1994683c2e2b8d21aab7f0c0c05b76b850ac21e\",\n                \"size\": 359,\n                \"path\": \"/calrissian/results/73k_b1lo/catalog.json\"\n            },\n            {\n                \"class\": \"Directory\",\n                \"location\": \"file:///calrissian/results/73k_b1lo/S2A_10TFK_20210708_0_L2A\",\n                \"basename\": \"S2A_10TFK_20210708_0_L2A\",\n                \"listing\": [\n                    {\n                        \"class\": \"File\",\n                        \"location\": \"file:///calrissian/results/73k_b1lo/S2A_10TFK_20210708_0_L2A/S2A_10TFK_20210708_0_L2A.json\",\n                        \"basename\": \"S2A_10TFK_20210708_0_L2A.json\",\n                        \"checksum\": \"sha1$800a04fa6e4644dd1306d9335c237b020cd4bf5a\",\n                        \"size\": 4882,\n                        \"path\": \"/calrissian/results/73k_b1lo/S2A_10TFK_20210708_0_L2A/S2A_10TFK_20210708_0_L2A.json\"\n                    },\n                    {\n                        \"class\": \"File\",\n                        \"location\": \"file:///calrissian/results/73k_b1lo/S2A_10TFK_20210708_0_L2A/otsu.tif\",\n                        \"basename\": \"otsu.tif\",\n                        \"checksum\": \"sha1$210598cf619d49eabfdc24414bd445f59668f3bd\",\n                        \"size\": 289288,\n                        \"path\": \"/calrissian/results/73k_b1lo/S2A_10TFK_20210708_0_L2A/otsu.tif\"\n                    }\n                ],\n                \"path\": \"/calrissian/results/73k_b1lo/S2A_10TFK_20210708_0_L2A\"\n            }\n        ],\n        \"path\": \"/calrissian/results/73k_b1lo\"\n    }\n}"},{"name":"logs","value":"\u001b[1;30mINFO\u001b[0m calrissian 0.16.0 (cwltool 3.1.20231114134824)\n\u001b[1;30mINFO\u001b[0m Resolved '/calrissian/cwl.json' to 'file:///calrissian/cwl.json'\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mStarting ThreadPoolJobExecutor.run_jobs: total_resources=[ram: 16000.0, cores: 8.0, gpus 0], max_workers=None\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow ] initialized from file:///calrissian/cwl.json#main\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mwait_for_completion with 0 futures\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow ] inputs {\n    \"stac_items\": [\n        \"https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\"\n    ],\n    \"aoi\": \"-121.399,39.834,-120.74,40.472\",\n    \"epsg\": \"EPSG:4326\",\n    \"bands\": [\n        \"green\",\n        \"nir\"\n    ]\n}\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow ] job step file:///calrissian/cwl.json#main/node_stac not ready\u001b[0m\n\u001b[1;30mINFO\u001b[0m [workflow ] starting step node_water_bodies\n\u001b[1;30mINFO\u001b[0m [step node_water_bodies] start\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] initialized from file:///calrissian/cwl.json#detect_water_body\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mwait_for_completion with 0 futures\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] inputs {\n    \"aoi\": \"-121.399,39.834,-120.74,40.472\",\n    \"bands\": [\n        \"green\",\n        \"nir\"\n    ],\n    \"epsg\": \"EPSG:4326\",\n    \"item\": \"https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\"\n}\u001b[0m\n\u001b[1;30mINFO\u001b[0m [workflow node_water_bodies] starting step node_crop\n\u001b[1;30mINFO\u001b[0m [step node_crop] start\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_crop] initializing from file:///calrissian/cwl.json#crop as part of step node_crop\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_crop] {\n    \"aoi\": \"-121.399,39.834,-120.74,40.472\",\n    \"band\": \"green\",\n    \"epsg\": \"EPSG:4326\",\n    \"item\": \"https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\"\n}\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_crop] path mappings is {}\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_crop] command line bindings is [\n    {\n        \"position\": [\n            -1000000,\n            0\n        ],\n        \"datum\": \"python\"\n    },\n    {\n        \"position\": [\n            -1000000,\n            1\n        ],\n        \"datum\": \"-m\"\n    },\n    {\n        \"position\": [\n            -1000000,\n            2\n        ],\n        \"datum\": \"app\"\n    },\n    {\n        \"prefix\": \"--aoi\",\n        \"position\": [\n            0,\n            \"aoi\"\n        ],\n        \"datum\": \"-121.399,39.834,-120.74,40.472\"\n    },\n    {\n        \"prefix\": \"--band\",\n        \"position\": [\n            0,\n            \"band\"\n        ],\n        \"datum\": \"green\"\n    },\n    {\n        \"prefix\": \"--epsg\",\n        \"position\": [\n            0,\n            \"epsg\"\n        ],\n        \"datum\": \"EPSG:4326\"\n    },\n    {\n        \"prefix\": \"--input-item\",\n        \"position\": [\n            0,\n            \"item\"\n        ],\n        \"datum\": \"https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\"\n    }\n]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mwait_for_completion with 0 futures\u001b[0m\n\u001b[1;30mINFO\u001b[0m [step node_crop] start\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_crop_2] initializing from file:///calrissian/cwl.json#crop as part of step node_crop\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_crop_2] {\n    \"aoi\": \"-121.399,39.834,-120.74,40.472\",\n    \"band\": \"nir\",\n    \"epsg\": \"EPSG:4326\",\n    \"item\": \"https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\"\n}\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_crop_2] path mappings is {}\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_crop_2] command line bindings is [\n    {\n        \"position\": [\n            -1000000,\n            0\n        ],\n        \"datum\": \"python\"\n    },\n    {\n        \"position\": [\n            -1000000,\n            1\n        ],\n        \"datum\": \"-m\"\n    },\n    {\n        \"position\": [\n            -1000000,\n            2\n        ],\n        \"datum\": \"app\"\n    },\n    {\n        \"prefix\": \"--aoi\",\n        \"position\": [\n            0,\n            \"aoi\"\n        ],\n        \"datum\": \"-121.399,39.834,-120.74,40.472\"\n    },\n    {\n        \"prefix\": \"--band\",\n        \"position\": [\n            0,\n            \"band\"\n        ],\n        \"datum\": \"nir\"\n    },\n    {\n        \"prefix\": \"--epsg\",\n        \"position\": [\n            0,\n            \"epsg\"\n        ],\n        \"datum\": \"EPSG:4326\"\n    },\n    {\n        \"prefix\": \"--input-item\",\n        \"position\": [\n            0,\n            \"item\"\n        ],\n        \"datum\": \"https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\"\n    }\n]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mwait_for_completion with 0 futures\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] job step file:///calrissian/cwl.json#detect_water_body/node_normalized_difference not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] job step file:///calrissian/cwl.json#detect_water_body/node_otsu not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] job step file:///calrissian/cwl.json#detect_water_body/node_normalized_difference not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] job step file:///calrissian/cwl.json#detect_water_body/node_otsu not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] job step file:///calrissian/cwl.json#detect_water_body/node_normalized_difference not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] job step file:///calrissian/cwl.json#detect_water_body/node_otsu not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow ] job step file:///calrissian/cwl.json#main/node_stac not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] job step file:///calrissian/cwl.json#detect_water_body/node_normalized_difference not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] job step file:///calrissian/cwl.json#detect_water_body/node_otsu not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mallocate [ram: 0, cores: 0, gpus 0] from available [ram: 16000.0, cores: 8.0, gpus 0]\u001b[0m\n\u001b[1;30mINFO\u001b[0m [workflow ] start\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mrestore [ram: 0, cores: 0, gpus 0] to available [ram: 16000.0, cores: 8.0, gpus 0]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mallocate [ram: 0, cores: 0, gpus 0] from available [ram: 16000.0, cores: 8.0, gpus 0]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mallocate [ram: 512, cores: 1, gpus 0] from available [ram: 16000.0, cores: 8.0, gpus 0]\u001b[0m\n\u001b[1;30mINFO\u001b[0m [workflow node_water_bodies] start\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mrestore [ram: 0, cores: 0, gpus 0] to available [ram: 15488.0, cores: 7.0, gpus 0]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mallocate [ram: 512, cores: 1, gpus 0] from available [ram: 15488.0, cores: 7.0, gpus 0]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mwait_for_completion with 4 futures\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow ] job step file:///calrissian/cwl.json#main/node_stac not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] job step file:///calrissian/cwl.json#detect_water_body/node_normalized_difference not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] job step file:///calrissian/cwl.json#detect_water_body/node_otsu not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mwait_for_completion with 2 futures\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_crop] initial work dir {}\u001b[0m\nBuilding resources spec from {'cores': 1, 'ram': 512, 'gpus': 0}\n--------------------------------------------------------------------------------\napiVersion: v1\nkind: Pod\nmetadata:\n  labels: {}\n  name: node-crop-pod-snpnnthg\nspec:\n  containers:\n  - args:\n    - python -m app --aoi -121.399,39.834,-120.74,40.472 --band green --epsg EPSG:4326\n      --input-item https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\n    command:\n    - /bin/sh\n    - -c\n    env:\n    - name: HOME\n      value: /nGuThn\n    - name: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - PATH\n      value: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n    - name: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - PYTHONPATH\n      value: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - /app\n    - name: TMPDIR\n      value: /tmp\n    image: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n    - ghcr.io/eoap/mastering-app-package/crop@sha256:61c2f37b3a1bd56a3eddd0f4224c72de665d42957d3325dd0397845cff198dab\n    name: node-crop-container\n    resources:\n      requests:\n        cpu: '1'\n        memory: 512Mi\n    volumeMounts:\n    - mountPath: /nGuThn\n      name: argo-cwl-runner-wvqmw-calrissian-wdir\n      readOnly: false\n      subPath: tmp/ah_lxh40\n    - mountPath: /tmp\n      name: tmpdir\n    workingDir: /nGuThn\n  initContainers: []\n  nodeSelector: {}\n  restartPolicy: Never\n  securityContext:\n    runAsGroup: 0\n    runAsUser: 0\n  serviceAccountName: argo\n  volumes:\n  - name: argo-cwl-runner-wvqmw-calrissian-wdir\n    persistentVolumeClaim:\n      claimName: argo-cwl-runner-wvqmw-calrissian-wdir\n      readOnly: false\n  - emptyDir: {}\n    name: tmpdir\n--------------------------------------------------------------------------------\n\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_crop_2] initial work dir {}\u001b[0m\nBuilding resources spec from {'cores': 1, 'ram': 512, 'gpus': 0}\n--------------------------------------------------------------------------------\napiVersion: v1\nkind: Pod\nmetadata:\n  labels: {}\n  name: node-crop-2-pod-aiubutgn\nspec:\n  containers:\n  - args:\n    - python -m app --aoi -121.399,39.834,-120.74,40.472 --band nir --epsg EPSG:4326\n      --input-item https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\n    command:\n    - /bin/sh\n    - -c\n    env:\n    - name: HOME\n      value: /nGuThn\n    - name: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - PATH\n      value: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n    - name: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - PYTHONPATH\n      value: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - /app\n    - name: TMPDIR\n      value: /tmp\n    image: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n    - ghcr.io/eoap/mastering-app-package/crop@sha256:61c2f37b3a1bd56a3eddd0f4224c72de665d42957d3325dd0397845cff198dab\n    name: node-crop-2-container\n    resources:\n      requests:\n        cpu: '1'\n        memory: 512Mi\n    volumeMounts:\n    - mountPath: /nGuThn\n      name: argo-cwl-runner-wvqmw-calrissian-wdir\n      readOnly: false\n      subPath: tmp/n_drxp_d\n    - mountPath: /tmp\n      name: tmpdir\n    workingDir: /nGuThn\n  initContainers: []\n  nodeSelector: {}\n  restartPolicy: Never\n  securityContext:\n    runAsGroup: 0\n    runAsUser: 0\n  serviceAccountName: argo\n  volumes:\n  - name: argo-cwl-runner-wvqmw-calrissian-wdir\n    persistentVolumeClaim:\n      claimName: argo-cwl-runner-wvqmw-calrissian-wdir\n      readOnly: false\n  - emptyDir: {}\n    name: tmpdir\n--------------------------------------------------------------------------------\n\nCreated k8s pod name node-crop-pod-snpnnthg with id 40f66c52-56ff-4fc9-826f-c014c2513b66\nPodMonitor adding node-crop-pod-snpnnthg\nk8s pod 'node-crop-pod-snpnnthg' started\npod name node-crop-pod-snpnnthg with id 40f66c52-56ff-4fc9-826f-c014c2513b66 has status None\nCreated k8s pod name node-crop-2-pod-aiubutgn with id 45ef4566-a4e3-41e3-9ffb-4a9464e29b78\nPodMonitor adding node-crop-2-pod-aiubutgn\nk8s pod 'node-crop-2-pod-aiubutgn' started\npod name node-crop-2-pod-aiubutgn with id 45ef4566-a4e3-41e3-9ffb-4a9464e29b78 has status None\npod name node-crop-pod-snpnnthg with id 40f66c52-56ff-4fc9-826f-c014c2513b66 has status {'allocated_resources': None,\n 'container_id': None,\n 'image': 'ghcr.io/eoap/mastering-app-package/crop@sha256:61c2f37b3a1bd56a3eddd0f4224c72de665d42957d3325dd0397845cff198dab',\n 'image_id': '',\n 'last_state': {'running': None, 'terminated': None, 'waiting': None},\n 'name': 'node-crop-container',\n 'ready': False,\n 'resources': None,\n 'restart_count': 0,\n 'started': False,\n 'state': {'running': None,\n           'terminated': None,\n           'waiting': {'message': None, 'reason': 'ContainerCreating'}}}\npod name node-crop-2-pod-aiubutgn with id 45ef4566-a4e3-41e3-9ffb-4a9464e29b78 has status {'allocated_resources': None,\n 'container_id': None,\n 'image': 'ghcr.io/eoap/mastering-app-package/crop@sha256:61c2f37b3a1bd56a3eddd0f4224c72de665d42957d3325dd0397845cff198dab',\n 'image_id': '',\n 'last_state': {'running': None, 'terminated': None, 'waiting': None},\n 'name': 'node-crop-2-container',\n 'ready': False,\n 'resources': None,\n 'restart_count': 0,\n 'started': False,\n 'state': {'running': None,\n           'terminated': None,\n           'waiting': {'message': None, 'reason': 'ContainerCreating'}}}\npod name node-crop-2-pod-aiubutgn with id 45ef4566-a4e3-41e3-9ffb-4a9464e29b78 has status {'allocated_resources': None,\n 'container_id': 'docker://d5f748fe20c4b5055139753b16c5c92304dd20ce0e2262a842c98874fec87c1a',\n 'image': 'sha256:337e3e9d05c61bc8df71b9ebf48749d495f8f521e3237fe13b75ba0d1a1038eb',\n 'image_id': 'docker-pullable://ghcr.io/eoap/mastering-app-package/crop@sha256:61c2f37b3a1bd56a3eddd0f4224c72de665d42957d3325dd0397845cff198dab',\n 'last_state': {'running': None, 'terminated': None, 'waiting': None},\n 'name': 'node-crop-2-container',\n 'ready': True,\n 'resources': None,\n 'restart_count': 0,\n 'started': True,\n 'state': {'running': {'started_at': datetime.datetime(2024, 7, 19, 10, 40, 2, tzinfo=tzlocal())},\n           'terminated': None,\n           'waiting': None}}\n[node-crop-2-pod-aiubutgn] follow_logs start\npod name node-crop-pod-snpnnthg with id 40f66c52-56ff-4fc9-826f-c014c2513b66 has status {'allocated_resources': None,\n 'container_id': 'docker://0a8362d8530225be6d1e94bb904b2ae48fbe23ba753b0ecdcdc185bea7c406c1',\n 'image': 'sha256:337e3e9d05c61bc8df71b9ebf48749d495f8f521e3237fe13b75ba0d1a1038eb',\n 'image_id': 'docker-pullable://ghcr.io/eoap/mastering-app-package/crop@sha256:61c2f37b3a1bd56a3eddd0f4224c72de665d42957d3325dd0397845cff198dab',\n 'last_state': {'running': None, 'terminated': None, 'waiting': None},\n 'name': 'node-crop-container',\n 'ready': True,\n 'resources': None,\n 'restart_count': 0,\n 'started': True,\n 'state': {'running': {'started_at': datetime.datetime(2024, 7, 19, 10, 40, 2, tzinfo=tzlocal())},\n           'terminated': None,\n           'waiting': None}}\n[node-crop-pod-snpnnthg] follow_logs start\n[node-crop-2-pod-aiubutgn] 2024-07-19 10:40:03.609 | INFO     | __main__:crop:69 - Read S2A_10TFK_20210708_0_L2A from https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\n[node-crop-2-pod-aiubutgn] 2024-07-19 10:40:03.635 | INFO     | __main__:crop:72 - Read asset nir from https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/10/T/FK/2021/7/S2A_10TFK_20210708_0_L2A/B08.tif\n[node-crop-pod-snpnnthg] 2024-07-19 10:40:03.892 | INFO     | __main__:crop:69 - Read S2A_10TFK_20210708_0_L2A from https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\n[node-crop-pod-snpnnthg] 2024-07-19 10:40:03.911 | INFO     | __main__:crop:72 - Read asset green from https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/10/T/FK/2021/7/S2A_10TFK_20210708_0_L2A/B03.tif\n[node-crop-2-pod-aiubutgn] 2024-07-19 10:40:05.849 | INFO     | __main__:crop:90 - Crop https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/10/T/FK/2021/7/S2A_10TFK_20210708_0_L2A/B08.tif\n[node-crop-pod-snpnnthg] 2024-07-19 10:40:06.063 | INFO     | __main__:crop:90 - Crop https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/10/T/FK/2021/7/S2A_10TFK_20210708_0_L2A/B03.tif\n[node-crop-pod-snpnnthg] 2024-07-19 10:40:23.262 | INFO     | __main__:crop:112 - Write crop_green.tif\n[node-crop-2-pod-aiubutgn] 2024-07-19 10:40:26.964 | INFO     | __main__:crop:112 - Write crop_nir.tif\n[node-crop-pod-snpnnthg] 2024-07-19 10:40:26.995 | INFO     | __main__:crop:115 - Done!\n[node-crop-pod-snpnnthg] follow_logs end\npod name node-crop-pod-snpnnthg with id 40f66c52-56ff-4fc9-826f-c014c2513b66 has status {'allocated_resources': None,\n 'container_id': 'docker://0a8362d8530225be6d1e94bb904b2ae48fbe23ba753b0ecdcdc185bea7c406c1',\n 'image': 'sha256:337e3e9d05c61bc8df71b9ebf48749d495f8f521e3237fe13b75ba0d1a1038eb',\n 'image_id': 'docker-pullable://ghcr.io/eoap/mastering-app-package/crop@sha256:61c2f37b3a1bd56a3eddd0f4224c72de665d42957d3325dd0397845cff198dab',\n 'last_state': {'running': None, 'terminated': None, 'waiting': None},\n 'name': 'node-crop-container',\n 'ready': False,\n 'resources': None,\n 'restart_count': 0,\n 'started': False,\n 'state': {'running': None,\n           'terminated': {'container_id': 'docker://0a8362d8530225be6d1e94bb904b2ae48fbe23ba753b0ecdcdc185bea7c406c1',\n                          'exit_code': 0,\n                          'finished_at': datetime.datetime(2024, 7, 19, 10, 40, 27, tzinfo=tzlocal()),\n                          'message': None,\n                          'reason': 'Completed',\n                          'signal': None,\n                          'started_at': datetime.datetime(2024, 7, 19, 10, 40, 2, tzinfo=tzlocal())},\n           'waiting': None}}\nHandling terminated pod name node-crop-pod-snpnnthg with id 40f66c52-56ff-4fc9-826f-c014c2513b66\nhandling completion with 0\nPodMonitor removing node-crop-pod-snpnnthg\nos.makedirs(/calrissian/logs)\nWriting pod node_crop logs to /calrissian/logs/node_crop.log\nshutil.rmtree(/tmp/hklxhzf8, True)\nshutil.rmtree(/tmp/ozpd15gi, True)\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mrestore [ram: 512, cores: 1, gpus 0] to available [ram: 14976.0, cores: 6.0, gpus 0]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow ] job step file:///calrissian/cwl.json#main/node_stac not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] job step file:///calrissian/cwl.json#detect_water_body/node_normalized_difference not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] job step file:///calrissian/cwl.json#detect_water_body/node_otsu not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mwait_for_completion with 1 futures\u001b[0m\n[node-crop-2-pod-aiubutgn] 2024-07-19 10:40:30.275 | INFO     | __main__:crop:115 - Done!\n[node-crop-2-pod-aiubutgn] follow_logs end\npod name node-crop-2-pod-aiubutgn with id 45ef4566-a4e3-41e3-9ffb-4a9464e29b78 has status {'allocated_resources': None,\n 'container_id': 'docker://d5f748fe20c4b5055139753b16c5c92304dd20ce0e2262a842c98874fec87c1a',\n 'image': 'sha256:337e3e9d05c61bc8df71b9ebf48749d495f8f521e3237fe13b75ba0d1a1038eb',\n 'image_id': 'docker-pullable://ghcr.io/eoap/mastering-app-package/crop@sha256:61c2f37b3a1bd56a3eddd0f4224c72de665d42957d3325dd0397845cff198dab',\n 'last_state': {'running': None, 'terminated': None, 'waiting': None},\n 'name': 'node-crop-2-container',\n 'ready': False,\n 'resources': None,\n 'restart_count': 0,\n 'started': False,\n 'state': {'running': None,\n           'terminated': {'container_id': 'docker://d5f748fe20c4b5055139753b16c5c92304dd20ce0e2262a842c98874fec87c1a',\n                          'exit_code': 0,\n                          'finished_at': datetime.datetime(2024, 7, 19, 10, 40, 30, tzinfo=tzlocal()),\n                          'message': None,\n                          'reason': 'Completed',\n                          'signal': None,\n                          'started_at': datetime.datetime(2024, 7, 19, 10, 40, 2, tzinfo=tzlocal())},\n           'waiting': None}}\nHandling terminated pod name node-crop-2-pod-aiubutgn with id 45ef4566-a4e3-41e3-9ffb-4a9464e29b78\nhandling completion with 0\nPodMonitor removing node-crop-2-pod-aiubutgn\nWriting pod node_crop_2 logs to /calrissian/logs/node_crop_2.log\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[step node_crop] produced output {\n    \"file:///calrissian/cwl.json#detect_water_body/node_crop/cropped\": [\n        {\n            \"location\": \"file:///calrissian/tmp/ah_lxh40/crop_green.tif\",\n            \"basename\": \"crop_green.tif\",\n            \"nameroot\": \"crop_green\",\n            \"nameext\": \".tif\",\n            \"class\": \"File\",\n            \"checksum\": \"sha1$9956fe066bc4fd47770d36b508ada24db67639e4\",\n            \"size\": 87602514,\n            \"http://commonwl.org/cwltool#generation\": 0\n        },\n        {\n            \"location\": \"file:///calrissian/tmp/n_drxp_d/crop_nir.tif\",\n            \"basename\": \"crop_nir.tif\",\n            \"nameroot\": \"crop_nir\",\n            \"nameext\": \".tif\",\n            \"class\": \"File\",\n            \"checksum\": \"sha1$295ef64b75391884bf432db41ba6e677d87ddaab\",\n            \"size\": 100761236,\n            \"http://commonwl.org/cwltool#generation\": 0\n        }\n    ]\n}\u001b[0m\n\u001b[1;30mINFO\u001b[0m [step node_crop] completed success\nshutil.rmtree(/tmp/uze6mavv, True)\nshutil.rmtree(/tmp/zxmort7y, True)\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mrestore [ram: 512, cores: 1, gpus 0] to available [ram: 15488.0, cores: 7.0, gpus 0]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow ] job step file:///calrissian/cwl.json#main/node_stac not ready\u001b[0m\n\u001b[1;30mINFO\u001b[0m [workflow node_water_bodies] starting step node_normalized_difference\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[step node_normalized_difference] job input {\n    \"file:///calrissian/cwl.json#detect_water_body/node_normalized_difference/rasters\": [\n        {\n            \"location\": \"file:///calrissian/tmp/ah_lxh40/crop_green.tif\",\n            \"basename\": \"crop_green.tif\",\n            \"nameroot\": \"crop_green\",\n            \"nameext\": \".tif\",\n            \"class\": \"File\",\n            \"checksum\": \"sha1$9956fe066bc4fd47770d36b508ada24db67639e4\",\n            \"size\": 87602514,\n            \"http://commonwl.org/cwltool#generation\": 0\n        },\n        {\n            \"location\": \"file:///calrissian/tmp/n_drxp_d/crop_nir.tif\",\n            \"basename\": \"crop_nir.tif\",\n            \"nameroot\": \"crop_nir\",\n            \"nameext\": \".tif\",\n            \"class\": \"File\",\n            \"checksum\": \"sha1$295ef64b75391884bf432db41ba6e677d87ddaab\",\n            \"size\": 100761236,\n            \"http://commonwl.org/cwltool#generation\": 0\n        }\n    ]\n}\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[step node_normalized_difference] evaluated job input to {\n    \"file:///calrissian/cwl.json#detect_water_body/node_normalized_difference/rasters\": [\n        {\n            \"location\": \"file:///calrissian/tmp/ah_lxh40/crop_green.tif\",\n            \"basename\": \"crop_green.tif\",\n            \"nameroot\": \"crop_green\",\n            \"nameext\": \".tif\",\n            \"class\": \"File\",\n            \"checksum\": \"sha1$9956fe066bc4fd47770d36b508ada24db67639e4\",\n            \"size\": 87602514,\n            \"http://commonwl.org/cwltool#generation\": 0\n        },\n        {\n            \"location\": \"file:///calrissian/tmp/n_drxp_d/crop_nir.tif\",\n            \"basename\": \"crop_nir.tif\",\n            \"nameroot\": \"crop_nir\",\n            \"nameext\": \".tif\",\n            \"class\": \"File\",\n            \"checksum\": \"sha1$295ef64b75391884bf432db41ba6e677d87ddaab\",\n            \"size\": 100761236,\n            \"http://commonwl.org/cwltool#generation\": 0\n        }\n    ]\n}\u001b[0m\n\u001b[1;30mINFO\u001b[0m [step node_normalized_difference] start\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_normalized_difference] initializing from file:///calrissian/cwl.json#norm_diff as part of step node_normalized_difference\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_normalized_difference] {\n    \"rasters\": [\n        {\n            \"location\": \"file:///calrissian/tmp/ah_lxh40/crop_green.tif\",\n            \"basename\": \"crop_green.tif\",\n            \"nameroot\": \"crop_green\",\n            \"nameext\": \".tif\",\n            \"class\": \"File\",\n            \"checksum\": \"sha1$9956fe066bc4fd47770d36b508ada24db67639e4\",\n            \"size\": 87602514,\n            \"http://commonwl.org/cwltool#generation\": 0\n        },\n        {\n            \"location\": \"file:///calrissian/tmp/n_drxp_d/crop_nir.tif\",\n            \"basename\": \"crop_nir.tif\",\n            \"nameroot\": \"crop_nir\",\n            \"nameext\": \".tif\",\n            \"class\": \"File\",\n            \"checksum\": \"sha1$295ef64b75391884bf432db41ba6e677d87ddaab\",\n            \"size\": 100761236,\n            \"http://commonwl.org/cwltool#generation\": 0\n        }\n    ]\n}\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_normalized_difference] path mappings is {\n    \"file:///calrissian/tmp/ah_lxh40/crop_green.tif\": [\n        \"/calrissian/tmp/ah_lxh40/crop_green.tif\",\n        \"/var/lib/cwl/stg9360759c-cad6-4dfc-abaf-e702568ceb64/crop_green.tif\",\n        \"File\",\n        true\n    ],\n    \"file:///calrissian/tmp/n_drxp_d/crop_nir.tif\": [\n        \"/calrissian/tmp/n_drxp_d/crop_nir.tif\",\n        \"/var/lib/cwl/stg3fad6b6e-83ba-46c9-9353-0f2e50fed908/crop_nir.tif\",\n        \"File\",\n        true\n    ]\n}\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_normalized_difference] command line bindings is [\n    {\n        \"position\": [\n            -1000000,\n            0\n        ],\n        \"datum\": \"python\"\n    },\n    {\n        \"position\": [\n            -1000000,\n            1\n        ],\n        \"datum\": \"-m\"\n    },\n    {\n        \"position\": [\n            -1000000,\n            2\n        ],\n        \"datum\": \"app\"\n    },\n    {\n        \"position\": [\n            1,\n            \"rasters\"\n        ],\n        \"datum\": [\n            {\n                \"location\": \"file:///calrissian/tmp/ah_lxh40/crop_green.tif\",\n                \"basename\": \"crop_green.tif\",\n                \"nameroot\": \"crop_green\",\n                \"nameext\": \".tif\",\n                \"class\": \"File\",\n                \"checksum\": \"sha1$9956fe066bc4fd47770d36b508ada24db67639e4\",\n                \"size\": 87602514,\n                \"http://commonwl.org/cwltool#generation\": 0,\n                \"path\": \"/var/lib/cwl/stg9360759c-cad6-4dfc-abaf-e702568ceb64/crop_green.tif\",\n                \"dirname\": \"/var/lib/cwl/stg9360759c-cad6-4dfc-abaf-e702568ceb64\"\n            },\n            {\n                \"location\": \"file:///calrissian/tmp/n_drxp_d/crop_nir.tif\",\n                \"basename\": \"crop_nir.tif\",\n                \"nameroot\": \"crop_nir\",\n                \"nameext\": \".tif\",\n                \"class\": \"File\",\n                \"checksum\": \"sha1$295ef64b75391884bf432db41ba6e677d87ddaab\",\n                \"size\": 100761236,\n                \"http://commonwl.org/cwltool#generation\": 0,\n                \"path\": \"/var/lib/cwl/stg3fad6b6e-83ba-46c9-9353-0f2e50fed908/crop_nir.tif\",\n                \"dirname\": \"/var/lib/cwl/stg3fad6b6e-83ba-46c9-9353-0f2e50fed908\"\n            }\n        ]\n    },\n    {\n        \"position\": [\n            1,\n            \"rasters\",\n            0,\n            0,\n            \"rasters\",\n            \"rasters\"\n        ],\n        \"datum\": {\n            \"location\": \"file:///calrissian/tmp/ah_lxh40/crop_green.tif\",\n            \"basename\": \"crop_green.tif\",\n            \"nameroot\": \"crop_green\",\n            \"nameext\": \".tif\",\n            \"class\": \"File\",\n            \"checksum\": \"sha1$9956fe066bc4fd47770d36b508ada24db67639e4\",\n            \"size\": 87602514,\n            \"http://commonwl.org/cwltool#generation\": 0,\n            \"path\": \"/var/lib/cwl/stg9360759c-cad6-4dfc-abaf-e702568ceb64/crop_green.tif\",\n            \"dirname\": \"/var/lib/cwl/stg9360759c-cad6-4dfc-abaf-e702568ceb64\"\n        }\n    },\n    {\n        \"position\": [\n            1,\n            \"rasters\",\n            1,\n            0,\n            \"rasters\",\n            \"rasters\"\n        ],\n        \"datum\": {\n            \"location\": \"file:///calrissian/tmp/n_drxp_d/crop_nir.tif\",\n            \"basename\": \"crop_nir.tif\",\n            \"nameroot\": \"crop_nir\",\n            \"nameext\": \".tif\",\n            \"class\": \"File\",\n            \"checksum\": \"sha1$295ef64b75391884bf432db41ba6e677d87ddaab\",\n            \"size\": 100761236,\n            \"http://commonwl.org/cwltool#generation\": 0,\n            \"path\": \"/var/lib/cwl/stg3fad6b6e-83ba-46c9-9353-0f2e50fed908/crop_nir.tif\",\n            \"dirname\": \"/var/lib/cwl/stg3fad6b6e-83ba-46c9-9353-0f2e50fed908\"\n        }\n    }\n]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mwait_for_completion with 0 futures\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] job step file:///calrissian/cwl.json#detect_water_body/node_otsu not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] job step file:///calrissian/cwl.json#detect_water_body/node_otsu not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] job step file:///calrissian/cwl.json#detect_water_body/node_otsu not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow ] job step file:///calrissian/cwl.json#main/node_stac not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] job step file:///calrissian/cwl.json#detect_water_body/node_otsu not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mallocate [ram: 512, cores: 1, gpus 0] from available [ram: 16000.0, cores: 8.0, gpus 0]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mwait_for_completion with 1 futures\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_normalized_difference] initial work dir {}\u001b[0m\nBuilding resources spec from {'cores': 1, 'ram': 512, 'gpus': 0}\n--------------------------------------------------------------------------------\napiVersion: v1\nkind: Pod\nmetadata:\n  labels: {}\n  name: node-normalized-difference-pod-xkwpryue\nspec:\n  containers:\n  - args:\n    - python -m app /var/lib/cwl/stg9360759c-cad6-4dfc-abaf-e702568ceb64/crop_green.tif\n      /var/lib/cwl/stg3fad6b6e-83ba-46c9-9353-0f2e50fed908/crop_nir.tif\n    command:\n    - /bin/sh\n    - -c\n    env:\n    - name: HOME\n      value: /nGuThn\n    - name: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - PATH\n      value: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n    - name: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - PYTHONPATH\n      value: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - /app\n    - name: TMPDIR\n      value: /tmp\n    image: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n    - ghcr.io/eoap/mastering-app-package/norm_diff@sha256:641ab55968d7f500b641969d0a7422c4c9a80dd5cc1459ee07f3e0c5ee4fa230\n    name: node-normalized-difference-container\n    resources:\n      requests:\n        cpu: '1'\n        memory: 512Mi\n    volumeMounts:\n    - mountPath: /nGuThn\n      name: argo-cwl-runner-wvqmw-calrissian-wdir\n      readOnly: false\n      subPath: tmp/9xcnshp4\n    - mountPath: /tmp\n      name: tmpdir\n    - mountPath: /var/lib/cwl/stg9360759c-cad6-4dfc-abaf-e702568ceb64/crop_green.tif\n      name: argo-cwl-runner-wvqmw-calrissian-wdir\n      readOnly: true\n      subPath: tmp/ah_lxh40/crop_green.tif\n    - mountPath: /var/lib/cwl/stg3fad6b6e-83ba-46c9-9353-0f2e50fed908/crop_nir.tif\n      name: argo-cwl-runner-wvqmw-calrissian-wdir\n      readOnly: true\n      subPath: tmp/n_drxp_d/crop_nir.tif\n    workingDir: /nGuThn\n  initContainers: []\n  nodeSelector: {}\n  restartPolicy: Never\n  securityContext:\n    runAsGroup: 0\n    runAsUser: 0\n  serviceAccountName: argo\n  volumes:\n  - name: argo-cwl-runner-wvqmw-calrissian-wdir\n    persistentVolumeClaim:\n      claimName: argo-cwl-runner-wvqmw-calrissian-wdir\n      readOnly: false\n  - emptyDir: {}\n    name: tmpdir\n--------------------------------------------------------------------------------\n\nCreated k8s pod name node-normalized-difference-pod-xkwpryue with id 073b3c4f-b30b-44a4-bd42-06db3745b4d0\nPodMonitor adding node-normalized-difference-pod-xkwpryue\nk8s pod 'node-normalized-difference-pod-xkwpryue' started\npod name node-normalized-difference-pod-xkwpryue with id 073b3c4f-b30b-44a4-bd42-06db3745b4d0 has status None\npod name node-normalized-difference-pod-xkwpryue with id 073b3c4f-b30b-44a4-bd42-06db3745b4d0 has status {'allocated_resources': None,\n 'container_id': None,\n 'image': 'ghcr.io/eoap/mastering-app-package/norm_diff@sha256:641ab55968d7f500b641969d0a7422c4c9a80dd5cc1459ee07f3e0c5ee4fa230',\n 'image_id': '',\n 'last_state': {'running': None, 'terminated': None, 'waiting': None},\n 'name': 'node-normalized-difference-container',\n 'ready': False,\n 'resources': None,\n 'restart_count': 0,\n 'started': False,\n 'state': {'running': None,\n           'terminated': None,\n           'waiting': {'message': None, 'reason': 'ContainerCreating'}}}\npod name node-normalized-difference-pod-xkwpryue with id 073b3c4f-b30b-44a4-bd42-06db3745b4d0 has status {'allocated_resources': None,\n 'container_id': 'docker://9438fa6ca0b2af0246b3bf1661945b75f2cc9a61c8f4a4fbe3a4dd99fa27249d',\n 'image': 'sha256:9eea4fb39f705d92bb5a2ccd99c8ab1d6260155c3a51a7761c9895bc3ad64587',\n 'image_id': 'docker-pullable://ghcr.io/eoap/mastering-app-package/norm_diff@sha256:641ab55968d7f500b641969d0a7422c4c9a80dd5cc1459ee07f3e0c5ee4fa230',\n 'last_state': {'running': None, 'terminated': None, 'waiting': None},\n 'name': 'node-normalized-difference-container',\n 'ready': True,\n 'resources': None,\n 'restart_count': 0,\n 'started': True,\n 'state': {'running': {'started_at': datetime.datetime(2024, 7, 19, 10, 40, 31, tzinfo=tzlocal())},\n           'terminated': None,\n           'waiting': None}}\n[node-normalized-difference-pod-xkwpryue] follow_logs start\n[node-normalized-difference-pod-xkwpryue] 2024-07-19 10:40:31.915 | INFO     | __main__:normalized_difference:18 - Processing the normalized image with /var/lib/cwl/stg9360759c-cad6-4dfc-abaf-e702568ceb64/crop_green.tif and /var/lib/cwl/stg3fad6b6e-83ba-46c9-9353-0f2e50fed908/crop_nir.tif\n[node-normalized-difference-pod-xkwpryue] 2024-07-19 10:40:32.933 | INFO     | __main__:normalized_difference:39 - Write norm_diff.tif\n[node-normalized-difference-pod-xkwpryue] 2024-07-19 10:40:37.514 | INFO     | __main__:normalized_difference:42 - Done!\n[node-normalized-difference-pod-xkwpryue] follow_logs end\npod name node-normalized-difference-pod-xkwpryue with id 073b3c4f-b30b-44a4-bd42-06db3745b4d0 has status {'allocated_resources': None,\n 'container_id': 'docker://9438fa6ca0b2af0246b3bf1661945b75f2cc9a61c8f4a4fbe3a4dd99fa27249d',\n 'image': 'sha256:9eea4fb39f705d92bb5a2ccd99c8ab1d6260155c3a51a7761c9895bc3ad64587',\n 'image_id': 'docker-pullable://ghcr.io/eoap/mastering-app-package/norm_diff@sha256:641ab55968d7f500b641969d0a7422c4c9a80dd5cc1459ee07f3e0c5ee4fa230',\n 'last_state': {'running': None, 'terminated': None, 'waiting': None},\n 'name': 'node-normalized-difference-container',\n 'ready': False,\n 'resources': None,\n 'restart_count': 0,\n 'started': False,\n 'state': {'running': None,\n           'terminated': {'container_id': 'docker://9438fa6ca0b2af0246b3bf1661945b75f2cc9a61c8f4a4fbe3a4dd99fa27249d',\n                          'exit_code': 0,\n                          'finished_at': datetime.datetime(2024, 7, 19, 10, 40, 37, tzinfo=tzlocal()),\n                          'message': None,\n                          'reason': 'Completed',\n                          'signal': None,\n                          'started_at': datetime.datetime(2024, 7, 19, 10, 40, 31, tzinfo=tzlocal())},\n           'waiting': None}}\nHandling terminated pod name node-normalized-difference-pod-xkwpryue with id 073b3c4f-b30b-44a4-bd42-06db3745b4d0\nhandling completion with 0\nPodMonitor removing node-normalized-difference-pod-xkwpryue\nWriting pod node_normalized_difference logs to /calrissian/logs/node_normalized_difference.log\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[step node_normalized_difference] produced output {\n    \"file:///calrissian/cwl.json#detect_water_body/node_normalized_difference/ndwi\": {\n        \"location\": \"file:///calrissian/tmp/9xcnshp4/norm_diff.tif\",\n        \"basename\": \"norm_diff.tif\",\n        \"nameroot\": \"norm_diff\",\n        \"nameext\": \".tif\",\n        \"class\": \"File\",\n        \"checksum\": \"sha1$8a8000c4b3fa09be2364ce009710c11124d009ca\",\n        \"size\": 224221619,\n        \"http://commonwl.org/cwltool#generation\": 0\n    }\n}\u001b[0m\n\u001b[1;30mINFO\u001b[0m [step node_normalized_difference] completed success\nshutil.rmtree(/tmp/ria3mtjs, True)\nshutil.rmtree(/tmp/3owexlu0, True)\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mrestore [ram: 512, cores: 1, gpus 0] to available [ram: 15488.0, cores: 7.0, gpus 0]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow ] job step file:///calrissian/cwl.json#main/node_stac not ready\u001b[0m\n\u001b[1;30mINFO\u001b[0m [workflow node_water_bodies] starting step node_otsu\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[step node_otsu] job input {\n    \"file:///calrissian/cwl.json#detect_water_body/node_otsu/raster\": {\n        \"location\": \"file:///calrissian/tmp/9xcnshp4/norm_diff.tif\",\n        \"basename\": \"norm_diff.tif\",\n        \"nameroot\": \"norm_diff\",\n        \"nameext\": \".tif\",\n        \"class\": \"File\",\n        \"checksum\": \"sha1$8a8000c4b3fa09be2364ce009710c11124d009ca\",\n        \"size\": 224221619,\n        \"http://commonwl.org/cwltool#generation\": 0\n    }\n}\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[step node_otsu] evaluated job input to {\n    \"file:///calrissian/cwl.json#detect_water_body/node_otsu/raster\": {\n        \"location\": \"file:///calrissian/tmp/9xcnshp4/norm_diff.tif\",\n        \"basename\": \"norm_diff.tif\",\n        \"nameroot\": \"norm_diff\",\n        \"nameext\": \".tif\",\n        \"class\": \"File\",\n        \"checksum\": \"sha1$8a8000c4b3fa09be2364ce009710c11124d009ca\",\n        \"size\": 224221619,\n        \"http://commonwl.org/cwltool#generation\": 0\n    }\n}\u001b[0m\n\u001b[1;30mINFO\u001b[0m [step node_otsu] start\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_otsu] initializing from file:///calrissian/cwl.json#otsu as part of step node_otsu\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_otsu] {\n    \"raster\": {\n        \"location\": \"file:///calrissian/tmp/9xcnshp4/norm_diff.tif\",\n        \"basename\": \"norm_diff.tif\",\n        \"nameroot\": \"norm_diff\",\n        \"nameext\": \".tif\",\n        \"class\": \"File\",\n        \"checksum\": \"sha1$8a8000c4b3fa09be2364ce009710c11124d009ca\",\n        \"size\": 224221619,\n        \"http://commonwl.org/cwltool#generation\": 0\n    }\n}\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_otsu] path mappings is {\n    \"file:///calrissian/tmp/9xcnshp4/norm_diff.tif\": [\n        \"/calrissian/tmp/9xcnshp4/norm_diff.tif\",\n        \"/var/lib/cwl/stge43aa38e-01c8-49f9-90f1-45bc534a5e1f/norm_diff.tif\",\n        \"File\",\n        true\n    ]\n}\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_otsu] command line bindings is [\n    {\n        \"position\": [\n            -1000000,\n            0\n        ],\n        \"datum\": \"python\"\n    },\n    {\n        \"position\": [\n            -1000000,\n            1\n        ],\n        \"datum\": \"-m\"\n    },\n    {\n        \"position\": [\n            -1000000,\n            2\n        ],\n        \"datum\": \"app\"\n    },\n    {\n        \"position\": [\n            1,\n            \"raster\"\n        ],\n        \"datum\": {\n            \"location\": \"file:///calrissian/tmp/9xcnshp4/norm_diff.tif\",\n            \"basename\": \"norm_diff.tif\",\n            \"nameroot\": \"norm_diff\",\n            \"nameext\": \".tif\",\n            \"class\": \"File\",\n            \"checksum\": \"sha1$8a8000c4b3fa09be2364ce009710c11124d009ca\",\n            \"size\": 224221619,\n            \"http://commonwl.org/cwltool#generation\": 0,\n            \"path\": \"/var/lib/cwl/stge43aa38e-01c8-49f9-90f1-45bc534a5e1f/norm_diff.tif\",\n            \"dirname\": \"/var/lib/cwl/stge43aa38e-01c8-49f9-90f1-45bc534a5e1f\"\n        }\n    }\n]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mwait_for_completion with 0 futures\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow ] job step file:///calrissian/cwl.json#main/node_stac not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mallocate [ram: 512, cores: 1, gpus 0] from available [ram: 16000.0, cores: 8.0, gpus 0]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mwait_for_completion with 1 futures\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_otsu] initial work dir {}\u001b[0m\nBuilding resources spec from {'cores': 1, 'ram': 512, 'gpus': 0}\n--------------------------------------------------------------------------------\napiVersion: v1\nkind: Pod\nmetadata:\n  labels: {}\n  name: node-otsu-pod-edyejmqx\nspec:\n  containers:\n  - args:\n    - python -m app /var/lib/cwl/stge43aa38e-01c8-49f9-90f1-45bc534a5e1f/norm_diff.tif\n    command:\n    - /bin/sh\n    - -c\n    env:\n    - name: HOME\n      value: /nGuThn\n    - name: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - PATH\n      value: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n    - name: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - PYTHONPATH\n      value: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - /app\n    - name: TMPDIR\n      value: /tmp\n    image: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n    - ghcr.io/eoap/mastering-app-package/otsu@sha256:ec02baf6a007ebb5a2dc037af2da8ef94db67bb8a6139682ad61041f9d27c779\n    name: node-otsu-container\n    resources:\n      requests:\n        cpu: '1'\n        memory: 512Mi\n    volumeMounts:\n    - mountPath: /nGuThn\n      name: argo-cwl-runner-wvqmw-calrissian-wdir\n      readOnly: false\n      subPath: tmp/ayi9uzmv\n    - mountPath: /tmp\n      name: tmpdir\n    - mountPath: /var/lib/cwl/stge43aa38e-01c8-49f9-90f1-45bc534a5e1f/norm_diff.tif\n      name: argo-cwl-runner-wvqmw-calrissian-wdir\n      readOnly: true\n      subPath: tmp/9xcnshp4/norm_diff.tif\n    workingDir: /nGuThn\n  initContainers: []\n  nodeSelector: {}\n  restartPolicy: Never\n  securityContext:\n    runAsGroup: 0\n    runAsUser: 0\n  serviceAccountName: argo\n  volumes:\n  - name: argo-cwl-runner-wvqmw-calrissian-wdir\n    persistentVolumeClaim:\n      claimName: argo-cwl-runner-wvqmw-calrissian-wdir\n      readOnly: false\n  - emptyDir: {}\n    name: tmpdir\n--------------------------------------------------------------------------------\n\nCreated k8s pod name node-otsu-pod-edyejmqx with id ef84ca4d-89c8-41ad-afaa-a43c18a31640\nPodMonitor adding node-otsu-pod-edyejmqx\nk8s pod 'node-otsu-pod-edyejmqx' started\npod name node-otsu-pod-edyejmqx with id ef84ca4d-89c8-41ad-afaa-a43c18a31640 has status None\npod name node-otsu-pod-edyejmqx with id ef84ca4d-89c8-41ad-afaa-a43c18a31640 has status {'allocated_resources': None,\n 'container_id': None,\n 'image': 'ghcr.io/eoap/mastering-app-package/otsu@sha256:ec02baf6a007ebb5a2dc037af2da8ef94db67bb8a6139682ad61041f9d27c779',\n 'image_id': '',\n 'last_state': {'running': None, 'terminated': None, 'waiting': None},\n 'name': 'node-otsu-container',\n 'ready': False,\n 'resources': None,\n 'restart_count': 0,\n 'started': False,\n 'state': {'running': None,\n           'terminated': None,\n           'waiting': {'message': None, 'reason': 'ContainerCreating'}}}\npod name node-otsu-pod-edyejmqx with id ef84ca4d-89c8-41ad-afaa-a43c18a31640 has status {'allocated_resources': None,\n 'container_id': 'docker://dda89dcc2b7350d43b66008835ebfe9152899325b707cc4d787c6ceb402973c4',\n 'image': 'sha256:30f412cc580cc072605130893c652082fbbcf68ac6f02984468b492361ad787c',\n 'image_id': 'docker-pullable://ghcr.io/eoap/mastering-app-package/otsu@sha256:ec02baf6a007ebb5a2dc037af2da8ef94db67bb8a6139682ad61041f9d27c779',\n 'last_state': {'running': None, 'terminated': None, 'waiting': None},\n 'name': 'node-otsu-container',\n 'ready': True,\n 'resources': None,\n 'restart_count': 0,\n 'started': True,\n 'state': {'running': {'started_at': datetime.datetime(2024, 7, 19, 10, 40, 38, tzinfo=tzlocal())},\n           'terminated': None,\n           'waiting': None}}\n[node-otsu-pod-edyejmqx] follow_logs start\n[node-otsu-pod-edyejmqx] 2024-07-19 10:40:39.942 | INFO     | __main__:otsu:37 - Applying the Otsu threshold to /var/lib/cwl/stge43aa38e-01c8-49f9-90f1-45bc534a5e1f/norm_diff.tif\n[node-otsu-pod-edyejmqx] 2024-07-19 10:40:39.945 | INFO     | __main__:otsu:40 - Write otsu.tif\n[node-otsu-pod-edyejmqx] 2024-07-19 10:40:41.028 | INFO     | __main__:otsu:43 - Done!\n[node-otsu-pod-edyejmqx] follow_logs end\npod name node-otsu-pod-edyejmqx with id ef84ca4d-89c8-41ad-afaa-a43c18a31640 has status {'allocated_resources': None,\n 'container_id': 'docker://dda89dcc2b7350d43b66008835ebfe9152899325b707cc4d787c6ceb402973c4',\n 'image': 'sha256:30f412cc580cc072605130893c652082fbbcf68ac6f02984468b492361ad787c',\n 'image_id': 'docker-pullable://ghcr.io/eoap/mastering-app-package/otsu@sha256:ec02baf6a007ebb5a2dc037af2da8ef94db67bb8a6139682ad61041f9d27c779',\n 'last_state': {'running': None, 'terminated': None, 'waiting': None},\n 'name': 'node-otsu-container',\n 'ready': False,\n 'resources': None,\n 'restart_count': 0,\n 'started': False,\n 'state': {'running': None,\n           'terminated': {'container_id': 'docker://dda89dcc2b7350d43b66008835ebfe9152899325b707cc4d787c6ceb402973c4',\n                          'exit_code': 0,\n                          'finished_at': datetime.datetime(2024, 7, 19, 10, 40, 41, tzinfo=tzlocal()),\n                          'message': None,\n                          'reason': 'Completed',\n                          'signal': None,\n                          'started_at': datetime.datetime(2024, 7, 19, 10, 40, 38, tzinfo=tzlocal())},\n           'waiting': None}}\nHandling terminated pod name node-otsu-pod-edyejmqx with id ef84ca4d-89c8-41ad-afaa-a43c18a31640\nhandling completion with 0\nPodMonitor removing node-otsu-pod-edyejmqx\nWriting pod node_otsu logs to /calrissian/logs/node_otsu.log\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[step node_otsu] produced output {\n    \"file:///calrissian/cwl.json#detect_water_body/node_otsu/binary_mask_item\": {\n        \"location\": \"file:///calrissian/tmp/ayi9uzmv/otsu.tif\",\n        \"basename\": \"otsu.tif\",\n        \"nameroot\": \"otsu\",\n        \"nameext\": \".tif\",\n        \"class\": \"File\",\n        \"checksum\": \"sha1$210598cf619d49eabfdc24414bd445f59668f3bd\",\n        \"size\": 289288,\n        \"http://commonwl.org/cwltool#generation\": 0\n    }\n}\u001b[0m\n\u001b[1;30mINFO\u001b[0m [step node_otsu] completed success\n\u001b[1;30mINFO\u001b[0m [workflow node_water_bodies] completed success\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] outputs {\n    \"detected_water_body\": {\n        \"location\": \"file:///calrissian/tmp/ayi9uzmv/otsu.tif\",\n        \"basename\": \"otsu.tif\",\n        \"nameroot\": \"otsu\",\n        \"nameext\": \".tif\",\n        \"class\": \"File\",\n        \"checksum\": \"sha1$210598cf619d49eabfdc24414bd445f59668f3bd\",\n        \"size\": 289288,\n        \"http://commonwl.org/cwltool#generation\": 0\n    }\n}\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[step node_water_bodies] produced output {\n    \"file:///calrissian/cwl.json#main/node_water_bodies/detected_water_body\": [\n        {\n            \"location\": \"file:///calrissian/tmp/ayi9uzmv/otsu.tif\",\n            \"basename\": \"otsu.tif\",\n            \"nameroot\": \"otsu\",\n            \"nameext\": \".tif\",\n            \"class\": \"File\",\n            \"checksum\": \"sha1$210598cf619d49eabfdc24414bd445f59668f3bd\",\n            \"size\": 289288,\n            \"http://commonwl.org/cwltool#generation\": 0\n        }\n    ]\n}\u001b[0m\n\u001b[1;30mINFO\u001b[0m [step node_water_bodies] completed success\nshutil.rmtree(/tmp/iqlmpw90, True)\nshutil.rmtree(/tmp/3lytara0, True)\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mrestore [ram: 512, cores: 1, gpus 0] to available [ram: 15488.0, cores: 7.0, gpus 0]\u001b[0m\n\u001b[1;30mINFO\u001b[0m [workflow ] starting step node_stac\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[step node_stac] job input {\n    \"file:///calrissian/cwl.json#main/node_stac/item\": [\n        \"https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\"\n    ],\n    \"file:///calrissian/cwl.json#main/node_stac/rasters\": [\n        {\n            \"location\": \"file:///calrissian/tmp/ayi9uzmv/otsu.tif\",\n            \"basename\": \"otsu.tif\",\n            \"nameroot\": \"otsu\",\n            \"nameext\": \".tif\",\n            \"class\": \"File\",\n            \"checksum\": \"sha1$210598cf619d49eabfdc24414bd445f59668f3bd\",\n            \"size\": 289288,\n            \"http://commonwl.org/cwltool#generation\": 0\n        }\n    ]\n}\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[step node_stac] evaluated job input to {\n    \"file:///calrissian/cwl.json#main/node_stac/item\": [\n        \"https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\"\n    ],\n    \"file:///calrissian/cwl.json#main/node_stac/rasters\": [\n        {\n            \"location\": \"file:///calrissian/tmp/ayi9uzmv/otsu.tif\",\n            \"basename\": \"otsu.tif\",\n            \"nameroot\": \"otsu\",\n            \"nameext\": \".tif\",\n            \"class\": \"File\",\n            \"checksum\": \"sha1$210598cf619d49eabfdc24414bd445f59668f3bd\",\n            \"size\": 289288,\n            \"http://commonwl.org/cwltool#generation\": 0\n        }\n    ]\n}\u001b[0m\n\u001b[1;30mINFO\u001b[0m [step node_stac] start\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_stac] initializing from file:///calrissian/cwl.json#stac as part of step node_stac\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_stac] {\n    \"item\": [\n        \"https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\"\n    ],\n    \"rasters\": [\n        {\n            \"location\": \"file:///calrissian/tmp/ayi9uzmv/otsu.tif\",\n            \"basename\": \"otsu.tif\",\n            \"nameroot\": \"otsu\",\n            \"nameext\": \".tif\",\n            \"class\": \"File\",\n            \"checksum\": \"sha1$210598cf619d49eabfdc24414bd445f59668f3bd\",\n            \"size\": 289288,\n            \"http://commonwl.org/cwltool#generation\": 0\n        }\n    ]\n}\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_stac] path mappings is {\n    \"file:///calrissian/tmp/ayi9uzmv/otsu.tif\": [\n        \"/calrissian/tmp/ayi9uzmv/otsu.tif\",\n        \"/var/lib/cwl/stg08303c53-2a5b-499c-88f1-c6296bbd6508/otsu.tif\",\n        \"File\",\n        true\n    ]\n}\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_stac] command line bindings is [\n    {\n        \"position\": [\n            -1000000,\n            0\n        ],\n        \"datum\": \"python\"\n    },\n    {\n        \"position\": [\n            -1000000,\n            1\n        ],\n        \"datum\": \"-m\"\n    },\n    {\n        \"position\": [\n            -1000000,\n            2\n        ],\n        \"datum\": \"app\"\n    },\n    {\n        \"prefix\": \"--input-item\",\n        \"position\": [\n            0,\n            0,\n            \"item\",\n            \"item\"\n        ],\n        \"datum\": \"https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\"\n    },\n    {\n        \"prefix\": \"--water-body\",\n        \"position\": [\n            0,\n            0,\n            \"rasters\",\n            \"rasters\"\n        ],\n        \"datum\": {\n            \"location\": \"file:///calrissian/tmp/ayi9uzmv/otsu.tif\",\n            \"basename\": \"otsu.tif\",\n            \"nameroot\": \"otsu\",\n            \"nameext\": \".tif\",\n            \"class\": \"File\",\n            \"checksum\": \"sha1$210598cf619d49eabfdc24414bd445f59668f3bd\",\n            \"size\": 289288,\n            \"http://commonwl.org/cwltool#generation\": 0,\n            \"path\": \"/var/lib/cwl/stg08303c53-2a5b-499c-88f1-c6296bbd6508/otsu.tif\",\n            \"dirname\": \"/var/lib/cwl/stg08303c53-2a5b-499c-88f1-c6296bbd6508\"\n        }\n    }\n]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mwait_for_completion with 0 futures\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mallocate [ram: 512, cores: 1, gpus 0] from available [ram: 16000.0, cores: 8.0, gpus 0]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mwait_for_completion with 1 futures\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_stac] initial work dir {}\u001b[0m\nBuilding resources spec from {'cores': 1, 'ram': 512, 'gpus': 0}\n--------------------------------------------------------------------------------\napiVersion: v1\nkind: Pod\nmetadata:\n  labels: {}\n  name: node-stac-pod-lebziriu\nspec:\n  containers:\n  - args:\n    - python -m app --input-item https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\n      --water-body /var/lib/cwl/stg08303c53-2a5b-499c-88f1-c6296bbd6508/otsu.tif\n    command:\n    - /bin/sh\n    - -c\n    env:\n    - name: HOME\n      value: /nGuThn\n    - name: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - PATH\n      value: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n    - name: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - PYTHONPATH\n      value: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - /app\n    - name: TMPDIR\n      value: /tmp\n    image: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n    - ghcr.io/eoap/mastering-app-package/stac@sha256:8ad7e7d6999c0c4c91c2b19ce231f24734d2af8f41b855ef9a06276d23345601\n    name: node-stac-container\n    resources:\n      requests:\n        cpu: '1'\n        memory: 512Mi\n    volumeMounts:\n    - mountPath: /nGuThn\n      name: argo-cwl-runner-wvqmw-calrissian-wdir\n      readOnly: false\n      subPath: tmp/73k_b1lo\n    - mountPath: /tmp\n      name: tmpdir\n    - mountPath: /var/lib/cwl/stg08303c53-2a5b-499c-88f1-c6296bbd6508/otsu.tif\n      name: argo-cwl-runner-wvqmw-calrissian-wdir\n      readOnly: true\n      subPath: tmp/ayi9uzmv/otsu.tif\n    workingDir: /nGuThn\n  initContainers: []\n  nodeSelector: {}\n  restartPolicy: Never\n  securityContext:\n    runAsGroup: 0\n    runAsUser: 0\n  serviceAccountName: argo\n  volumes:\n  - name: argo-cwl-runner-wvqmw-calrissian-wdir\n    persistentVolumeClaim:\n      claimName: argo-cwl-runner-wvqmw-calrissian-wdir\n      readOnly: false\n  - emptyDir: {}\n    name: tmpdir\n--------------------------------------------------------------------------------\n\nCreated k8s pod name node-stac-pod-lebziriu with id 33b47951-0174-4110-a369-0e978e50862e\nPodMonitor adding node-stac-pod-lebziriu\nk8s pod 'node-stac-pod-lebziriu' started\npod name node-stac-pod-lebziriu with id 33b47951-0174-4110-a369-0e978e50862e has status None\npod name node-stac-pod-lebziriu with id 33b47951-0174-4110-a369-0e978e50862e has status None\npod name node-stac-pod-lebziriu with id 33b47951-0174-4110-a369-0e978e50862e has status {'allocated_resources': None,\n 'container_id': None,\n 'image': 'ghcr.io/eoap/mastering-app-package/stac@sha256:8ad7e7d6999c0c4c91c2b19ce231f24734d2af8f41b855ef9a06276d23345601',\n 'image_id': '',\n 'last_state': {'running': None, 'terminated': None, 'waiting': None},\n 'name': 'node-stac-container',\n 'ready': False,\n 'resources': None,\n 'restart_count': 0,\n 'started': False,\n 'state': {'running': None,\n           'terminated': None,\n           'waiting': {'message': None, 'reason': 'ContainerCreating'}}}\npod name node-stac-pod-lebziriu with id 33b47951-0174-4110-a369-0e978e50862e has status {'allocated_resources': None,\n 'container_id': 'docker://a78d92e03db84b5f73e4359e163821c5b04be3d19eb39e8ec756a34f95a3dada',\n 'image': 'sha256:49137993bbc6c46dfaa4456e2f576ff7a093fade098e2e6499b3dcf210b69bcb',\n 'image_id': 'docker-pullable://ghcr.io/eoap/mastering-app-package/stac@sha256:8ad7e7d6999c0c4c91c2b19ce231f24734d2af8f41b855ef9a06276d23345601',\n 'last_state': {'running': None, 'terminated': None, 'waiting': None},\n 'name': 'node-stac-container',\n 'ready': True,\n 'resources': None,\n 'restart_count': 0,\n 'started': True,\n 'state': {'running': {'started_at': datetime.datetime(2024, 7, 19, 10, 40, 42, tzinfo=tzlocal())},\n           'terminated': None,\n           'waiting': None}}\n[node-stac-pod-lebziriu] follow_logs start\n[node-stac-pod-lebziriu] 2024-07-19 10:40:42.958 | INFO     | __main__:to_stac:31 - Creating a STAC Catalog for /var/lib/cwl/stg08303c53-2a5b-499c-88f1-c6296bbd6508/otsu.tif\n[node-stac-pod-lebziriu] 2024-07-19 10:40:43.272 | INFO     | __main__:to_stac:62 - Done!\n[node-stac-pod-lebziriu] follow_logs end\npod name node-stac-pod-lebziriu with id 33b47951-0174-4110-a369-0e978e50862e has status {'allocated_resources': None,\n 'container_id': 'docker://a78d92e03db84b5f73e4359e163821c5b04be3d19eb39e8ec756a34f95a3dada',\n 'image': 'sha256:49137993bbc6c46dfaa4456e2f576ff7a093fade098e2e6499b3dcf210b69bcb',\n 'image_id': 'docker-pullable://ghcr.io/eoap/mastering-app-package/stac@sha256:8ad7e7d6999c0c4c91c2b19ce231f24734d2af8f41b855ef9a06276d23345601',\n 'last_state': {'running': None, 'terminated': None, 'waiting': None},\n 'name': 'node-stac-container',\n 'ready': False,\n 'resources': None,\n 'restart_count': 0,\n 'started': False,\n 'state': {'running': None,\n           'terminated': {'container_id': 'docker://a78d92e03db84b5f73e4359e163821c5b04be3d19eb39e8ec756a34f95a3dada',\n                          'exit_code': 0,\n                          'finished_at': datetime.datetime(2024, 7, 19, 10, 40, 43, tzinfo=tzlocal()),\n                          'message': None,\n                          'reason': 'Completed',\n                          'signal': None,\n                          'started_at': datetime.datetime(2024, 7, 19, 10, 40, 42, tzinfo=tzlocal())},\n           'waiting': None}}\nHandling terminated pod name node-stac-pod-lebziriu with id 33b47951-0174-4110-a369-0e978e50862e\nhandling completion with 0\nPodMonitor removing node-stac-pod-lebziriu\nWriting pod node_stac logs to /calrissian/logs/node_stac.log\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[step node_stac] produced output {\n    \"file:///calrissian/cwl.json#main/node_stac/stac_catalog\": {\n        \"location\": \"file:///calrissian/tmp/73k_b1lo\",\n        \"basename\": \"73k_b1lo\",\n        \"nameroot\": \"73k_b1lo\",\n        \"nameext\": \"\",\n        \"class\": \"Directory\"\n    }\n}\u001b[0m\n\u001b[1;30mINFO\u001b[0m [step node_stac] completed success\n\u001b[1;30mINFO\u001b[0m [workflow ] completed success\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow ] outputs {\n    \"stac_catalog\": {\n        \"location\": \"file:///calrissian/tmp/73k_b1lo\",\n        \"basename\": \"73k_b1lo\",\n        \"nameroot\": \"73k_b1lo\",\n        \"nameext\": \"\",\n        \"class\": \"Directory\"\n    }\n}\u001b[0m\nshutil.rmtree(/tmp/d_rzljxw, True)\nshutil.rmtree(/tmp/oanc2um0, True)\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mrestore [ram: 512, cores: 1, gpus 0] to available [ram: 15488.0, cores: 7.0, gpus 0]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mwait_for_completion with 0 futures\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mwait_for_completion with 0 futures\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mFinishing ThreadPoolExecutor.run_jobs: total_resources=[ram: 16000.0, cores: 8.0, gpus 0], available_resources=[ram: 16000.0, cores: 8.0, gpus 0]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mMoving /calrissian/tmp/73k_b1lo to /calrissian/results/73k_b1lo\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mRemoving intermediate output directory /calrissian/tmp/9xcnshp4\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mRemoving intermediate output directory /calrissian/tmp/ayi9uzmv\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mRemoving intermediate output directory /calrissian/tmp/n_drxp_d\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mRemoving intermediate output directory /calrissian/tmp/vb9bzgzg\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mRemoving intermediate output directory /calrissian/tmp/isvjnknv\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mRemoving intermediate output directory /calrissian/tmp/ah_lxh40\u001b[0m\n\u001b[1;30mINFO\u001b[0m Final process status is success\nStarting Cleanup\nFinishing Cleanup"},{"name":"usage-report","value":"{\n    \"cores_allowed\": 8.0,\n    \"ram_mb_allowed\": 16000.0,\n    \"children\": [\n        {\n            \"cpus\": 1.0,\n            \"ram_megabytes\": 536.870912,\n            \"disk_megabytes\": 87.602514,\n            \"exit_code\": 0,\n            \"name\": \"node_crop\",\n            \"start_time\": \"2024-07-19T10:40:02+00:00\",\n            \"finish_time\": \"2024-07-19T10:40:27+00:00\",\n            \"elapsed_hours\": 0.006944444444444444,\n            \"elapsed_seconds\": 25.0,\n            \"ram_megabyte_hours\": 3.7282702222222217,\n            \"cpu_hours\": 0.006944444444444444\n        },\n        {\n            \"cpus\": 1.0,\n            \"ram_megabytes\": 536.870912,\n            \"disk_megabytes\": 100.761236,\n            \"exit_code\": 0,\n            \"name\": \"node_crop_2\",\n            \"start_time\": \"2024-07-19T10:40:02+00:00\",\n            \"finish_time\": \"2024-07-19T10:40:30+00:00\",\n            \"elapsed_hours\": 0.0077777777777777776,\n            \"elapsed_seconds\": 28.0,\n            \"ram_megabyte_hours\": 4.175662648888888,\n            \"cpu_hours\": 0.0077777777777777776\n        },\n        {\n            \"cpus\": 1.0,\n            \"ram_megabytes\": 536.870912,\n            \"disk_megabytes\": 224.221619,\n            \"exit_code\": 0,\n            \"name\": \"node_normalized_difference\",\n            \"start_time\": \"2024-07-19T10:40:31+00:00\",\n            \"finish_time\": \"2024-07-19T10:40:37+00:00\",\n            \"elapsed_hours\": 0.0016666666666666668,\n            \"elapsed_seconds\": 6.0,\n            \"ram_megabyte_hours\": 0.8947848533333334,\n            \"cpu_hours\": 0.0016666666666666668\n        },\n        {\n            \"cpus\": 1.0,\n            \"ram_megabytes\": 536.870912,\n            \"disk_megabytes\": 0.289288,\n            \"exit_code\": 0,\n            \"name\": \"node_otsu\",\n            \"start_time\": \"2024-07-19T10:40:38+00:00\",\n            \"finish_time\": \"2024-07-19T10:40:41+00:00\",\n            \"elapsed_hours\": 0.0008333333333333334,\n            \"elapsed_seconds\": 3.0,\n            \"ram_megabyte_hours\": 0.4473924266666667,\n            \"cpu_hours\": 0.0008333333333333334\n        },\n        {\n            \"cpus\": 1.0,\n            \"ram_megabytes\": 536.870912,\n            \"disk_megabytes\": 0.0,\n            \"exit_code\": 0,\n            \"name\": \"node_stac\",\n            \"start_time\": \"2024-07-19T10:40:42+00:00\",\n            \"finish_time\": \"2024-07-19T10:40:43+00:00\",\n            \"elapsed_hours\": 0.0002777777777777778,\n            \"elapsed_seconds\": 1.0,\n            \"ram_megabyte_hours\": 0.14913080888888888,\n            \"cpu_hours\": 0.0002777777777777778\n        }\n    ],\n    \"start_time\": \"2024-07-19T10:40:02+00:00\",\n    \"finish_time\": \"2024-07-19T10:40:43+00:00\",\n    \"elapsed_hours\": 0.01138888888888889,\n    \"elapsed_seconds\": 41.0,\n    \"total_cpu_hours\": 0.017499999999999995,\n    \"total_ram_megabyte_hours\": 9.39524096,\n    \"total_disk_megabytes\": 412.874657,\n    \"total_tasks\": 5,\n    \"max_parallel_cpus\": 2.0,\n    \"max_parallel_ram_megabytes\": 1073.741824,\n    \"max_parallel_tasks\": 2\n}"},{"name":"stac-catalog","value":"s3://results/argo-cwl-runner-wvqmw/catalog.json"}],"artifacts":[{"name":"tool-logs","path":"/calrissian/logs","s3":{"key":"argo-cwl-runner-wvqmw-artifacts/tool-logs.tgz"}},{"name":"calrissian-output","path":"/tmp/calrissian-output.json","s3":{"key":"argo-cwl-runner-wvqmw-artifacts/calrissian-output.tgz"}},{"name":"calrissian-stderr","path":"/tmp/calrissian-stderr.txt","s3":{"key":"argo-cwl-runner-wvqmw-artifacts/calrissian-stderr.tgz"}},{"name":"calrissian-report","path":"/tmp/calrissian-report.json","s3":{"key":"argo-cwl-runner-wvqmw-artifacts/calrissian-report.tgz"}}]},"children":["argo-cwl-runner-wvqmw-2434070197"],"outboundNodes":["argo-cwl-runner-wvqmw-3279323762","argo-cwl-runner-wvqmw-2838679990"]},"argo-cwl-runner-wvqmw-1289416099":{"id":"argo-cwl-runner-wvqmw-1289416099","name":"argo-cwl-runner-wvqmw[0].cwl-prepare","displayName":"cwl-prepare","type":"Pod","templateName":"cwl-prepare","templateScope":"local/","phase":"Succeeded","boundaryID":"argo-cwl-runner-wvqmw","startedAt":"2024-07-19T10:39:46Z","finishedAt":"2024-07-19T10:39:51Z","estimatedDuration":5,"progress":"1/1","resourcesDuration":{"cpu":1,"memory":13},"inputs":{"parameters":[{"name":"cwl","value":"{\"cwlVersion\":\"v1.0\",\"$namespaces\":{\"s\":\"https://schema.org/\"},\"s:softwareVersion\":\"1.0.0\",\"schemas\":[\"http://schema.org/version/9.0/schemaorg-current-http.rdf\"],\"$graph\":[{\"class\":\"Workflow\",\"id\":\"main\",\"label\":\"Water bodies detection based on NDWI and otsu threshold\",\"doc\":\"Water bodies detection based on NDWI and otsu threshold applied to Sentinel-2 COG STAC items\",\"requirements\":[{\"class\":\"ScatterFeatureRequirement\"},{\"class\":\"SubworkflowFeatureRequirement\"}],\"inputs\":{\"aoi\":{\"label\":\"area of interest\",\"doc\":\"area of interest as a bounding box\",\"type\":\"string\"},\"epsg\":{\"label\":\"EPSG code\",\"doc\":\"EPSG code\",\"type\":\"string\",\"default\":\"EPSG:4326\"},\"stac_items\":{\"label\":\"Sentinel-2 STAC items\",\"doc\":\"list of Sentinel-2 COG STAC items\",\"type\":\"string[]\"},\"bands\":{\"label\":\"bands used for the NDWI\",\"doc\":\"bands used for the NDWI\",\"type\":\"string[]\",\"default\":[\"green\",\"nir\"]}},\"outputs\":[{\"id\":\"stac_catalog\",\"outputSource\":[\"node_stac/stac_catalog\"],\"type\":\"Directory\"}],\"steps\":{\"node_water_bodies\":{\"run\":\"#detect_water_body\",\"in\":{\"item\":\"stac_items\",\"aoi\":\"aoi\",\"epsg\":\"epsg\",\"bands\":\"bands\"},\"out\":[\"detected_water_body\"],\"scatter\":\"item\",\"scatterMethod\":\"dotproduct\"},\"node_stac\":{\"run\":\"#stac\",\"in\":{\"item\":\"stac_items\",\"rasters\":{\"source\":\"node_water_bodies/detected_water_body\"}},\"out\":[\"stac_catalog\"]}}},{\"class\":\"Workflow\",\"id\":\"detect_water_body\",\"label\":\"Water body detection based on NDWI and otsu threshold\",\"doc\":\"Water body detection based on NDWI and otsu threshold\",\"requirements\":[{\"class\":\"ScatterFeatureRequirement\"}],\"inputs\":{\"aoi\":{\"doc\":\"area of interest as a bounding box\",\"type\":\"string\"},\"epsg\":{\"doc\":\"EPSG code\",\"type\":\"string\",\"default\":\"EPSG:4326\"},\"bands\":{\"doc\":\"bands used for the NDWI\",\"type\":\"string[]\"},\"item\":{\"doc\":\"STAC item\",\"type\":\"string\"}},\"outputs\":[{\"id\":\"detected_water_body\",\"outputSource\":[\"node_otsu/binary_mask_item\"],\"type\":\"File\"}],\"steps\":{\"node_crop\":{\"run\":\"#crop\",\"in\":{\"item\":\"item\",\"aoi\":\"aoi\",\"epsg\":\"epsg\",\"band\":\"bands\"},\"out\":[\"cropped\"],\"scatter\":\"band\",\"scatterMethod\":\"dotproduct\"},\"node_normalized_difference\":{\"run\":\"#norm_diff\",\"in\":{\"rasters\":{\"source\":\"node_crop/cropped\"}},\"out\":[\"ndwi\"]},\"node_otsu\":{\"run\":\"#otsu\",\"in\":{\"raster\":{\"source\":\"node_normalized_difference/ndwi\"}},\"out\":[\"binary_mask_item\"]}}},{\"class\":\"CommandLineTool\",\"id\":\"crop\",\"requirements\":{\"InlineJavascriptRequirement\":{},\"EnvVarRequirement\":{\"envDef\":{\"PATH\":\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\",\"PYTHONPATH\":\"/app\"}},\"ResourceRequirement\":{\"coresMax\":1,\"ramMax\":512}},\"hints\":{\"DockerRequirement\":{\"dockerPull\":\"ghcr.io/eoap/mastering-app-package/crop@sha256:61c2f37b3a1bd56a3eddd0f4224c72de665d42957d3325dd0397845cff198dab\"}},\"baseCommand\":[\"python\",\"-m\",\"app\"],\"arguments\":[],\"inputs\":{\"item\":{\"type\":\"string\",\"inputBinding\":{\"prefix\":\"--input-item\"}},\"aoi\":{\"type\":\"string\",\"inputBinding\":{\"prefix\":\"--aoi\"}},\"epsg\":{\"type\":\"string\",\"inputBinding\":{\"prefix\":\"--epsg\"}},\"band\":{\"type\":\"string\",\"inputBinding\":{\"prefix\":\"--band\"}}},\"outputs\":{\"cropped\":{\"outputBinding\":{\"glob\":\"*.tif\"},\"type\":\"File\"}}},{\"class\":\"CommandLineTool\",\"id\":\"norm_diff\",\"requirements\":{\"InlineJavascriptRequirement\":{},\"EnvVarRequirement\":{\"envDef\":{\"PATH\":\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\",\"PYTHONPATH\":\"/app\"}},\"ResourceRequirement\":{\"coresMax\":1,\"ramMax\":512}},\"hints\":{\"DockerRequirement\":{\"dockerPull\":\"ghcr.io/eoap/mastering-app-package/norm_diff@sha256:641ab55968d7f500b641969d0a7422c4c9a80dd5cc1459ee07f3e0c5ee4fa230\"}},\"baseCommand\":[\"python\",\"-m\",\"app\"],\"arguments\":[],\"inputs\":{\"rasters\":{\"type\":\"File[]\",\"inputBinding\":{\"position\":1}}},\"outputs\":{\"ndwi\":{\"outputBinding\":{\"glob\":\"*.tif\"},\"type\":\"File\"}}},{\"class\":\"CommandLineTool\",\"id\":\"otsu\",\"requirements\":{\"InlineJavascriptRequirement\":{},\"EnvVarRequirement\":{\"envDef\":{\"PATH\":\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\",\"PYTHONPATH\":\"/app\"}},\"ResourceRequirement\":{\"coresMax\":1,\"ramMax\":512}},\"hints\":{\"DockerRequirement\":{\"dockerPull\":\"ghcr.io/eoap/mastering-app-package/otsu@sha256:ec02baf6a007ebb5a2dc037af2da8ef94db67bb8a6139682ad61041f9d27c779\"}},\"baseCommand\":[\"python\",\"-m\",\"app\"],\"arguments\":[],\"inputs\":{\"raster\":{\"type\":\"File\",\"inputBinding\":{\"position\":1}}},\"outputs\":{\"binary_mask_item\":{\"outputBinding\":{\"glob\":\"*.tif\"},\"type\":\"File\"}}},{\"class\":\"CommandLineTool\",\"id\":\"stac\",\"requirements\":{\"InlineJavascriptRequirement\":{},\"EnvVarRequirement\":{\"envDef\":{\"PATH\":\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\",\"PYTHONPATH\":\"/app\"}},\"ResourceRequirement\":{\"coresMax\":1,\"ramMax\":512}},\"hints\":{\"DockerRequirement\":{\"dockerPull\":\"ghcr.io/eoap/mastering-app-package/stac@sha256:8ad7e7d6999c0c4c91c2b19ce231f24734d2af8f41b855ef9a06276d23345601\"}},\"baseCommand\":[\"python\",\"-m\",\"app\"],\"arguments\":[],\"inputs\":{\"item\":{\"type\":{\"type\":\"array\",\"items\":\"string\",\"inputBinding\":{\"prefix\":\"--input-item\"}}},\"rasters\":{\"type\":{\"type\":\"array\",\"items\":\"File\",\"inputBinding\":{\"prefix\":\"--water-body\"}}}},\"outputs\":{\"stac_catalog\":{\"outputBinding\":{\"glob\":\".\"},\"type\":\"Directory\"}}}],\"s:codeRepository\":{\"URL\":\"https://github.com/eoap/mastering-app-package.git\"},\"s:author\":[{\"class\":\"s:Person\",\"s.name\":\"Jane Doe\",\"s.email\":\"jane.doe@acme.earth\",\"s.affiliation\":\"ACME\"}]}"}]},"outputs":{"artifacts":[{"name":"main-logs","s3":{"key":"argo-cwl-runner-wvqmw/argo-cwl-runner-wvqmw-cwl-prepare-1289416099/main.log"}}],"exitCode":"0"},"children":["argo-cwl-runner-wvqmw-2367106816"],"hostNodeName":"minikube"},"argo-cwl-runner-wvqmw-1616805333":{"id":"argo-cwl-runner-wvqmw-1616805333","name":"argo-cwl-runner-wvqmw[1].cwl-runner","displayName":"cwl-runner","type":"Pod","templateName":"calrissian-tmpl","templateScope":"local/","phase":"Succeeded","boundaryID":"argo-cwl-runner-wvqmw","startedAt":"2024-07-19T10:39:56Z","finishedAt":"2024-07-19T10:40:49Z","estimatedDuration":62,"progress":"1/1","resourcesDuration":{"cpu":5,"memory":51},"outputs":{"exitCode":"0"},"children":["argo-cwl-runner-wvqmw-3440433147"],"hostNodeName":"minikube"},"argo-cwl-runner-wvqmw-2367106816":{"id":"argo-cwl-runner-wvqmw-2367106816","name":"argo-cwl-runner-wvqmw[1]","displayName":"[1]","type":"StepGroup","templateScope":"local/","phase":"Succeeded","boundaryID":"argo-cwl-runner-wvqmw","startedAt":"2024-07-19T10:39:56Z","finishedAt":"2024-07-19T10:40:58Z","estimatedDuration":71,"progress":"3/3","resourcesDuration":{"cpu":7,"memory":75},"nodeFlag":{},"children":["argo-cwl-runner-wvqmw-1616805333"]},"argo-cwl-runner-wvqmw-240761544":{"id":"argo-cwl-runner-wvqmw-240761544","name":"argo-cwl-runner-wvqmw[0].param-prepare","displayName":"param-prepare","type":"Pod","templateName":"param-prepare","templateScope":"local/","phase":"Succeeded","boundaryID":"argo-cwl-runner-wvqmw","startedAt":"2024-07-19T10:39:46Z","finishedAt":"2024-07-19T10:39:50Z","estimatedDuration":3,"progress":"1/1","resourcesDuration":{"cpu":1,"memory":12},"inputs":{"parameters":[{"name":"parameters","value":"{\"stac_items\":[\"https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\"],\"aoi\":\"-121.399,39.834,-120.74,40.472\",\"epsg\":\"EPSG:4326\"}"}]},"outputs":{"artifacts":[{"name":"main-logs","s3":{"key":"argo-cwl-runner-wvqmw/argo-cwl-runner-wvqmw-param-prepare-240761544/main.log"}}],"exitCode":"0"},"children":["argo-cwl-runner-wvqmw-2367106816"],"hostNodeName":"minikube"},"argo-cwl-runner-wvqmw-2434070197":{"id":"argo-cwl-runner-wvqmw-2434070197","name":"argo-cwl-runner-wvqmw[0]","displayName":"[0]","type":"StepGroup","templateScope":"local/","phase":"Succeeded","boundaryID":"argo-cwl-runner-wvqmw","startedAt":"2024-07-19T10:39:46Z","finishedAt":"2024-07-19T10:39:56Z","estimatedDuration":10,"progress":"5/5","resourcesDuration":{"cpu":9,"memory":100},"nodeFlag":{},"children":["argo-cwl-runner-wvqmw-1289416099","argo-cwl-runner-wvqmw-240761544"]},"argo-cwl-runner-wvqmw-2838679990":{"id":"argo-cwl-runner-wvqmw-2838679990","name":"argo-cwl-runner-wvqmw[2].stage-out","displayName":"stage-out","type":"Pod","templateName":"stage-out","templateScope":"local/","phase":"Succeeded","boundaryID":"argo-cwl-runner-wvqmw","startedAt":"2024-07-19T10:40:58Z","finishedAt":"2024-07-19T10:41:02Z","estimatedDuration":4,"progress":"1/1","resourcesDuration":{"cpu":1,"memory":12},"inputs":{"parameters":[{"name":"file_path","value":"/calrissian/output.json"},{"name":"bucket","value":"results"},{"name":"folder","value":"argo-cwl-runner-wvqmw"}]},"outputs":{"parameters":[{"name":"stac-catalog","value":"s3://results/argo-cwl-runner-wvqmw/catalog.json","valueFrom":{"path":"/tmp/output"}}],"artifacts":[{"name":"main-logs","s3":{"key":"argo-cwl-runner-wvqmw/argo-cwl-runner-wvqmw-stage-out-2838679990/main.log"}}],"exitCode":"0"},"hostNodeName":"minikube"},"argo-cwl-runner-wvqmw-3279323762":{"id":"argo-cwl-runner-wvqmw-3279323762","name":"argo-cwl-runner-wvqmw[2].get-results","displayName":"get-results","type":"Pod","templateName":"get-results","templateScope":"local/","phase":"Succeeded","boundaryID":"argo-cwl-runner-wvqmw","startedAt":"2024-07-19T10:40:58Z","finishedAt":"2024-07-19T10:41:02Z","estimatedDuration":4,"progress":"1/1","resourcesDuration":{"cpu":1,"memory":12},"inputs":{"parameters":[{"name":"calrissian-output","value":"/calrissian/output.json"},{"name":"calrissian-stderr","value":"/calrissian/stderr.log"},{"name":"calrissian-report","value":"/calrissian/report.json"}]},"outputs":{"parameters":[{"name":"calrissian-output","value":"{\n    \"stac_catalog\": {\n        \"location\": \"file:///calrissian/results/73k_b1lo\",\n        \"basename\": \"73k_b1lo\",\n        \"class\": \"Directory\",\n        \"listing\": [\n            {\n                \"class\": \"File\",\n                \"location\": \"file:///calrissian/results/73k_b1lo/catalog.json\",\n                \"basename\": \"catalog.json\",\n                \"checksum\": \"sha1$f1994683c2e2b8d21aab7f0c0c05b76b850ac21e\",\n                \"size\": 359,\n                \"path\": \"/calrissian/results/73k_b1lo/catalog.json\"\n            },\n            {\n                \"class\": \"Directory\",\n                \"location\": \"file:///calrissian/results/73k_b1lo/S2A_10TFK_20210708_0_L2A\",\n                \"basename\": \"S2A_10TFK_20210708_0_L2A\",\n                \"listing\": [\n                    {\n                        \"class\": \"File\",\n                        \"location\": \"file:///calrissian/results/73k_b1lo/S2A_10TFK_20210708_0_L2A/S2A_10TFK_20210708_0_L2A.json\",\n                        \"basename\": \"S2A_10TFK_20210708_0_L2A.json\",\n                        \"checksum\": \"sha1$800a04fa6e4644dd1306d9335c237b020cd4bf5a\",\n                        \"size\": 4882,\n                        \"path\": \"/calrissian/results/73k_b1lo/S2A_10TFK_20210708_0_L2A/S2A_10TFK_20210708_0_L2A.json\"\n                    },\n                    {\n                        \"class\": \"File\",\n                        \"location\": \"file:///calrissian/results/73k_b1lo/S2A_10TFK_20210708_0_L2A/otsu.tif\",\n                        \"basename\": \"otsu.tif\",\n                        \"checksum\": \"sha1$210598cf619d49eabfdc24414bd445f59668f3bd\",\n                        \"size\": 289288,\n                        \"path\": \"/calrissian/results/73k_b1lo/S2A_10TFK_20210708_0_L2A/otsu.tif\"\n                    }\n                ],\n                \"path\": \"/calrissian/results/73k_b1lo/S2A_10TFK_20210708_0_L2A\"\n            }\n        ],\n        \"path\": \"/calrissian/results/73k_b1lo\"\n    }\n}","valueFrom":{"path":"/tmp/calrissian-output.json"}},{"name":"calrissian-stderr","value":"\u001b[1;30mINFO\u001b[0m calrissian 0.16.0 (cwltool 3.1.20231114134824)\n\u001b[1;30mINFO\u001b[0m Resolved '/calrissian/cwl.json' to 'file:///calrissian/cwl.json'\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mStarting ThreadPoolJobExecutor.run_jobs: total_resources=[ram: 16000.0, cores: 8.0, gpus 0], max_workers=None\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow ] initialized from file:///calrissian/cwl.json#main\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mwait_for_completion with 0 futures\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow ] inputs {\n    \"stac_items\": [\n        \"https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\"\n    ],\n    \"aoi\": \"-121.399,39.834,-120.74,40.472\",\n    \"epsg\": \"EPSG:4326\",\n    \"bands\": [\n        \"green\",\n        \"nir\"\n    ]\n}\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow ] job step file:///calrissian/cwl.json#main/node_stac not ready\u001b[0m\n\u001b[1;30mINFO\u001b[0m [workflow ] starting step node_water_bodies\n\u001b[1;30mINFO\u001b[0m [step node_water_bodies] start\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] initialized from file:///calrissian/cwl.json#detect_water_body\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mwait_for_completion with 0 futures\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] inputs {\n    \"aoi\": \"-121.399,39.834,-120.74,40.472\",\n    \"bands\": [\n        \"green\",\n        \"nir\"\n    ],\n    \"epsg\": \"EPSG:4326\",\n    \"item\": \"https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\"\n}\u001b[0m\n\u001b[1;30mINFO\u001b[0m [workflow node_water_bodies] starting step node_crop\n\u001b[1;30mINFO\u001b[0m [step node_crop] start\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_crop] initializing from file:///calrissian/cwl.json#crop as part of step node_crop\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_crop] {\n    \"aoi\": \"-121.399,39.834,-120.74,40.472\",\n    \"band\": \"green\",\n    \"epsg\": \"EPSG:4326\",\n    \"item\": \"https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\"\n}\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_crop] path mappings is {}\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_crop] command line bindings is [\n    {\n        \"position\": [\n            -1000000,\n            0\n        ],\n        \"datum\": \"python\"\n    },\n    {\n        \"position\": [\n            -1000000,\n            1\n        ],\n        \"datum\": \"-m\"\n    },\n    {\n        \"position\": [\n            -1000000,\n            2\n        ],\n        \"datum\": \"app\"\n    },\n    {\n        \"prefix\": \"--aoi\",\n        \"position\": [\n            0,\n            \"aoi\"\n        ],\n        \"datum\": \"-121.399,39.834,-120.74,40.472\"\n    },\n    {\n        \"prefix\": \"--band\",\n        \"position\": [\n            0,\n            \"band\"\n        ],\n        \"datum\": \"green\"\n    },\n    {\n        \"prefix\": \"--epsg\",\n        \"position\": [\n            0,\n            \"epsg\"\n        ],\n        \"datum\": \"EPSG:4326\"\n    },\n    {\n        \"prefix\": \"--input-item\",\n        \"position\": [\n            0,\n            \"item\"\n        ],\n        \"datum\": \"https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\"\n    }\n]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mwait_for_completion with 0 futures\u001b[0m\n\u001b[1;30mINFO\u001b[0m [step node_crop] start\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_crop_2] initializing from file:///calrissian/cwl.json#crop as part of step node_crop\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_crop_2] {\n    \"aoi\": \"-121.399,39.834,-120.74,40.472\",\n    \"band\": \"nir\",\n    \"epsg\": \"EPSG:4326\",\n    \"item\": \"https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\"\n}\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_crop_2] path mappings is {}\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_crop_2] command line bindings is [\n    {\n        \"position\": [\n            -1000000,\n            0\n        ],\n        \"datum\": \"python\"\n    },\n    {\n        \"position\": [\n            -1000000,\n            1\n        ],\n        \"datum\": \"-m\"\n    },\n    {\n        \"position\": [\n            -1000000,\n            2\n        ],\n        \"datum\": \"app\"\n    },\n    {\n        \"prefix\": \"--aoi\",\n        \"position\": [\n            0,\n            \"aoi\"\n        ],\n        \"datum\": \"-121.399,39.834,-120.74,40.472\"\n    },\n    {\n        \"prefix\": \"--band\",\n        \"position\": [\n            0,\n            \"band\"\n        ],\n        \"datum\": \"nir\"\n    },\n    {\n        \"prefix\": \"--epsg\",\n        \"position\": [\n            0,\n            \"epsg\"\n        ],\n        \"datum\": \"EPSG:4326\"\n    },\n    {\n        \"prefix\": \"--input-item\",\n        \"position\": [\n            0,\n            \"item\"\n        ],\n        \"datum\": \"https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\"\n    }\n]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mwait_for_completion with 0 futures\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] job step file:///calrissian/cwl.json#detect_water_body/node_normalized_difference not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] job step file:///calrissian/cwl.json#detect_water_body/node_otsu not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] job step file:///calrissian/cwl.json#detect_water_body/node_normalized_difference not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] job step file:///calrissian/cwl.json#detect_water_body/node_otsu not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] job step file:///calrissian/cwl.json#detect_water_body/node_normalized_difference not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] job step file:///calrissian/cwl.json#detect_water_body/node_otsu not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow ] job step file:///calrissian/cwl.json#main/node_stac not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] job step file:///calrissian/cwl.json#detect_water_body/node_normalized_difference not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] job step file:///calrissian/cwl.json#detect_water_body/node_otsu not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mallocate [ram: 0, cores: 0, gpus 0] from available [ram: 16000.0, cores: 8.0, gpus 0]\u001b[0m\n\u001b[1;30mINFO\u001b[0m [workflow ] start\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mrestore [ram: 0, cores: 0, gpus 0] to available [ram: 16000.0, cores: 8.0, gpus 0]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mallocate [ram: 0, cores: 0, gpus 0] from available [ram: 16000.0, cores: 8.0, gpus 0]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mallocate [ram: 512, cores: 1, gpus 0] from available [ram: 16000.0, cores: 8.0, gpus 0]\u001b[0m\n\u001b[1;30mINFO\u001b[0m [workflow node_water_bodies] start\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mrestore [ram: 0, cores: 0, gpus 0] to available [ram: 15488.0, cores: 7.0, gpus 0]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mallocate [ram: 512, cores: 1, gpus 0] from available [ram: 15488.0, cores: 7.0, gpus 0]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mwait_for_completion with 4 futures\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow ] job step file:///calrissian/cwl.json#main/node_stac not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] job step file:///calrissian/cwl.json#detect_water_body/node_normalized_difference not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] job step file:///calrissian/cwl.json#detect_water_body/node_otsu not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mwait_for_completion with 2 futures\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_crop] initial work dir {}\u001b[0m\nBuilding resources spec from {'cores': 1, 'ram': 512, 'gpus': 0}\n--------------------------------------------------------------------------------\napiVersion: v1\nkind: Pod\nmetadata:\n  labels: {}\n  name: node-crop-pod-snpnnthg\nspec:\n  containers:\n  - args:\n    - python -m app --aoi -121.399,39.834,-120.74,40.472 --band green --epsg EPSG:4326\n      --input-item https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\n    command:\n    - /bin/sh\n    - -c\n    env:\n    - name: HOME\n      value: /nGuThn\n    - name: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - PATH\n      value: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n    - name: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - PYTHONPATH\n      value: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - /app\n    - name: TMPDIR\n      value: /tmp\n    image: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n    - ghcr.io/eoap/mastering-app-package/crop@sha256:61c2f37b3a1bd56a3eddd0f4224c72de665d42957d3325dd0397845cff198dab\n    name: node-crop-container\n    resources:\n      requests:\n        cpu: '1'\n        memory: 512Mi\n    volumeMounts:\n    - mountPath: /nGuThn\n      name: argo-cwl-runner-wvqmw-calrissian-wdir\n      readOnly: false\n      subPath: tmp/ah_lxh40\n    - mountPath: /tmp\n      name: tmpdir\n    workingDir: /nGuThn\n  initContainers: []\n  nodeSelector: {}\n  restartPolicy: Never\n  securityContext:\n    runAsGroup: 0\n    runAsUser: 0\n  serviceAccountName: argo\n  volumes:\n  - name: argo-cwl-runner-wvqmw-calrissian-wdir\n    persistentVolumeClaim:\n      claimName: argo-cwl-runner-wvqmw-calrissian-wdir\n      readOnly: false\n  - emptyDir: {}\n    name: tmpdir\n--------------------------------------------------------------------------------\n\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_crop_2] initial work dir {}\u001b[0m\nBuilding resources spec from {'cores': 1, 'ram': 512, 'gpus': 0}\n--------------------------------------------------------------------------------\napiVersion: v1\nkind: Pod\nmetadata:\n  labels: {}\n  name: node-crop-2-pod-aiubutgn\nspec:\n  containers:\n  - args:\n    - python -m app --aoi -121.399,39.834,-120.74,40.472 --band nir --epsg EPSG:4326\n      --input-item https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\n    command:\n    - /bin/sh\n    - -c\n    env:\n    - name: HOME\n      value: /nGuThn\n    - name: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - PATH\n      value: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n    - name: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - PYTHONPATH\n      value: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - /app\n    - name: TMPDIR\n      value: /tmp\n    image: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n    - ghcr.io/eoap/mastering-app-package/crop@sha256:61c2f37b3a1bd56a3eddd0f4224c72de665d42957d3325dd0397845cff198dab\n    name: node-crop-2-container\n    resources:\n      requests:\n        cpu: '1'\n        memory: 512Mi\n    volumeMounts:\n    - mountPath: /nGuThn\n      name: argo-cwl-runner-wvqmw-calrissian-wdir\n      readOnly: false\n      subPath: tmp/n_drxp_d\n    - mountPath: /tmp\n      name: tmpdir\n    workingDir: /nGuThn\n  initContainers: []\n  nodeSelector: {}\n  restartPolicy: Never\n  securityContext:\n    runAsGroup: 0\n    runAsUser: 0\n  serviceAccountName: argo\n  volumes:\n  - name: argo-cwl-runner-wvqmw-calrissian-wdir\n    persistentVolumeClaim:\n      claimName: argo-cwl-runner-wvqmw-calrissian-wdir\n      readOnly: false\n  - emptyDir: {}\n    name: tmpdir\n--------------------------------------------------------------------------------\n\nCreated k8s pod name node-crop-pod-snpnnthg with id 40f66c52-56ff-4fc9-826f-c014c2513b66\nPodMonitor adding node-crop-pod-snpnnthg\nk8s pod 'node-crop-pod-snpnnthg' started\npod name node-crop-pod-snpnnthg with id 40f66c52-56ff-4fc9-826f-c014c2513b66 has status None\nCreated k8s pod name node-crop-2-pod-aiubutgn with id 45ef4566-a4e3-41e3-9ffb-4a9464e29b78\nPodMonitor adding node-crop-2-pod-aiubutgn\nk8s pod 'node-crop-2-pod-aiubutgn' started\npod name node-crop-2-pod-aiubutgn with id 45ef4566-a4e3-41e3-9ffb-4a9464e29b78 has status None\npod name node-crop-pod-snpnnthg with id 40f66c52-56ff-4fc9-826f-c014c2513b66 has status {'allocated_resources': None,\n 'container_id': None,\n 'image': 'ghcr.io/eoap/mastering-app-package/crop@sha256:61c2f37b3a1bd56a3eddd0f4224c72de665d42957d3325dd0397845cff198dab',\n 'image_id': '',\n 'last_state': {'running': None, 'terminated': None, 'waiting': None},\n 'name': 'node-crop-container',\n 'ready': False,\n 'resources': None,\n 'restart_count': 0,\n 'started': False,\n 'state': {'running': None,\n           'terminated': None,\n           'waiting': {'message': None, 'reason': 'ContainerCreating'}}}\npod name node-crop-2-pod-aiubutgn with id 45ef4566-a4e3-41e3-9ffb-4a9464e29b78 has status {'allocated_resources': None,\n 'container_id': None,\n 'image': 'ghcr.io/eoap/mastering-app-package/crop@sha256:61c2f37b3a1bd56a3eddd0f4224c72de665d42957d3325dd0397845cff198dab',\n 'image_id': '',\n 'last_state': {'running': None, 'terminated': None, 'waiting': None},\n 'name': 'node-crop-2-container',\n 'ready': False,\n 'resources': None,\n 'restart_count': 0,\n 'started': False,\n 'state': {'running': None,\n           'terminated': None,\n           'waiting': {'message': None, 'reason': 'ContainerCreating'}}}\npod name node-crop-2-pod-aiubutgn with id 45ef4566-a4e3-41e3-9ffb-4a9464e29b78 has status {'allocated_resources': None,\n 'container_id': 'docker://d5f748fe20c4b5055139753b16c5c92304dd20ce0e2262a842c98874fec87c1a',\n 'image': 'sha256:337e3e9d05c61bc8df71b9ebf48749d495f8f521e3237fe13b75ba0d1a1038eb',\n 'image_id': 'docker-pullable://ghcr.io/eoap/mastering-app-package/crop@sha256:61c2f37b3a1bd56a3eddd0f4224c72de665d42957d3325dd0397845cff198dab',\n 'last_state': {'running': None, 'terminated': None, 'waiting': None},\n 'name': 'node-crop-2-container',\n 'ready': True,\n 'resources': None,\n 'restart_count': 0,\n 'started': True,\n 'state': {'running': {'started_at': datetime.datetime(2024, 7, 19, 10, 40, 2, tzinfo=tzlocal())},\n           'terminated': None,\n           'waiting': None}}\n[node-crop-2-pod-aiubutgn] follow_logs start\npod name node-crop-pod-snpnnthg with id 40f66c52-56ff-4fc9-826f-c014c2513b66 has status {'allocated_resources': None,\n 'container_id': 'docker://0a8362d8530225be6d1e94bb904b2ae48fbe23ba753b0ecdcdc185bea7c406c1',\n 'image': 'sha256:337e3e9d05c61bc8df71b9ebf48749d495f8f521e3237fe13b75ba0d1a1038eb',\n 'image_id': 'docker-pullable://ghcr.io/eoap/mastering-app-package/crop@sha256:61c2f37b3a1bd56a3eddd0f4224c72de665d42957d3325dd0397845cff198dab',\n 'last_state': {'running': None, 'terminated': None, 'waiting': None},\n 'name': 'node-crop-container',\n 'ready': True,\n 'resources': None,\n 'restart_count': 0,\n 'started': True,\n 'state': {'running': {'started_at': datetime.datetime(2024, 7, 19, 10, 40, 2, tzinfo=tzlocal())},\n           'terminated': None,\n           'waiting': None}}\n[node-crop-pod-snpnnthg] follow_logs start\n[node-crop-2-pod-aiubutgn] 2024-07-19 10:40:03.609 | INFO     | __main__:crop:69 - Read S2A_10TFK_20210708_0_L2A from https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\n[node-crop-2-pod-aiubutgn] 2024-07-19 10:40:03.635 | INFO     | __main__:crop:72 - Read asset nir from https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/10/T/FK/2021/7/S2A_10TFK_20210708_0_L2A/B08.tif\n[node-crop-pod-snpnnthg] 2024-07-19 10:40:03.892 | INFO     | __main__:crop:69 - Read S2A_10TFK_20210708_0_L2A from https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\n[node-crop-pod-snpnnthg] 2024-07-19 10:40:03.911 | INFO     | __main__:crop:72 - Read asset green from https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/10/T/FK/2021/7/S2A_10TFK_20210708_0_L2A/B03.tif\n[node-crop-2-pod-aiubutgn] 2024-07-19 10:40:05.849 | INFO     | __main__:crop:90 - Crop https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/10/T/FK/2021/7/S2A_10TFK_20210708_0_L2A/B08.tif\n[node-crop-pod-snpnnthg] 2024-07-19 10:40:06.063 | INFO     | __main__:crop:90 - Crop https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/10/T/FK/2021/7/S2A_10TFK_20210708_0_L2A/B03.tif\n[node-crop-pod-snpnnthg] 2024-07-19 10:40:23.262 | INFO     | __main__:crop:112 - Write crop_green.tif\n[node-crop-2-pod-aiubutgn] 2024-07-19 10:40:26.964 | INFO     | __main__:crop:112 - Write crop_nir.tif\n[node-crop-pod-snpnnthg] 2024-07-19 10:40:26.995 | INFO     | __main__:crop:115 - Done!\n[node-crop-pod-snpnnthg] follow_logs end\npod name node-crop-pod-snpnnthg with id 40f66c52-56ff-4fc9-826f-c014c2513b66 has status {'allocated_resources': None,\n 'container_id': 'docker://0a8362d8530225be6d1e94bb904b2ae48fbe23ba753b0ecdcdc185bea7c406c1',\n 'image': 'sha256:337e3e9d05c61bc8df71b9ebf48749d495f8f521e3237fe13b75ba0d1a1038eb',\n 'image_id': 'docker-pullable://ghcr.io/eoap/mastering-app-package/crop@sha256:61c2f37b3a1bd56a3eddd0f4224c72de665d42957d3325dd0397845cff198dab',\n 'last_state': {'running': None, 'terminated': None, 'waiting': None},\n 'name': 'node-crop-container',\n 'ready': False,\n 'resources': None,\n 'restart_count': 0,\n 'started': False,\n 'state': {'running': None,\n           'terminated': {'container_id': 'docker://0a8362d8530225be6d1e94bb904b2ae48fbe23ba753b0ecdcdc185bea7c406c1',\n                          'exit_code': 0,\n                          'finished_at': datetime.datetime(2024, 7, 19, 10, 40, 27, tzinfo=tzlocal()),\n                          'message': None,\n                          'reason': 'Completed',\n                          'signal': None,\n                          'started_at': datetime.datetime(2024, 7, 19, 10, 40, 2, tzinfo=tzlocal())},\n           'waiting': None}}\nHandling terminated pod name node-crop-pod-snpnnthg with id 40f66c52-56ff-4fc9-826f-c014c2513b66\nhandling completion with 0\nPodMonitor removing node-crop-pod-snpnnthg\nos.makedirs(/calrissian/logs)\nWriting pod node_crop logs to /calrissian/logs/node_crop.log\nshutil.rmtree(/tmp/hklxhzf8, True)\nshutil.rmtree(/tmp/ozpd15gi, True)\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mrestore [ram: 512, cores: 1, gpus 0] to available [ram: 14976.0, cores: 6.0, gpus 0]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow ] job step file:///calrissian/cwl.json#main/node_stac not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] job step file:///calrissian/cwl.json#detect_water_body/node_normalized_difference not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] job step file:///calrissian/cwl.json#detect_water_body/node_otsu not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mwait_for_completion with 1 futures\u001b[0m\n[node-crop-2-pod-aiubutgn] 2024-07-19 10:40:30.275 | INFO     | __main__:crop:115 - Done!\n[node-crop-2-pod-aiubutgn] follow_logs end\npod name node-crop-2-pod-aiubutgn with id 45ef4566-a4e3-41e3-9ffb-4a9464e29b78 has status {'allocated_resources': None,\n 'container_id': 'docker://d5f748fe20c4b5055139753b16c5c92304dd20ce0e2262a842c98874fec87c1a',\n 'image': 'sha256:337e3e9d05c61bc8df71b9ebf48749d495f8f521e3237fe13b75ba0d1a1038eb',\n 'image_id': 'docker-pullable://ghcr.io/eoap/mastering-app-package/crop@sha256:61c2f37b3a1bd56a3eddd0f4224c72de665d42957d3325dd0397845cff198dab',\n 'last_state': {'running': None, 'terminated': None, 'waiting': None},\n 'name': 'node-crop-2-container',\n 'ready': False,\n 'resources': None,\n 'restart_count': 0,\n 'started': False,\n 'state': {'running': None,\n           'terminated': {'container_id': 'docker://d5f748fe20c4b5055139753b16c5c92304dd20ce0e2262a842c98874fec87c1a',\n                          'exit_code': 0,\n                          'finished_at': datetime.datetime(2024, 7, 19, 10, 40, 30, tzinfo=tzlocal()),\n                          'message': None,\n                          'reason': 'Completed',\n                          'signal': None,\n                          'started_at': datetime.datetime(2024, 7, 19, 10, 40, 2, tzinfo=tzlocal())},\n           'waiting': None}}\nHandling terminated pod name node-crop-2-pod-aiubutgn with id 45ef4566-a4e3-41e3-9ffb-4a9464e29b78\nhandling completion with 0\nPodMonitor removing node-crop-2-pod-aiubutgn\nWriting pod node_crop_2 logs to /calrissian/logs/node_crop_2.log\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[step node_crop] produced output {\n    \"file:///calrissian/cwl.json#detect_water_body/node_crop/cropped\": [\n        {\n            \"location\": \"file:///calrissian/tmp/ah_lxh40/crop_green.tif\",\n            \"basename\": \"crop_green.tif\",\n            \"nameroot\": \"crop_green\",\n            \"nameext\": \".tif\",\n            \"class\": \"File\",\n            \"checksum\": \"sha1$9956fe066bc4fd47770d36b508ada24db67639e4\",\n            \"size\": 87602514,\n            \"http://commonwl.org/cwltool#generation\": 0\n        },\n        {\n            \"location\": \"file:///calrissian/tmp/n_drxp_d/crop_nir.tif\",\n            \"basename\": \"crop_nir.tif\",\n            \"nameroot\": \"crop_nir\",\n            \"nameext\": \".tif\",\n            \"class\": \"File\",\n            \"checksum\": \"sha1$295ef64b75391884bf432db41ba6e677d87ddaab\",\n            \"size\": 100761236,\n            \"http://commonwl.org/cwltool#generation\": 0\n        }\n    ]\n}\u001b[0m\n\u001b[1;30mINFO\u001b[0m [step node_crop] completed success\nshutil.rmtree(/tmp/uze6mavv, True)\nshutil.rmtree(/tmp/zxmort7y, True)\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mrestore [ram: 512, cores: 1, gpus 0] to available [ram: 15488.0, cores: 7.0, gpus 0]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow ] job step file:///calrissian/cwl.json#main/node_stac not ready\u001b[0m\n\u001b[1;30mINFO\u001b[0m [workflow node_water_bodies] starting step node_normalized_difference\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[step node_normalized_difference] job input {\n    \"file:///calrissian/cwl.json#detect_water_body/node_normalized_difference/rasters\": [\n        {\n            \"location\": \"file:///calrissian/tmp/ah_lxh40/crop_green.tif\",\n            \"basename\": \"crop_green.tif\",\n            \"nameroot\": \"crop_green\",\n            \"nameext\": \".tif\",\n            \"class\": \"File\",\n            \"checksum\": \"sha1$9956fe066bc4fd47770d36b508ada24db67639e4\",\n            \"size\": 87602514,\n            \"http://commonwl.org/cwltool#generation\": 0\n        },\n        {\n            \"location\": \"file:///calrissian/tmp/n_drxp_d/crop_nir.tif\",\n            \"basename\": \"crop_nir.tif\",\n            \"nameroot\": \"crop_nir\",\n            \"nameext\": \".tif\",\n            \"class\": \"File\",\n            \"checksum\": \"sha1$295ef64b75391884bf432db41ba6e677d87ddaab\",\n            \"size\": 100761236,\n            \"http://commonwl.org/cwltool#generation\": 0\n        }\n    ]\n}\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[step node_normalized_difference] evaluated job input to {\n    \"file:///calrissian/cwl.json#detect_water_body/node_normalized_difference/rasters\": [\n        {\n            \"location\": \"file:///calrissian/tmp/ah_lxh40/crop_green.tif\",\n            \"basename\": \"crop_green.tif\",\n            \"nameroot\": \"crop_green\",\n            \"nameext\": \".tif\",\n            \"class\": \"File\",\n            \"checksum\": \"sha1$9956fe066bc4fd47770d36b508ada24db67639e4\",\n            \"size\": 87602514,\n            \"http://commonwl.org/cwltool#generation\": 0\n        },\n        {\n            \"location\": \"file:///calrissian/tmp/n_drxp_d/crop_nir.tif\",\n            \"basename\": \"crop_nir.tif\",\n            \"nameroot\": \"crop_nir\",\n            \"nameext\": \".tif\",\n            \"class\": \"File\",\n            \"checksum\": \"sha1$295ef64b75391884bf432db41ba6e677d87ddaab\",\n            \"size\": 100761236,\n            \"http://commonwl.org/cwltool#generation\": 0\n        }\n    ]\n}\u001b[0m\n\u001b[1;30mINFO\u001b[0m [step node_normalized_difference] start\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_normalized_difference] initializing from file:///calrissian/cwl.json#norm_diff as part of step node_normalized_difference\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_normalized_difference] {\n    \"rasters\": [\n        {\n            \"location\": \"file:///calrissian/tmp/ah_lxh40/crop_green.tif\",\n            \"basename\": \"crop_green.tif\",\n            \"nameroot\": \"crop_green\",\n            \"nameext\": \".tif\",\n            \"class\": \"File\",\n            \"checksum\": \"sha1$9956fe066bc4fd47770d36b508ada24db67639e4\",\n            \"size\": 87602514,\n            \"http://commonwl.org/cwltool#generation\": 0\n        },\n        {\n            \"location\": \"file:///calrissian/tmp/n_drxp_d/crop_nir.tif\",\n            \"basename\": \"crop_nir.tif\",\n            \"nameroot\": \"crop_nir\",\n            \"nameext\": \".tif\",\n            \"class\": \"File\",\n            \"checksum\": \"sha1$295ef64b75391884bf432db41ba6e677d87ddaab\",\n            \"size\": 100761236,\n            \"http://commonwl.org/cwltool#generation\": 0\n        }\n    ]\n}\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_normalized_difference] path mappings is {\n    \"file:///calrissian/tmp/ah_lxh40/crop_green.tif\": [\n        \"/calrissian/tmp/ah_lxh40/crop_green.tif\",\n        \"/var/lib/cwl/stg9360759c-cad6-4dfc-abaf-e702568ceb64/crop_green.tif\",\n        \"File\",\n        true\n    ],\n    \"file:///calrissian/tmp/n_drxp_d/crop_nir.tif\": [\n        \"/calrissian/tmp/n_drxp_d/crop_nir.tif\",\n        \"/var/lib/cwl/stg3fad6b6e-83ba-46c9-9353-0f2e50fed908/crop_nir.tif\",\n        \"File\",\n        true\n    ]\n}\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_normalized_difference] command line bindings is [\n    {\n        \"position\": [\n            -1000000,\n            0\n        ],\n        \"datum\": \"python\"\n    },\n    {\n        \"position\": [\n            -1000000,\n            1\n        ],\n        \"datum\": \"-m\"\n    },\n    {\n        \"position\": [\n            -1000000,\n            2\n        ],\n        \"datum\": \"app\"\n    },\n    {\n        \"position\": [\n            1,\n            \"rasters\"\n        ],\n        \"datum\": [\n            {\n                \"location\": \"file:///calrissian/tmp/ah_lxh40/crop_green.tif\",\n                \"basename\": \"crop_green.tif\",\n                \"nameroot\": \"crop_green\",\n                \"nameext\": \".tif\",\n                \"class\": \"File\",\n                \"checksum\": \"sha1$9956fe066bc4fd47770d36b508ada24db67639e4\",\n                \"size\": 87602514,\n                \"http://commonwl.org/cwltool#generation\": 0,\n                \"path\": \"/var/lib/cwl/stg9360759c-cad6-4dfc-abaf-e702568ceb64/crop_green.tif\",\n                \"dirname\": \"/var/lib/cwl/stg9360759c-cad6-4dfc-abaf-e702568ceb64\"\n            },\n            {\n                \"location\": \"file:///calrissian/tmp/n_drxp_d/crop_nir.tif\",\n                \"basename\": \"crop_nir.tif\",\n                \"nameroot\": \"crop_nir\",\n                \"nameext\": \".tif\",\n                \"class\": \"File\",\n                \"checksum\": \"sha1$295ef64b75391884bf432db41ba6e677d87ddaab\",\n                \"size\": 100761236,\n                \"http://commonwl.org/cwltool#generation\": 0,\n                \"path\": \"/var/lib/cwl/stg3fad6b6e-83ba-46c9-9353-0f2e50fed908/crop_nir.tif\",\n                \"dirname\": \"/var/lib/cwl/stg3fad6b6e-83ba-46c9-9353-0f2e50fed908\"\n            }\n        ]\n    },\n    {\n        \"position\": [\n            1,\n            \"rasters\",\n            0,\n            0,\n            \"rasters\",\n            \"rasters\"\n        ],\n        \"datum\": {\n            \"location\": \"file:///calrissian/tmp/ah_lxh40/crop_green.tif\",\n            \"basename\": \"crop_green.tif\",\n            \"nameroot\": \"crop_green\",\n            \"nameext\": \".tif\",\n            \"class\": \"File\",\n            \"checksum\": \"sha1$9956fe066bc4fd47770d36b508ada24db67639e4\",\n            \"size\": 87602514,\n            \"http://commonwl.org/cwltool#generation\": 0,\n            \"path\": \"/var/lib/cwl/stg9360759c-cad6-4dfc-abaf-e702568ceb64/crop_green.tif\",\n            \"dirname\": \"/var/lib/cwl/stg9360759c-cad6-4dfc-abaf-e702568ceb64\"\n        }\n    },\n    {\n        \"position\": [\n            1,\n            \"rasters\",\n            1,\n            0,\n            \"rasters\",\n            \"rasters\"\n        ],\n        \"datum\": {\n            \"location\": \"file:///calrissian/tmp/n_drxp_d/crop_nir.tif\",\n            \"basename\": \"crop_nir.tif\",\n            \"nameroot\": \"crop_nir\",\n            \"nameext\": \".tif\",\n            \"class\": \"File\",\n            \"checksum\": \"sha1$295ef64b75391884bf432db41ba6e677d87ddaab\",\n            \"size\": 100761236,\n            \"http://commonwl.org/cwltool#generation\": 0,\n            \"path\": \"/var/lib/cwl/stg3fad6b6e-83ba-46c9-9353-0f2e50fed908/crop_nir.tif\",\n            \"dirname\": \"/var/lib/cwl/stg3fad6b6e-83ba-46c9-9353-0f2e50fed908\"\n        }\n    }\n]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mwait_for_completion with 0 futures\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] job step file:///calrissian/cwl.json#detect_water_body/node_otsu not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] job step file:///calrissian/cwl.json#detect_water_body/node_otsu not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] job step file:///calrissian/cwl.json#detect_water_body/node_otsu not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow ] job step file:///calrissian/cwl.json#main/node_stac not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] job step file:///calrissian/cwl.json#detect_water_body/node_otsu not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mallocate [ram: 512, cores: 1, gpus 0] from available [ram: 16000.0, cores: 8.0, gpus 0]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mwait_for_completion with 1 futures\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_normalized_difference] initial work dir {}\u001b[0m\nBuilding resources spec from {'cores': 1, 'ram': 512, 'gpus': 0}\n--------------------------------------------------------------------------------\napiVersion: v1\nkind: Pod\nmetadata:\n  labels: {}\n  name: node-normalized-difference-pod-xkwpryue\nspec:\n  containers:\n  - args:\n    - python -m app /var/lib/cwl/stg9360759c-cad6-4dfc-abaf-e702568ceb64/crop_green.tif\n      /var/lib/cwl/stg3fad6b6e-83ba-46c9-9353-0f2e50fed908/crop_nir.tif\n    command:\n    - /bin/sh\n    - -c\n    env:\n    - name: HOME\n      value: /nGuThn\n    - name: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - PATH\n      value: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n    - name: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - PYTHONPATH\n      value: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - /app\n    - name: TMPDIR\n      value: /tmp\n    image: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n    - ghcr.io/eoap/mastering-app-package/norm_diff@sha256:641ab55968d7f500b641969d0a7422c4c9a80dd5cc1459ee07f3e0c5ee4fa230\n    name: node-normalized-difference-container\n    resources:\n      requests:\n        cpu: '1'\n        memory: 512Mi\n    volumeMounts:\n    - mountPath: /nGuThn\n      name: argo-cwl-runner-wvqmw-calrissian-wdir\n      readOnly: false\n      subPath: tmp/9xcnshp4\n    - mountPath: /tmp\n      name: tmpdir\n    - mountPath: /var/lib/cwl/stg9360759c-cad6-4dfc-abaf-e702568ceb64/crop_green.tif\n      name: argo-cwl-runner-wvqmw-calrissian-wdir\n      readOnly: true\n      subPath: tmp/ah_lxh40/crop_green.tif\n    - mountPath: /var/lib/cwl/stg3fad6b6e-83ba-46c9-9353-0f2e50fed908/crop_nir.tif\n      name: argo-cwl-runner-wvqmw-calrissian-wdir\n      readOnly: true\n      subPath: tmp/n_drxp_d/crop_nir.tif\n    workingDir: /nGuThn\n  initContainers: []\n  nodeSelector: {}\n  restartPolicy: Never\n  securityContext:\n    runAsGroup: 0\n    runAsUser: 0\n  serviceAccountName: argo\n  volumes:\n  - name: argo-cwl-runner-wvqmw-calrissian-wdir\n    persistentVolumeClaim:\n      claimName: argo-cwl-runner-wvqmw-calrissian-wdir\n      readOnly: false\n  - emptyDir: {}\n    name: tmpdir\n--------------------------------------------------------------------------------\n\nCreated k8s pod name node-normalized-difference-pod-xkwpryue with id 073b3c4f-b30b-44a4-bd42-06db3745b4d0\nPodMonitor adding node-normalized-difference-pod-xkwpryue\nk8s pod 'node-normalized-difference-pod-xkwpryue' started\npod name node-normalized-difference-pod-xkwpryue with id 073b3c4f-b30b-44a4-bd42-06db3745b4d0 has status None\npod name node-normalized-difference-pod-xkwpryue with id 073b3c4f-b30b-44a4-bd42-06db3745b4d0 has status {'allocated_resources': None,\n 'container_id': None,\n 'image': 'ghcr.io/eoap/mastering-app-package/norm_diff@sha256:641ab55968d7f500b641969d0a7422c4c9a80dd5cc1459ee07f3e0c5ee4fa230',\n 'image_id': '',\n 'last_state': {'running': None, 'terminated': None, 'waiting': None},\n 'name': 'node-normalized-difference-container',\n 'ready': False,\n 'resources': None,\n 'restart_count': 0,\n 'started': False,\n 'state': {'running': None,\n           'terminated': None,\n           'waiting': {'message': None, 'reason': 'ContainerCreating'}}}\npod name node-normalized-difference-pod-xkwpryue with id 073b3c4f-b30b-44a4-bd42-06db3745b4d0 has status {'allocated_resources': None,\n 'container_id': 'docker://9438fa6ca0b2af0246b3bf1661945b75f2cc9a61c8f4a4fbe3a4dd99fa27249d',\n 'image': 'sha256:9eea4fb39f705d92bb5a2ccd99c8ab1d6260155c3a51a7761c9895bc3ad64587',\n 'image_id': 'docker-pullable://ghcr.io/eoap/mastering-app-package/norm_diff@sha256:641ab55968d7f500b641969d0a7422c4c9a80dd5cc1459ee07f3e0c5ee4fa230',\n 'last_state': {'running': None, 'terminated': None, 'waiting': None},\n 'name': 'node-normalized-difference-container',\n 'ready': True,\n 'resources': None,\n 'restart_count': 0,\n 'started': True,\n 'state': {'running': {'started_at': datetime.datetime(2024, 7, 19, 10, 40, 31, tzinfo=tzlocal())},\n           'terminated': None,\n           'waiting': None}}\n[node-normalized-difference-pod-xkwpryue] follow_logs start\n[node-normalized-difference-pod-xkwpryue] 2024-07-19 10:40:31.915 | INFO     | __main__:normalized_difference:18 - Processing the normalized image with /var/lib/cwl/stg9360759c-cad6-4dfc-abaf-e702568ceb64/crop_green.tif and /var/lib/cwl/stg3fad6b6e-83ba-46c9-9353-0f2e50fed908/crop_nir.tif\n[node-normalized-difference-pod-xkwpryue] 2024-07-19 10:40:32.933 | INFO     | __main__:normalized_difference:39 - Write norm_diff.tif\n[node-normalized-difference-pod-xkwpryue] 2024-07-19 10:40:37.514 | INFO     | __main__:normalized_difference:42 - Done!\n[node-normalized-difference-pod-xkwpryue] follow_logs end\npod name node-normalized-difference-pod-xkwpryue with id 073b3c4f-b30b-44a4-bd42-06db3745b4d0 has status {'allocated_resources': None,\n 'container_id': 'docker://9438fa6ca0b2af0246b3bf1661945b75f2cc9a61c8f4a4fbe3a4dd99fa27249d',\n 'image': 'sha256:9eea4fb39f705d92bb5a2ccd99c8ab1d6260155c3a51a7761c9895bc3ad64587',\n 'image_id': 'docker-pullable://ghcr.io/eoap/mastering-app-package/norm_diff@sha256:641ab55968d7f500b641969d0a7422c4c9a80dd5cc1459ee07f3e0c5ee4fa230',\n 'last_state': {'running': None, 'terminated': None, 'waiting': None},\n 'name': 'node-normalized-difference-container',\n 'ready': False,\n 'resources': None,\n 'restart_count': 0,\n 'started': False,\n 'state': {'running': None,\n           'terminated': {'container_id': 'docker://9438fa6ca0b2af0246b3bf1661945b75f2cc9a61c8f4a4fbe3a4dd99fa27249d',\n                          'exit_code': 0,\n                          'finished_at': datetime.datetime(2024, 7, 19, 10, 40, 37, tzinfo=tzlocal()),\n                          'message': None,\n                          'reason': 'Completed',\n                          'signal': None,\n                          'started_at': datetime.datetime(2024, 7, 19, 10, 40, 31, tzinfo=tzlocal())},\n           'waiting': None}}\nHandling terminated pod name node-normalized-difference-pod-xkwpryue with id 073b3c4f-b30b-44a4-bd42-06db3745b4d0\nhandling completion with 0\nPodMonitor removing node-normalized-difference-pod-xkwpryue\nWriting pod node_normalized_difference logs to /calrissian/logs/node_normalized_difference.log\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[step node_normalized_difference] produced output {\n    \"file:///calrissian/cwl.json#detect_water_body/node_normalized_difference/ndwi\": {\n        \"location\": \"file:///calrissian/tmp/9xcnshp4/norm_diff.tif\",\n        \"basename\": \"norm_diff.tif\",\n        \"nameroot\": \"norm_diff\",\n        \"nameext\": \".tif\",\n        \"class\": \"File\",\n        \"checksum\": \"sha1$8a8000c4b3fa09be2364ce009710c11124d009ca\",\n        \"size\": 224221619,\n        \"http://commonwl.org/cwltool#generation\": 0\n    }\n}\u001b[0m\n\u001b[1;30mINFO\u001b[0m [step node_normalized_difference] completed success\nshutil.rmtree(/tmp/ria3mtjs, True)\nshutil.rmtree(/tmp/3owexlu0, True)\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mrestore [ram: 512, cores: 1, gpus 0] to available [ram: 15488.0, cores: 7.0, gpus 0]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow ] job step file:///calrissian/cwl.json#main/node_stac not ready\u001b[0m\n\u001b[1;30mINFO\u001b[0m [workflow node_water_bodies] starting step node_otsu\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[step node_otsu] job input {\n    \"file:///calrissian/cwl.json#detect_water_body/node_otsu/raster\": {\n        \"location\": \"file:///calrissian/tmp/9xcnshp4/norm_diff.tif\",\n        \"basename\": \"norm_diff.tif\",\n        \"nameroot\": \"norm_diff\",\n        \"nameext\": \".tif\",\n        \"class\": \"File\",\n        \"checksum\": \"sha1$8a8000c4b3fa09be2364ce009710c11124d009ca\",\n        \"size\": 224221619,\n        \"http://commonwl.org/cwltool#generation\": 0\n    }\n}\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[step node_otsu] evaluated job input to {\n    \"file:///calrissian/cwl.json#detect_water_body/node_otsu/raster\": {\n        \"location\": \"file:///calrissian/tmp/9xcnshp4/norm_diff.tif\",\n        \"basename\": \"norm_diff.tif\",\n        \"nameroot\": \"norm_diff\",\n        \"nameext\": \".tif\",\n        \"class\": \"File\",\n        \"checksum\": \"sha1$8a8000c4b3fa09be2364ce009710c11124d009ca\",\n        \"size\": 224221619,\n        \"http://commonwl.org/cwltool#generation\": 0\n    }\n}\u001b[0m\n\u001b[1;30mINFO\u001b[0m [step node_otsu] start\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_otsu] initializing from file:///calrissian/cwl.json#otsu as part of step node_otsu\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_otsu] {\n    \"raster\": {\n        \"location\": \"file:///calrissian/tmp/9xcnshp4/norm_diff.tif\",\n        \"basename\": \"norm_diff.tif\",\n        \"nameroot\": \"norm_diff\",\n        \"nameext\": \".tif\",\n        \"class\": \"File\",\n        \"checksum\": \"sha1$8a8000c4b3fa09be2364ce009710c11124d009ca\",\n        \"size\": 224221619,\n        \"http://commonwl.org/cwltool#generation\": 0\n    }\n}\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_otsu] path mappings is {\n    \"file:///calrissian/tmp/9xcnshp4/norm_diff.tif\": [\n        \"/calrissian/tmp/9xcnshp4/norm_diff.tif\",\n        \"/var/lib/cwl/stge43aa38e-01c8-49f9-90f1-45bc534a5e1f/norm_diff.tif\",\n        \"File\",\n        true\n    ]\n}\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_otsu] command line bindings is [\n    {\n        \"position\": [\n            -1000000,\n            0\n        ],\n        \"datum\": \"python\"\n    },\n    {\n        \"position\": [\n            -1000000,\n            1\n        ],\n        \"datum\": \"-m\"\n    },\n    {\n        \"position\": [\n            -1000000,\n            2\n        ],\n        \"datum\": \"app\"\n    },\n    {\n        \"position\": [\n            1,\n            \"raster\"\n        ],\n        \"datum\": {\n            \"location\": \"file:///calrissian/tmp/9xcnshp4/norm_diff.tif\",\n            \"basename\": \"norm_diff.tif\",\n            \"nameroot\": \"norm_diff\",\n            \"nameext\": \".tif\",\n            \"class\": \"File\",\n            \"checksum\": \"sha1$8a8000c4b3fa09be2364ce009710c11124d009ca\",\n            \"size\": 224221619,\n            \"http://commonwl.org/cwltool#generation\": 0,\n            \"path\": \"/var/lib/cwl/stge43aa38e-01c8-49f9-90f1-45bc534a5e1f/norm_diff.tif\",\n            \"dirname\": \"/var/lib/cwl/stge43aa38e-01c8-49f9-90f1-45bc534a5e1f\"\n        }\n    }\n]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mwait_for_completion with 0 futures\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow ] job step file:///calrissian/cwl.json#main/node_stac not ready\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mallocate [ram: 512, cores: 1, gpus 0] from available [ram: 16000.0, cores: 8.0, gpus 0]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mwait_for_completion with 1 futures\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_otsu] initial work dir {}\u001b[0m\nBuilding resources spec from {'cores': 1, 'ram': 512, 'gpus': 0}\n--------------------------------------------------------------------------------\napiVersion: v1\nkind: Pod\nmetadata:\n  labels: {}\n  name: node-otsu-pod-edyejmqx\nspec:\n  containers:\n  - args:\n    - python -m app /var/lib/cwl/stge43aa38e-01c8-49f9-90f1-45bc534a5e1f/norm_diff.tif\n    command:\n    - /bin/sh\n    - -c\n    env:\n    - name: HOME\n      value: /nGuThn\n    - name: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - PATH\n      value: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n    - name: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - PYTHONPATH\n      value: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - /app\n    - name: TMPDIR\n      value: /tmp\n    image: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n    - ghcr.io/eoap/mastering-app-package/otsu@sha256:ec02baf6a007ebb5a2dc037af2da8ef94db67bb8a6139682ad61041f9d27c779\n    name: node-otsu-container\n    resources:\n      requests:\n        cpu: '1'\n        memory: 512Mi\n    volumeMounts:\n    - mountPath: /nGuThn\n      name: argo-cwl-runner-wvqmw-calrissian-wdir\n      readOnly: false\n      subPath: tmp/ayi9uzmv\n    - mountPath: /tmp\n      name: tmpdir\n    - mountPath: /var/lib/cwl/stge43aa38e-01c8-49f9-90f1-45bc534a5e1f/norm_diff.tif\n      name: argo-cwl-runner-wvqmw-calrissian-wdir\n      readOnly: true\n      subPath: tmp/9xcnshp4/norm_diff.tif\n    workingDir: /nGuThn\n  initContainers: []\n  nodeSelector: {}\n  restartPolicy: Never\n  securityContext:\n    runAsGroup: 0\n    runAsUser: 0\n  serviceAccountName: argo\n  volumes:\n  - name: argo-cwl-runner-wvqmw-calrissian-wdir\n    persistentVolumeClaim:\n      claimName: argo-cwl-runner-wvqmw-calrissian-wdir\n      readOnly: false\n  - emptyDir: {}\n    name: tmpdir\n--------------------------------------------------------------------------------\n\nCreated k8s pod name node-otsu-pod-edyejmqx with id ef84ca4d-89c8-41ad-afaa-a43c18a31640\nPodMonitor adding node-otsu-pod-edyejmqx\nk8s pod 'node-otsu-pod-edyejmqx' started\npod name node-otsu-pod-edyejmqx with id ef84ca4d-89c8-41ad-afaa-a43c18a31640 has status None\npod name node-otsu-pod-edyejmqx with id ef84ca4d-89c8-41ad-afaa-a43c18a31640 has status {'allocated_resources': None,\n 'container_id': None,\n 'image': 'ghcr.io/eoap/mastering-app-package/otsu@sha256:ec02baf6a007ebb5a2dc037af2da8ef94db67bb8a6139682ad61041f9d27c779',\n 'image_id': '',\n 'last_state': {'running': None, 'terminated': None, 'waiting': None},\n 'name': 'node-otsu-container',\n 'ready': False,\n 'resources': None,\n 'restart_count': 0,\n 'started': False,\n 'state': {'running': None,\n           'terminated': None,\n           'waiting': {'message': None, 'reason': 'ContainerCreating'}}}\npod name node-otsu-pod-edyejmqx with id ef84ca4d-89c8-41ad-afaa-a43c18a31640 has status {'allocated_resources': None,\n 'container_id': 'docker://dda89dcc2b7350d43b66008835ebfe9152899325b707cc4d787c6ceb402973c4',\n 'image': 'sha256:30f412cc580cc072605130893c652082fbbcf68ac6f02984468b492361ad787c',\n 'image_id': 'docker-pullable://ghcr.io/eoap/mastering-app-package/otsu@sha256:ec02baf6a007ebb5a2dc037af2da8ef94db67bb8a6139682ad61041f9d27c779',\n 'last_state': {'running': None, 'terminated': None, 'waiting': None},\n 'name': 'node-otsu-container',\n 'ready': True,\n 'resources': None,\n 'restart_count': 0,\n 'started': True,\n 'state': {'running': {'started_at': datetime.datetime(2024, 7, 19, 10, 40, 38, tzinfo=tzlocal())},\n           'terminated': None,\n           'waiting': None}}\n[node-otsu-pod-edyejmqx] follow_logs start\n[node-otsu-pod-edyejmqx] 2024-07-19 10:40:39.942 | INFO     | __main__:otsu:37 - Applying the Otsu threshold to /var/lib/cwl/stge43aa38e-01c8-49f9-90f1-45bc534a5e1f/norm_diff.tif\n[node-otsu-pod-edyejmqx] 2024-07-19 10:40:39.945 | INFO     | __main__:otsu:40 - Write otsu.tif\n[node-otsu-pod-edyejmqx] 2024-07-19 10:40:41.028 | INFO     | __main__:otsu:43 - Done!\n[node-otsu-pod-edyejmqx] follow_logs end\npod name node-otsu-pod-edyejmqx with id ef84ca4d-89c8-41ad-afaa-a43c18a31640 has status {'allocated_resources': None,\n 'container_id': 'docker://dda89dcc2b7350d43b66008835ebfe9152899325b707cc4d787c6ceb402973c4',\n 'image': 'sha256:30f412cc580cc072605130893c652082fbbcf68ac6f02984468b492361ad787c',\n 'image_id': 'docker-pullable://ghcr.io/eoap/mastering-app-package/otsu@sha256:ec02baf6a007ebb5a2dc037af2da8ef94db67bb8a6139682ad61041f9d27c779',\n 'last_state': {'running': None, 'terminated': None, 'waiting': None},\n 'name': 'node-otsu-container',\n 'ready': False,\n 'resources': None,\n 'restart_count': 0,\n 'started': False,\n 'state': {'running': None,\n           'terminated': {'container_id': 'docker://dda89dcc2b7350d43b66008835ebfe9152899325b707cc4d787c6ceb402973c4',\n                          'exit_code': 0,\n                          'finished_at': datetime.datetime(2024, 7, 19, 10, 40, 41, tzinfo=tzlocal()),\n                          'message': None,\n                          'reason': 'Completed',\n                          'signal': None,\n                          'started_at': datetime.datetime(2024, 7, 19, 10, 40, 38, tzinfo=tzlocal())},\n           'waiting': None}}\nHandling terminated pod name node-otsu-pod-edyejmqx with id ef84ca4d-89c8-41ad-afaa-a43c18a31640\nhandling completion with 0\nPodMonitor removing node-otsu-pod-edyejmqx\nWriting pod node_otsu logs to /calrissian/logs/node_otsu.log\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[step node_otsu] produced output {\n    \"file:///calrissian/cwl.json#detect_water_body/node_otsu/binary_mask_item\": {\n        \"location\": \"file:///calrissian/tmp/ayi9uzmv/otsu.tif\",\n        \"basename\": \"otsu.tif\",\n        \"nameroot\": \"otsu\",\n        \"nameext\": \".tif\",\n        \"class\": \"File\",\n        \"checksum\": \"sha1$210598cf619d49eabfdc24414bd445f59668f3bd\",\n        \"size\": 289288,\n        \"http://commonwl.org/cwltool#generation\": 0\n    }\n}\u001b[0m\n\u001b[1;30mINFO\u001b[0m [step node_otsu] completed success\n\u001b[1;30mINFO\u001b[0m [workflow node_water_bodies] completed success\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow node_water_bodies] outputs {\n    \"detected_water_body\": {\n        \"location\": \"file:///calrissian/tmp/ayi9uzmv/otsu.tif\",\n        \"basename\": \"otsu.tif\",\n        \"nameroot\": \"otsu\",\n        \"nameext\": \".tif\",\n        \"class\": \"File\",\n        \"checksum\": \"sha1$210598cf619d49eabfdc24414bd445f59668f3bd\",\n        \"size\": 289288,\n        \"http://commonwl.org/cwltool#generation\": 0\n    }\n}\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[step node_water_bodies] produced output {\n    \"file:///calrissian/cwl.json#main/node_water_bodies/detected_water_body\": [\n        {\n            \"location\": \"file:///calrissian/tmp/ayi9uzmv/otsu.tif\",\n            \"basename\": \"otsu.tif\",\n            \"nameroot\": \"otsu\",\n            \"nameext\": \".tif\",\n            \"class\": \"File\",\n            \"checksum\": \"sha1$210598cf619d49eabfdc24414bd445f59668f3bd\",\n            \"size\": 289288,\n            \"http://commonwl.org/cwltool#generation\": 0\n        }\n    ]\n}\u001b[0m\n\u001b[1;30mINFO\u001b[0m [step node_water_bodies] completed success\nshutil.rmtree(/tmp/iqlmpw90, True)\nshutil.rmtree(/tmp/3lytara0, True)\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mrestore [ram: 512, cores: 1, gpus 0] to available [ram: 15488.0, cores: 7.0, gpus 0]\u001b[0m\n\u001b[1;30mINFO\u001b[0m [workflow ] starting step node_stac\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[step node_stac] job input {\n    \"file:///calrissian/cwl.json#main/node_stac/item\": [\n        \"https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\"\n    ],\n    \"file:///calrissian/cwl.json#main/node_stac/rasters\": [\n        {\n            \"location\": \"file:///calrissian/tmp/ayi9uzmv/otsu.tif\",\n            \"basename\": \"otsu.tif\",\n            \"nameroot\": \"otsu\",\n            \"nameext\": \".tif\",\n            \"class\": \"File\",\n            \"checksum\": \"sha1$210598cf619d49eabfdc24414bd445f59668f3bd\",\n            \"size\": 289288,\n            \"http://commonwl.org/cwltool#generation\": 0\n        }\n    ]\n}\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[step node_stac] evaluated job input to {\n    \"file:///calrissian/cwl.json#main/node_stac/item\": [\n        \"https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\"\n    ],\n    \"file:///calrissian/cwl.json#main/node_stac/rasters\": [\n        {\n            \"location\": \"file:///calrissian/tmp/ayi9uzmv/otsu.tif\",\n            \"basename\": \"otsu.tif\",\n            \"nameroot\": \"otsu\",\n            \"nameext\": \".tif\",\n            \"class\": \"File\",\n            \"checksum\": \"sha1$210598cf619d49eabfdc24414bd445f59668f3bd\",\n            \"size\": 289288,\n            \"http://commonwl.org/cwltool#generation\": 0\n        }\n    ]\n}\u001b[0m\n\u001b[1;30mINFO\u001b[0m [step node_stac] start\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_stac] initializing from file:///calrissian/cwl.json#stac as part of step node_stac\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_stac] {\n    \"item\": [\n        \"https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\"\n    ],\n    \"rasters\": [\n        {\n            \"location\": \"file:///calrissian/tmp/ayi9uzmv/otsu.tif\",\n            \"basename\": \"otsu.tif\",\n            \"nameroot\": \"otsu\",\n            \"nameext\": \".tif\",\n            \"class\": \"File\",\n            \"checksum\": \"sha1$210598cf619d49eabfdc24414bd445f59668f3bd\",\n            \"size\": 289288,\n            \"http://commonwl.org/cwltool#generation\": 0\n        }\n    ]\n}\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_stac] path mappings is {\n    \"file:///calrissian/tmp/ayi9uzmv/otsu.tif\": [\n        \"/calrissian/tmp/ayi9uzmv/otsu.tif\",\n        \"/var/lib/cwl/stg08303c53-2a5b-499c-88f1-c6296bbd6508/otsu.tif\",\n        \"File\",\n        true\n    ]\n}\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_stac] command line bindings is [\n    {\n        \"position\": [\n            -1000000,\n            0\n        ],\n        \"datum\": \"python\"\n    },\n    {\n        \"position\": [\n            -1000000,\n            1\n        ],\n        \"datum\": \"-m\"\n    },\n    {\n        \"position\": [\n            -1000000,\n            2\n        ],\n        \"datum\": \"app\"\n    },\n    {\n        \"prefix\": \"--input-item\",\n        \"position\": [\n            0,\n            0,\n            \"item\",\n            \"item\"\n        ],\n        \"datum\": \"https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\"\n    },\n    {\n        \"prefix\": \"--water-body\",\n        \"position\": [\n            0,\n            0,\n            \"rasters\",\n            \"rasters\"\n        ],\n        \"datum\": {\n            \"location\": \"file:///calrissian/tmp/ayi9uzmv/otsu.tif\",\n            \"basename\": \"otsu.tif\",\n            \"nameroot\": \"otsu\",\n            \"nameext\": \".tif\",\n            \"class\": \"File\",\n            \"checksum\": \"sha1$210598cf619d49eabfdc24414bd445f59668f3bd\",\n            \"size\": 289288,\n            \"http://commonwl.org/cwltool#generation\": 0,\n            \"path\": \"/var/lib/cwl/stg08303c53-2a5b-499c-88f1-c6296bbd6508/otsu.tif\",\n            \"dirname\": \"/var/lib/cwl/stg08303c53-2a5b-499c-88f1-c6296bbd6508\"\n        }\n    }\n]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mwait_for_completion with 0 futures\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mallocate [ram: 512, cores: 1, gpus 0] from available [ram: 16000.0, cores: 8.0, gpus 0]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mwait_for_completion with 1 futures\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[job node_stac] initial work dir {}\u001b[0m\nBuilding resources spec from {'cores': 1, 'ram': 512, 'gpus': 0}\n--------------------------------------------------------------------------------\napiVersion: v1\nkind: Pod\nmetadata:\n  labels: {}\n  name: node-stac-pod-lebziriu\nspec:\n  containers:\n  - args:\n    - python -m app --input-item https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\n      --water-body /var/lib/cwl/stg08303c53-2a5b-499c-88f1-c6296bbd6508/otsu.tif\n    command:\n    - /bin/sh\n    - -c\n    env:\n    - name: HOME\n      value: /nGuThn\n    - name: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - PATH\n      value: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n    - name: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - PYTHONPATH\n      value: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n      - /app\n    - name: TMPDIR\n      value: /tmp\n    image: !!python/object/new:ruamel.yaml.scalarstring.DoubleQuotedScalarString\n    - ghcr.io/eoap/mastering-app-package/stac@sha256:8ad7e7d6999c0c4c91c2b19ce231f24734d2af8f41b855ef9a06276d23345601\n    name: node-stac-container\n    resources:\n      requests:\n        cpu: '1'\n        memory: 512Mi\n    volumeMounts:\n    - mountPath: /nGuThn\n      name: argo-cwl-runner-wvqmw-calrissian-wdir\n      readOnly: false\n      subPath: tmp/73k_b1lo\n    - mountPath: /tmp\n      name: tmpdir\n    - mountPath: /var/lib/cwl/stg08303c53-2a5b-499c-88f1-c6296bbd6508/otsu.tif\n      name: argo-cwl-runner-wvqmw-calrissian-wdir\n      readOnly: true\n      subPath: tmp/ayi9uzmv/otsu.tif\n    workingDir: /nGuThn\n  initContainers: []\n  nodeSelector: {}\n  restartPolicy: Never\n  securityContext:\n    runAsGroup: 0\n    runAsUser: 0\n  serviceAccountName: argo\n  volumes:\n  - name: argo-cwl-runner-wvqmw-calrissian-wdir\n    persistentVolumeClaim:\n      claimName: argo-cwl-runner-wvqmw-calrissian-wdir\n      readOnly: false\n  - emptyDir: {}\n    name: tmpdir\n--------------------------------------------------------------------------------\n\nCreated k8s pod name node-stac-pod-lebziriu with id 33b47951-0174-4110-a369-0e978e50862e\nPodMonitor adding node-stac-pod-lebziriu\nk8s pod 'node-stac-pod-lebziriu' started\npod name node-stac-pod-lebziriu with id 33b47951-0174-4110-a369-0e978e50862e has status None\npod name node-stac-pod-lebziriu with id 33b47951-0174-4110-a369-0e978e50862e has status None\npod name node-stac-pod-lebziriu with id 33b47951-0174-4110-a369-0e978e50862e has status {'allocated_resources': None,\n 'container_id': None,\n 'image': 'ghcr.io/eoap/mastering-app-package/stac@sha256:8ad7e7d6999c0c4c91c2b19ce231f24734d2af8f41b855ef9a06276d23345601',\n 'image_id': '',\n 'last_state': {'running': None, 'terminated': None, 'waiting': None},\n 'name': 'node-stac-container',\n 'ready': False,\n 'resources': None,\n 'restart_count': 0,\n 'started': False,\n 'state': {'running': None,\n           'terminated': None,\n           'waiting': {'message': None, 'reason': 'ContainerCreating'}}}\npod name node-stac-pod-lebziriu with id 33b47951-0174-4110-a369-0e978e50862e has status {'allocated_resources': None,\n 'container_id': 'docker://a78d92e03db84b5f73e4359e163821c5b04be3d19eb39e8ec756a34f95a3dada',\n 'image': 'sha256:49137993bbc6c46dfaa4456e2f576ff7a093fade098e2e6499b3dcf210b69bcb',\n 'image_id': 'docker-pullable://ghcr.io/eoap/mastering-app-package/stac@sha256:8ad7e7d6999c0c4c91c2b19ce231f24734d2af8f41b855ef9a06276d23345601',\n 'last_state': {'running': None, 'terminated': None, 'waiting': None},\n 'name': 'node-stac-container',\n 'ready': True,\n 'resources': None,\n 'restart_count': 0,\n 'started': True,\n 'state': {'running': {'started_at': datetime.datetime(2024, 7, 19, 10, 40, 42, tzinfo=tzlocal())},\n           'terminated': None,\n           'waiting': None}}\n[node-stac-pod-lebziriu] follow_logs start\n[node-stac-pod-lebziriu] 2024-07-19 10:40:42.958 | INFO     | __main__:to_stac:31 - Creating a STAC Catalog for /var/lib/cwl/stg08303c53-2a5b-499c-88f1-c6296bbd6508/otsu.tif\n[node-stac-pod-lebziriu] 2024-07-19 10:40:43.272 | INFO     | __main__:to_stac:62 - Done!\n[node-stac-pod-lebziriu] follow_logs end\npod name node-stac-pod-lebziriu with id 33b47951-0174-4110-a369-0e978e50862e has status {'allocated_resources': None,\n 'container_id': 'docker://a78d92e03db84b5f73e4359e163821c5b04be3d19eb39e8ec756a34f95a3dada',\n 'image': 'sha256:49137993bbc6c46dfaa4456e2f576ff7a093fade098e2e6499b3dcf210b69bcb',\n 'image_id': 'docker-pullable://ghcr.io/eoap/mastering-app-package/stac@sha256:8ad7e7d6999c0c4c91c2b19ce231f24734d2af8f41b855ef9a06276d23345601',\n 'last_state': {'running': None, 'terminated': None, 'waiting': None},\n 'name': 'node-stac-container',\n 'ready': False,\n 'resources': None,\n 'restart_count': 0,\n 'started': False,\n 'state': {'running': None,\n           'terminated': {'container_id': 'docker://a78d92e03db84b5f73e4359e163821c5b04be3d19eb39e8ec756a34f95a3dada',\n                          'exit_code': 0,\n                          'finished_at': datetime.datetime(2024, 7, 19, 10, 40, 43, tzinfo=tzlocal()),\n                          'message': None,\n                          'reason': 'Completed',\n                          'signal': None,\n                          'started_at': datetime.datetime(2024, 7, 19, 10, 40, 42, tzinfo=tzlocal())},\n           'waiting': None}}\nHandling terminated pod name node-stac-pod-lebziriu with id 33b47951-0174-4110-a369-0e978e50862e\nhandling completion with 0\nPodMonitor removing node-stac-pod-lebziriu\nWriting pod node_stac logs to /calrissian/logs/node_stac.log\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[step node_stac] produced output {\n    \"file:///calrissian/cwl.json#main/node_stac/stac_catalog\": {\n        \"location\": \"file:///calrissian/tmp/73k_b1lo\",\n        \"basename\": \"73k_b1lo\",\n        \"nameroot\": \"73k_b1lo\",\n        \"nameext\": \"\",\n        \"class\": \"Directory\"\n    }\n}\u001b[0m\n\u001b[1;30mINFO\u001b[0m [step node_stac] completed success\n\u001b[1;30mINFO\u001b[0m [workflow ] completed success\n\u001b[1;30mDEBUG\u001b[0m \u001b[32m[workflow ] outputs {\n    \"stac_catalog\": {\n        \"location\": \"file:///calrissian/tmp/73k_b1lo\",\n        \"basename\": \"73k_b1lo\",\n        \"nameroot\": \"73k_b1lo\",\n        \"nameext\": \"\",\n        \"class\": \"Directory\"\n    }\n}\u001b[0m\nshutil.rmtree(/tmp/d_rzljxw, True)\nshutil.rmtree(/tmp/oanc2um0, True)\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mrestore [ram: 512, cores: 1, gpus 0] to available [ram: 15488.0, cores: 7.0, gpus 0]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mwait_for_completion with 0 futures\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mwait_for_completion with 0 futures\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mFinishing ThreadPoolExecutor.run_jobs: total_resources=[ram: 16000.0, cores: 8.0, gpus 0], available_resources=[ram: 16000.0, cores: 8.0, gpus 0]\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mMoving /calrissian/tmp/73k_b1lo to /calrissian/results/73k_b1lo\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mRemoving intermediate output directory /calrissian/tmp/9xcnshp4\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mRemoving intermediate output directory /calrissian/tmp/ayi9uzmv\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mRemoving intermediate output directory /calrissian/tmp/n_drxp_d\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mRemoving intermediate output directory /calrissian/tmp/vb9bzgzg\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mRemoving intermediate output directory /calrissian/tmp/isvjnknv\u001b[0m\n\u001b[1;30mDEBUG\u001b[0m \u001b[32mRemoving intermediate output directory /calrissian/tmp/ah_lxh40\u001b[0m\n\u001b[1;30mINFO\u001b[0m Final process status is success\nStarting Cleanup\nFinishing Cleanup","valueFrom":{"path":"/tmp/calrissian-stderr.txt"}},{"name":"calrissian-report","value":"{\n    \"cores_allowed\": 8.0,\n    \"ram_mb_allowed\": 16000.0,\n    \"children\": [\n        {\n            \"cpus\": 1.0,\n            \"ram_megabytes\": 536.870912,\n            \"disk_megabytes\": 87.602514,\n            \"exit_code\": 0,\n            \"name\": \"node_crop\",\n            \"start_time\": \"2024-07-19T10:40:02+00:00\",\n            \"finish_time\": \"2024-07-19T10:40:27+00:00\",\n            \"elapsed_hours\": 0.006944444444444444,\n            \"elapsed_seconds\": 25.0,\n            \"ram_megabyte_hours\": 3.7282702222222217,\n            \"cpu_hours\": 0.006944444444444444\n        },\n        {\n            \"cpus\": 1.0,\n            \"ram_megabytes\": 536.870912,\n            \"disk_megabytes\": 100.761236,\n            \"exit_code\": 0,\n            \"name\": \"node_crop_2\",\n            \"start_time\": \"2024-07-19T10:40:02+00:00\",\n            \"finish_time\": \"2024-07-19T10:40:30+00:00\",\n            \"elapsed_hours\": 0.0077777777777777776,\n            \"elapsed_seconds\": 28.0,\n            \"ram_megabyte_hours\": 4.175662648888888,\n            \"cpu_hours\": 0.0077777777777777776\n        },\n        {\n            \"cpus\": 1.0,\n            \"ram_megabytes\": 536.870912,\n            \"disk_megabytes\": 224.221619,\n            \"exit_code\": 0,\n            \"name\": \"node_normalized_difference\",\n            \"start_time\": \"2024-07-19T10:40:31+00:00\",\n            \"finish_time\": \"2024-07-19T10:40:37+00:00\",\n            \"elapsed_hours\": 0.0016666666666666668,\n            \"elapsed_seconds\": 6.0,\n            \"ram_megabyte_hours\": 0.8947848533333334,\n            \"cpu_hours\": 0.0016666666666666668\n        },\n        {\n            \"cpus\": 1.0,\n            \"ram_megabytes\": 536.870912,\n            \"disk_megabytes\": 0.289288,\n            \"exit_code\": 0,\n            \"name\": \"node_otsu\",\n            \"start_time\": \"2024-07-19T10:40:38+00:00\",\n            \"finish_time\": \"2024-07-19T10:40:41+00:00\",\n            \"elapsed_hours\": 0.0008333333333333334,\n            \"elapsed_seconds\": 3.0,\n            \"ram_megabyte_hours\": 0.4473924266666667,\n            \"cpu_hours\": 0.0008333333333333334\n        },\n        {\n            \"cpus\": 1.0,\n            \"ram_megabytes\": 536.870912,\n            \"disk_megabytes\": 0.0,\n            \"exit_code\": 0,\n            \"name\": \"node_stac\",\n            \"start_time\": \"2024-07-19T10:40:42+00:00\",\n            \"finish_time\": \"2024-07-19T10:40:43+00:00\",\n            \"elapsed_hours\": 0.0002777777777777778,\n            \"elapsed_seconds\": 1.0,\n            \"ram_megabyte_hours\": 0.14913080888888888,\n            \"cpu_hours\": 0.0002777777777777778\n        }\n    ],\n    \"start_time\": \"2024-07-19T10:40:02+00:00\",\n    \"finish_time\": \"2024-07-19T10:40:43+00:00\",\n    \"elapsed_hours\": 0.01138888888888889,\n    \"elapsed_seconds\": 41.0,\n    \"total_cpu_hours\": 0.017499999999999995,\n    \"total_ram_megabyte_hours\": 9.39524096,\n    \"total_disk_megabytes\": 412.874657,\n    \"total_tasks\": 5,\n    \"max_parallel_cpus\": 2.0,\n    \"max_parallel_ram_megabytes\": 1073.741824,\n    \"max_parallel_tasks\": 2\n}","valueFrom":{"path":"/tmp/calrissian-report.json"}}],"artifacts":[{"name":"tool-logs","path":"/calrissian/logs","s3":{"key":"argo-cwl-runner-wvqmw-artifacts/tool-logs.tgz"}},{"name":"calrissian-output","path":"/tmp/calrissian-output.json","s3":{"key":"argo-cwl-runner-wvqmw-artifacts/calrissian-output.tgz"}},{"name":"calrissian-stderr","path":"/tmp/calrissian-stderr.txt","s3":{"key":"argo-cwl-runner-wvqmw-artifacts/calrissian-stderr.tgz"}},{"name":"calrissian-report","path":"/tmp/calrissian-report.json","s3":{"key":"argo-cwl-runner-wvqmw-artifacts/calrissian-report.tgz"}},{"name":"main-logs","s3":{"key":"argo-cwl-runner-wvqmw/argo-cwl-runner-wvqmw-get-results-3279323762/main.log"}}],"exitCode":"0"},"hostNodeName":"minikube"},"argo-cwl-runner-wvqmw-3440433147":{"id":"argo-cwl-runner-wvqmw-3440433147","name":"argo-cwl-runner-wvqmw[2]","displayName":"[2]","type":"StepGroup","templateScope":"local/","phase":"Succeeded","boundaryID":"argo-cwl-runner-wvqmw","startedAt":"2024-07-19T10:40:58Z","finishedAt":"2024-07-19T10:41:08Z","estimatedDuration":10,"progress":"2/2","resourcesDuration":{"cpu":2,"memory":24},"nodeFlag":{},"children":["argo-cwl-runner-wvqmw-3279323762","argo-cwl-runner-wvqmw-2838679990"]}},"storedTemplates":{"namespaced/argo-cwl-runner/calrissian-runner":{"name":"calrissian-runner","inputs":{"parameters":[{"name":"parameters"},{"name":"cwl"},{"name":"max_ram"},{"name":"max_cores"}]},"outputs":{"parameters":[{"name":"results","valueFrom":{"parameter":"{{steps.get-results.outputs.parameters.calrissian-output}}"}},{"name":"logs","valueFrom":{"parameter":"{{steps.get-results.outputs.parameters.calrissian-stderr}}"}},{"name":"usage-report","valueFrom":{"parameter":"{{steps.get-results.outputs.parameters.calrissian-report}}"}},{"name":"stac-catalog","valueFrom":{"parameter":"{{steps.stage-out.outputs.parameters.stac-catalog}}"}}],"artifacts":[{"name":"tool-logs","from":"{{steps.get-results.outputs.artifacts.tool-logs}}"},{"name":"calrissian-output","from":"{{steps.get-results.outputs.artifacts.calrissian-output}}"},{"name":"calrissian-stderr","from":"{{steps.get-results.outputs.artifacts.calrissian-stderr}}"},{"name":"calrissian-report","from":"{{steps.get-results.outputs.artifacts.calrissian-report}}"}]},"metadata":{},"steps":[[{"name":"cwl-prepare","template":"cwl-prepare","arguments":{"parameters":[{"name":"cwl","value":"{{inputs.parameters.cwl}}"}]}},{"name":"param-prepare","template":"param-prepare","arguments":{"parameters":[{"name":"parameters","value":"{{inputs.parameters.parameters}}"}]}}],[{"name":"cwl-runner","template":"calrissian-tmpl","arguments":{"parameters":[{"name":"max_ram","value":"{{inputs.parameters.max_ram}}"},{"name":"max_cores","value":"{{inputs.parameters.max_cores}}"}]}}],[{"name":"get-results","template":"get-results","arguments":{"parameters":[{"name":"calrissian-output","value":"/calrissian/output.json"},{"name":"calrissian-stderr","value":"/calrissian/stderr.log"},{"name":"calrissian-report","value":"/calrissian/report.json"}]}},{"name":"stage-out","template":"stage-out","arguments":{"parameters":[{"name":"file_path","value":"/calrissian/output.json"},{"name":"bucket","value":"results"},{"name":"folder","value":"{{workflow.name}}"}]}}]]},"namespaced/argo-cwl-runner/calrissian-tmpl":{"name":"calrissian-tmpl","inputs":{},"outputs":{"artifacts":[{"name":"logs","path":"/calrissian/logs","s3":{"key":"{{workflow.name}}-artifacts/calrissian-logs.tgz"}}]},"metadata":{},"resource":{"action":"create","manifest":"apiVersion: batch/v1\nkind: Job\nmetadata:\n  generateName: calrissian-water-bodies-detection-\nspec:\n  backoffLimit: 1\n  activeDeadlineSeconds: 86400\n  ttlSecondsAfterFinished: 120\n  template:\n    metadata:\n      name: calrissian_pod\n    spec:\n      serviceAccountName: argo\n      containers:\n        - name: calrissian\n          image: ghcr.io/duke-gcb/calrissian/calrissian:0.16.0\n          imagePullPolicy: Always\n          command:\n          - calrissian\n          args:\n          - --debug\n          - --pod-serviceaccount\n          - argo\n          - --stdout\n          - /calrissian/output.json\n          - --stderr\n          - /calrissian/stderr.log\n          - --usage-report\n          - /calrissian/report.json\n          - --max-ram\n          - '{{workflow.parameters.max_ram}}'\n          - --max-cores\n          - '{{workflow.parameters.max_cores}}'\n          - --tmp-outdir-prefix\n          - /calrissian/tmp/\n          - --outdir\n          - /calrissian/results/\n          - --tool-logs-basepath \n          - /calrissian/logs\n          - \"/calrissian/cwl.json\"\n          - \"/calrissian/input.json\"\n          env:\n            - name: CALRISSIAN_POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: CALRISSIAN_DELETE_PODS\n              value: \"true\"\n          resources:\n            limits:\n              cpu: 2000m\n              memory: 2G\n            requests:\n              cpu: 1000m\n              memory: 1G\n          volumeMounts:\n            - mountPath: /calrissian\n              name: calrissian-wdir\n              readOnly: false\n      restartPolicy: Never\n      securityContext:\n        fsGroup: 0\n        runAsGroup: 0\n        runAsUser: 0\n      terminationGracePeriodSeconds: 120\n      volumes:\n        - name: calrissian-wdir\n          persistentVolumeClaim:\n            claimName: {{workflow.name}}-calrissian-wdir\n            readOnly: false\n","setOwnerReference":true,"successCondition":"status.succeeded \u003e 0","failureCondition":"status.failed \u003e 3"}},"namespaced/argo-cwl-runner/cwl-prepare":{"name":"cwl-prepare","inputs":{"parameters":[{"name":"cwl"}]},"outputs":{},"metadata":{},"script":{"name":"","image":"busybox:1.35.0","command":["ash"],"resources":{"requests":{"cpu":"1","memory":"1Gi"}},"volumeMounts":[{"name":"calrissian-wdir","mountPath":"/calrissian"}],"source":"#!/bin/ash\necho '{{inputs.parameters.cwl}}'  \u003e\u003e /calrissian/cwl.json\n"}},"namespaced/argo-cwl-runner/get-results":{"name":"get-results","inputs":{"parameters":[{"name":"calrissian-output"},{"name":"calrissian-stderr"},{"name":"calrissian-report"}]},"outputs":{"parameters":[{"name":"calrissian-output","valueFrom":{"path":"/tmp/calrissian-output.json"}},{"name":"calrissian-stderr","valueFrom":{"path":"/tmp/calrissian-stderr.txt"}},{"name":"calrissian-report","valueFrom":{"path":"/tmp/calrissian-report.json"}}],"artifacts":[{"name":"tool-logs","path":"/calrissian/logs","s3":{"key":"{{workflow.name}}-artifacts/tool-logs.tgz"}},{"name":"calrissian-output","path":"/tmp/calrissian-output.json","s3":{"key":"{{workflow.name}}-artifacts/calrissian-output.tgz"}},{"name":"calrissian-stderr","path":"/tmp/calrissian-stderr.txt","s3":{"key":"{{workflow.name}}-artifacts/calrissian-stderr.tgz"}},{"name":"calrissian-report","path":"/tmp/calrissian-report.json","s3":{"key":"{{workflow.name}}-artifacts/calrissian-report.tgz"}}]},"metadata":{},"script":{"name":"","image":"busybox:1.35.0","command":["ash"],"resources":{"requests":{"cpu":"1","memory":"1Gi"}},"volumeMounts":[{"name":"calrissian-wdir","mountPath":"/calrissian"}],"source":"#!/bin/ash\ncat \"{{inputs.parameters.calrissian-output}}\" \u003e /tmp/calrissian-output.json\ncat \"{{inputs.parameters.calrissian-stderr}}\" \u003e /tmp/calrissian-stderr.txt\ncat \"{{inputs.parameters.calrissian-report}}\" \u003e /tmp/calrissian-report.json\n"}},"namespaced/argo-cwl-runner/param-prepare":{"name":"param-prepare","inputs":{"parameters":[{"name":"parameters"}]},"outputs":{},"metadata":{},"script":{"name":"","image":"busybox:1.35.0","command":["ash"],"resources":{"requests":{"cpu":"1","memory":"1Gi"}},"volumeMounts":[{"name":"calrissian-wdir","mountPath":"/calrissian"}],"source":"#!/bin/ash\necho '{{inputs.parameters.parameters}}'  \u003e\u003e /calrissian/input.json\n"}},"namespaced/argo-cwl-runner/stage-out":{"name":"stage-out","inputs":{"parameters":[{"name":"file_path"},{"name":"bucket"},{"name":"folder"}]},"outputs":{"parameters":[{"name":"stac-catalog","valueFrom":{"path":"/tmp/output"}}]},"metadata":{},"script":{"name":"","image":"stageout:d9736189b831b531b41f80ec2261276351c6598abb8ebd06a51881d21d235d6b","command":["bash"],"resources":{"requests":{"cpu":"1","memory":"1Gi"}},"volumeMounts":[{"name":"calrissian-wdir","mountPath":"/calrissian"},{"name":"usersettings-vol","readOnly":true,"mountPath":"/etc/secret"}],"source":"set -x\ncat /etc/secret/usersettings.json\nstage-out --stac-catalog $( cat {{inputs.parameters.file_path}} | jq -r .stac_catalog.path - ) --user-settings /etc/secret/usersettings.json --bucket \"{{inputs.parameters.bucket}}\" --subfolder \"{{inputs.parameters.folder}}\"\nres=$?\necho \"s3://{{inputs.parameters.bucket}}/{{inputs.parameters.folder}}/catalog.json\" \u003e /tmp/output\nexit $res"}}},"conditions":[{"type":"PodRunning","status":"False"},{"type":"Completed","status":"True"}],"resourcesDuration":{"cpu":9,"memory":100},"storedWorkflowTemplateSpec":{"templates":[{"name":"calrissian-runner","inputs":{"parameters":[{"name":"parameters"},{"name":"cwl"},{"name":"max_ram"},{"name":"max_cores"}]},"outputs":{"parameters":[{"name":"results","valueFrom":{"parameter":"{{steps.get-results.outputs.parameters.calrissian-output}}"}},{"name":"logs","valueFrom":{"parameter":"{{steps.get-results.outputs.parameters.calrissian-stderr}}"}},{"name":"usage-report","valueFrom":{"parameter":"{{steps.get-results.outputs.parameters.calrissian-report}}"}},{"name":"stac-catalog","valueFrom":{"parameter":"{{steps.stage-out.outputs.parameters.stac-catalog}}"}}],"artifacts":[{"name":"tool-logs","from":"{{steps.get-results.outputs.artifacts.tool-logs}}"},{"name":"calrissian-output","from":"{{steps.get-results.outputs.artifacts.calrissian-output}}"},{"name":"calrissian-stderr","from":"{{steps.get-results.outputs.artifacts.calrissian-stderr}}"},{"name":"calrissian-report","from":"{{steps.get-results.outputs.artifacts.calrissian-report}}"}]},"metadata":{},"steps":[[{"name":"cwl-prepare","template":"cwl-prepare","arguments":{"parameters":[{"name":"cwl","value":"{{inputs.parameters.cwl}}"}]}},{"name":"param-prepare","template":"param-prepare","arguments":{"parameters":[{"name":"parameters","value":"{{inputs.parameters.parameters}}"}]}}],[{"name":"cwl-runner","template":"calrissian-tmpl","arguments":{"parameters":[{"name":"max_ram","value":"{{inputs.parameters.max_ram}}"},{"name":"max_cores","value":"{{inputs.parameters.max_cores}}"}]}}],[{"name":"get-results","template":"get-results","arguments":{"parameters":[{"name":"calrissian-output","value":"/calrissian/output.json"},{"name":"calrissian-stderr","value":"/calrissian/stderr.log"},{"name":"calrissian-report","value":"/calrissian/report.json"}]}},{"name":"stage-out","template":"stage-out","arguments":{"parameters":[{"name":"file_path","value":"/calrissian/output.json"},{"name":"bucket","value":"results"},{"name":"folder","value":"{{workflow.name}}"}]}}]]},{"name":"param-prepare","inputs":{"parameters":[{"name":"parameters"}]},"outputs":{},"metadata":{},"script":{"name":"","image":"busybox:1.35.0","command":["ash"],"resources":{"requests":{"cpu":"1","memory":"1Gi"}},"volumeMounts":[{"name":"calrissian-wdir","mountPath":"/calrissian"}],"source":"#!/bin/ash\necho '{{inputs.parameters.parameters}}'  \u003e\u003e /calrissian/input.json\n"}},{"name":"cwl-prepare","inputs":{"parameters":[{"name":"cwl"}]},"outputs":{},"metadata":{},"script":{"name":"","image":"busybox:1.35.0","command":["ash"],"resources":{"requests":{"cpu":"1","memory":"1Gi"}},"volumeMounts":[{"name":"calrissian-wdir","mountPath":"/calrissian"}],"source":"#!/bin/ash\necho '{{inputs.parameters.cwl}}'  \u003e\u003e /calrissian/cwl.json\n"}},{"name":"calrissian-tmpl","inputs":{},"outputs":{"artifacts":[{"name":"logs","path":"/calrissian/logs","s3":{"key":"{{workflow.name}}-artifacts/calrissian-logs.tgz"}}]},"metadata":{},"resource":{"action":"create","manifest":"apiVersion: batch/v1\nkind: Job\nmetadata:\n  generateName: calrissian-water-bodies-detection-\nspec:\n  backoffLimit: 1\n  activeDeadlineSeconds: 86400\n  ttlSecondsAfterFinished: 120\n  template:\n    metadata:\n      name: calrissian_pod\n    spec:\n      serviceAccountName: argo\n      containers:\n        - name: calrissian\n          image: ghcr.io/duke-gcb/calrissian/calrissian:0.16.0\n          imagePullPolicy: Always\n          command:\n          - calrissian\n          args:\n          - --debug\n          - --pod-serviceaccount\n          - argo\n          - --stdout\n          - /calrissian/output.json\n          - --stderr\n          - /calrissian/stderr.log\n          - --usage-report\n          - /calrissian/report.json\n          - --max-ram\n          - '{{workflow.parameters.max_ram}}'\n          - --max-cores\n          - '{{workflow.parameters.max_cores}}'\n          - --tmp-outdir-prefix\n          - /calrissian/tmp/\n          - --outdir\n          - /calrissian/results/\n          - --tool-logs-basepath \n          - /calrissian/logs\n          - \"/calrissian/cwl.json\"\n          - \"/calrissian/input.json\"\n          env:\n            - name: CALRISSIAN_POD_NAME\n              valueFrom:\n                fieldRef:\n                  fieldPath: metadata.name\n            - name: CALRISSIAN_DELETE_PODS\n              value: \"true\"\n          resources:\n            limits:\n              cpu: 2000m\n              memory: 2G\n            requests:\n              cpu: 1000m\n              memory: 1G\n          volumeMounts:\n            - mountPath: /calrissian\n              name: calrissian-wdir\n              readOnly: false\n      restartPolicy: Never\n      securityContext:\n        fsGroup: 0\n        runAsGroup: 0\n        runAsUser: 0\n      terminationGracePeriodSeconds: 120\n      volumes:\n        - name: calrissian-wdir\n          persistentVolumeClaim:\n            claimName: {{workflow.name}}-calrissian-wdir\n            readOnly: false\n","setOwnerReference":true,"successCondition":"status.succeeded \u003e 0","failureCondition":"status.failed \u003e 3"}},{"name":"get-results","inputs":{"parameters":[{"name":"calrissian-output"},{"name":"calrissian-stderr"},{"name":"calrissian-report"}]},"outputs":{"parameters":[{"name":"calrissian-output","valueFrom":{"path":"/tmp/calrissian-output.json"}},{"name":"calrissian-stderr","valueFrom":{"path":"/tmp/calrissian-stderr.txt"}},{"name":"calrissian-report","valueFrom":{"path":"/tmp/calrissian-report.json"}}],"artifacts":[{"name":"tool-logs","path":"/calrissian/logs","s3":{"key":"{{workflow.name}}-artifacts/tool-logs.tgz"}},{"name":"calrissian-output","path":"/tmp/calrissian-output.json","s3":{"key":"{{workflow.name}}-artifacts/calrissian-output.tgz"}},{"name":"calrissian-stderr","path":"/tmp/calrissian-stderr.txt","s3":{"key":"{{workflow.name}}-artifacts/calrissian-stderr.tgz"}},{"name":"calrissian-report","path":"/tmp/calrissian-report.json","s3":{"key":"{{workflow.name}}-artifacts/calrissian-report.tgz"}}]},"metadata":{},"script":{"name":"","image":"busybox:1.35.0","command":["ash"],"resources":{"requests":{"cpu":"1","memory":"1Gi"}},"volumeMounts":[{"name":"calrissian-wdir","mountPath":"/calrissian"}],"source":"#!/bin/ash\ncat \"{{inputs.parameters.calrissian-output}}\" \u003e /tmp/calrissian-output.json\ncat \"{{inputs.parameters.calrissian-stderr}}\" \u003e /tmp/calrissian-stderr.txt\ncat \"{{inputs.parameters.calrissian-report}}\" \u003e /tmp/calrissian-report.json\n"}},{"name":"stage-out","inputs":{"parameters":[{"name":"file_path"},{"name":"bucket"},{"name":"folder"}]},"outputs":{"parameters":[{"name":"stac-catalog","valueFrom":{"path":"/tmp/output"}}]},"metadata":{},"script":{"name":"","image":"stageout:d9736189b831b531b41f80ec2261276351c6598abb8ebd06a51881d21d235d6b","command":["bash"],"resources":{"requests":{"cpu":"1","memory":"1Gi"}},"volumeMounts":[{"name":"calrissian-wdir","mountPath":"/calrissian"},{"name":"usersettings-vol","readOnly":true,"mountPath":"/etc/secret"}],"source":"set -x\ncat /etc/secret/usersettings.json\nstage-out --stac-catalog $( cat {{inputs.parameters.file_path}} | jq -r .stac_catalog.path - ) --user-settings /etc/secret/usersettings.json --bucket \"{{inputs.parameters.bucket}}\" --subfolder \"{{inputs.parameters.folder}}\"\nres=$?\necho \"s3://{{inputs.parameters.bucket}}/{{inputs.parameters.folder}}/catalog.json\" \u003e /tmp/output\nexit $res"}}],"entrypoint":"calrissian-runner","arguments":{"parameters":[{"name":"parameters","value":"{\"stac_items\":[\"https://earth-search.aws.element84.com/v0/collections/sentinel-s2-l2a-cogs/items/S2A_10TFK_20210708_0_L2A\"],\"aoi\":\"-121.399,39.834,-120.74,40.472\",\"epsg\":\"EPSG:4326\"}"},{"name":"cwl","value":"{\"cwlVersion\":\"v1.0\",\"$namespaces\":{\"s\":\"https://schema.org/\"},\"s:softwareVersion\":\"1.0.0\",\"schemas\":[\"http://schema.org/version/9.0/schemaorg-current-http.rdf\"],\"$graph\":[{\"class\":\"Workflow\",\"id\":\"main\",\"label\":\"Water bodies detection based on NDWI and otsu threshold\",\"doc\":\"Water bodies detection based on NDWI and otsu threshold applied to Sentinel-2 COG STAC items\",\"requirements\":[{\"class\":\"ScatterFeatureRequirement\"},{\"class\":\"SubworkflowFeatureRequirement\"}],\"inputs\":{\"aoi\":{\"label\":\"area of interest\",\"doc\":\"area of interest as a bounding box\",\"type\":\"string\"},\"epsg\":{\"label\":\"EPSG code\",\"doc\":\"EPSG code\",\"type\":\"string\",\"default\":\"EPSG:4326\"},\"stac_items\":{\"label\":\"Sentinel-2 STAC items\",\"doc\":\"list of Sentinel-2 COG STAC items\",\"type\":\"string[]\"},\"bands\":{\"label\":\"bands used for the NDWI\",\"doc\":\"bands used for the NDWI\",\"type\":\"string[]\",\"default\":[\"green\",\"nir\"]}},\"outputs\":[{\"id\":\"stac_catalog\",\"outputSource\":[\"node_stac/stac_catalog\"],\"type\":\"Directory\"}],\"steps\":{\"node_water_bodies\":{\"run\":\"#detect_water_body\",\"in\":{\"item\":\"stac_items\",\"aoi\":\"aoi\",\"epsg\":\"epsg\",\"bands\":\"bands\"},\"out\":[\"detected_water_body\"],\"scatter\":\"item\",\"scatterMethod\":\"dotproduct\"},\"node_stac\":{\"run\":\"#stac\",\"in\":{\"item\":\"stac_items\",\"rasters\":{\"source\":\"node_water_bodies/detected_water_body\"}},\"out\":[\"stac_catalog\"]}}},{\"class\":\"Workflow\",\"id\":\"detect_water_body\",\"label\":\"Water body detection based on NDWI and otsu threshold\",\"doc\":\"Water body detection based on NDWI and otsu threshold\",\"requirements\":[{\"class\":\"ScatterFeatureRequirement\"}],\"inputs\":{\"aoi\":{\"doc\":\"area of interest as a bounding box\",\"type\":\"string\"},\"epsg\":{\"doc\":\"EPSG code\",\"type\":\"string\",\"default\":\"EPSG:4326\"},\"bands\":{\"doc\":\"bands used for the NDWI\",\"type\":\"string[]\"},\"item\":{\"doc\":\"STAC item\",\"type\":\"string\"}},\"outputs\":[{\"id\":\"detected_water_body\",\"outputSource\":[\"node_otsu/binary_mask_item\"],\"type\":\"File\"}],\"steps\":{\"node_crop\":{\"run\":\"#crop\",\"in\":{\"item\":\"item\",\"aoi\":\"aoi\",\"epsg\":\"epsg\",\"band\":\"bands\"},\"out\":[\"cropped\"],\"scatter\":\"band\",\"scatterMethod\":\"dotproduct\"},\"node_normalized_difference\":{\"run\":\"#norm_diff\",\"in\":{\"rasters\":{\"source\":\"node_crop/cropped\"}},\"out\":[\"ndwi\"]},\"node_otsu\":{\"run\":\"#otsu\",\"in\":{\"raster\":{\"source\":\"node_normalized_difference/ndwi\"}},\"out\":[\"binary_mask_item\"]}}},{\"class\":\"CommandLineTool\",\"id\":\"crop\",\"requirements\":{\"InlineJavascriptRequirement\":{},\"EnvVarRequirement\":{\"envDef\":{\"PATH\":\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\",\"PYTHONPATH\":\"/app\"}},\"ResourceRequirement\":{\"coresMax\":1,\"ramMax\":512}},\"hints\":{\"DockerRequirement\":{\"dockerPull\":\"ghcr.io/eoap/mastering-app-package/crop@sha256:61c2f37b3a1bd56a3eddd0f4224c72de665d42957d3325dd0397845cff198dab\"}},\"baseCommand\":[\"python\",\"-m\",\"app\"],\"arguments\":[],\"inputs\":{\"item\":{\"type\":\"string\",\"inputBinding\":{\"prefix\":\"--input-item\"}},\"aoi\":{\"type\":\"string\",\"inputBinding\":{\"prefix\":\"--aoi\"}},\"epsg\":{\"type\":\"string\",\"inputBinding\":{\"prefix\":\"--epsg\"}},\"band\":{\"type\":\"string\",\"inputBinding\":{\"prefix\":\"--band\"}}},\"outputs\":{\"cropped\":{\"outputBinding\":{\"glob\":\"*.tif\"},\"type\":\"File\"}}},{\"class\":\"CommandLineTool\",\"id\":\"norm_diff\",\"requirements\":{\"InlineJavascriptRequirement\":{},\"EnvVarRequirement\":{\"envDef\":{\"PATH\":\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\",\"PYTHONPATH\":\"/app\"}},\"ResourceRequirement\":{\"coresMax\":1,\"ramMax\":512}},\"hints\":{\"DockerRequirement\":{\"dockerPull\":\"ghcr.io/eoap/mastering-app-package/norm_diff@sha256:641ab55968d7f500b641969d0a7422c4c9a80dd5cc1459ee07f3e0c5ee4fa230\"}},\"baseCommand\":[\"python\",\"-m\",\"app\"],\"arguments\":[],\"inputs\":{\"rasters\":{\"type\":\"File[]\",\"inputBinding\":{\"position\":1}}},\"outputs\":{\"ndwi\":{\"outputBinding\":{\"glob\":\"*.tif\"},\"type\":\"File\"}}},{\"class\":\"CommandLineTool\",\"id\":\"otsu\",\"requirements\":{\"InlineJavascriptRequirement\":{},\"EnvVarRequirement\":{\"envDef\":{\"PATH\":\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\",\"PYTHONPATH\":\"/app\"}},\"ResourceRequirement\":{\"coresMax\":1,\"ramMax\":512}},\"hints\":{\"DockerRequirement\":{\"dockerPull\":\"ghcr.io/eoap/mastering-app-package/otsu@sha256:ec02baf6a007ebb5a2dc037af2da8ef94db67bb8a6139682ad61041f9d27c779\"}},\"baseCommand\":[\"python\",\"-m\",\"app\"],\"arguments\":[],\"inputs\":{\"raster\":{\"type\":\"File\",\"inputBinding\":{\"position\":1}}},\"outputs\":{\"binary_mask_item\":{\"outputBinding\":{\"glob\":\"*.tif\"},\"type\":\"File\"}}},{\"class\":\"CommandLineTool\",\"id\":\"stac\",\"requirements\":{\"InlineJavascriptRequirement\":{},\"EnvVarRequirement\":{\"envDef\":{\"PATH\":\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\",\"PYTHONPATH\":\"/app\"}},\"ResourceRequirement\":{\"coresMax\":1,\"ramMax\":512}},\"hints\":{\"DockerRequirement\":{\"dockerPull\":\"ghcr.io/eoap/mastering-app-package/stac@sha256:8ad7e7d6999c0c4c91c2b19ce231f24734d2af8f41b855ef9a06276d23345601\"}},\"baseCommand\":[\"python\",\"-m\",\"app\"],\"arguments\":[],\"inputs\":{\"item\":{\"type\":{\"type\":\"array\",\"items\":\"string\",\"inputBinding\":{\"prefix\":\"--input-item\"}}},\"rasters\":{\"type\":{\"type\":\"array\",\"items\":\"File\",\"inputBinding\":{\"prefix\":\"--water-body\"}}}},\"outputs\":{\"stac_catalog\":{\"outputBinding\":{\"glob\":\".\"},\"type\":\"Directory\"}}}],\"s:codeRepository\":{\"URL\":\"https://github.com/eoap/mastering-app-package.git\"},\"s:author\":[{\"class\":\"s:Person\",\"s.name\":\"Jane Doe\",\"s.email\":\"jane.doe@acme.earth\",\"s.affiliation\":\"ACME\"}]}"},{"name":"max_ram","value":"16G"},{"name":"max_cores","value":"8"}]},"serviceAccountName":"argo","volumes":[{"name":"usersettings-vol","secret":{"secretName":"user-settings"}}],"volumeClaimTemplates":[{"metadata":{"name":"calrissian-wdir","creationTimestamp":null,"labels":{"skaffold.dev/run-id":"68a5d3c0-bfaf-40d7-9ff5-f2dd6bae38ec"}},"spec":{"accessModes":["ReadWriteMany"],"resources":{"requests":{"storage":"20Gi"}},"storageClassName":"standard"},"status":{}}],"podGC":{"strategy":"OnWorkflowCompletion","deleteDelayDuration":"2m0s"},"workflowTemplateRef":{"name":"argo-cwl-runner"},"synchronization":{"semaphore":{"configMapKeyRef":{"name":"semaphore","key":"workflow"}}}},"artifactRepositoryRef":{"default":true,"artifactRepository":{"archiveLogs":true,"s3":{"endpoint":"minio:9000","bucket":"workflows","insecure":true,"accessKeySecret":{"name":"my-minio-cred","key":"accesskey"},"secretKeySecret":{"name":"my-minio-cred","key":"secretkey"}}}},"artifactGCStatus":{"notSpecified":true},"taskResultsCompletionStatus":{"argo-cwl-runner-wvqmw-1289416099":true,"argo-cwl-runner-wvqmw-1616805333":true,"argo-cwl-runner-wvqmw-240761544":true,"argo-cwl-runner-wvqmw-2838679990":true,"argo-cwl-runner-wvqmw-3279323762":true}}}